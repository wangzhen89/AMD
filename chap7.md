
# 均衡双向处理结构 {#chap7}

第 \@ref(chap4) 章和第 \@ref(chap5) 章讨论了如何分析实验的设计结构。本章将讨论分析实验的处理结构的方法。特别是，本章将重点分析双向交叉分类的处理结构。假设存在两组处理 $T_1,T_2,\cdots,T_t$ 和 $B_1,B_2,\cdots,B_b$. 每个 $T$ 处理要与每个 $B$ 处理结合，并分配给一个实验单位。为方便起见，假设实验单位完全随机地分配给处理组合。或者，假设从大量实验单位中随机抽取了一个样本，并且可以根据 $T_1,T_2,\cdots,T_t$ 和 $B_1,B_2,\cdots,B_b$ 的值将样本中的实验单位分配给不同的类别。在这两种情况下，在交叉分类的处理结构中，对总共 $bt$ 个总体进行了抽样。

分析实验的处理结构和设计结构通常是独立进行的，除非是区组设计和重复测量设计，以及本书后面章节中考虑的这些设计的变体。因此，无论实验单位是分组为完全区组、均衡的不完全区组、拉丁方还是其他分组方式，处理结构的分析对于大多数标准设计来说都是相似的，几乎没有区别。由于对 $bt$ 个总体进行了抽样，因此在检验等处理均值的假设时，平方和的自由度为 $bt-1$，即假设 $\mu_{11}=\mu_{12}=\cdots=\mu_{tb}$. 本章考虑了处理平方和的不同划分，以检验实验者通常感兴趣的不同类型的假设。

## 模型定义和假设 {#sec7-1}

### 均值模型 {#sec7-1-1}

**均值模型** (means model) 定义为

\begin{equation}
Y_{ijk}=\mu_{ij}+\varepsilon_{ijk},\quad i=1,2,\ldots,t,\quad j=1,2,\ldots,b,\quad k=1,2,\ldots,n
(#eq:7-1)
\end{equation}

其中假设 $\varepsilon_{ijk}\sim i.i.d.N(0,\sigma^2),i=1,2,\ldots,t,j=1,2,\ldots,b,k=1,2,\ldots,n$，且当处理组合 $(T_i,B_j)$ 被分配到随机选择的实验单元时，$\mu_{ij}$ 是预期的响应。

### 效应模型 {#sec7-1-2}

具有双向处理结构的实验中另一个常见模型称为**效应模型** (effects model)，其由式 \@ref(eq:7-1) 定义，且 $\mu_{ij}$ 替换为

\begin{equation}
\mu_{ij}=\mu+\tau_i+\beta_j+\gamma_{ij},\quad i=1,2,\ldots,t,j=1,2,\ldots,b
(#eq:7-2)
\end{equation}

从哲学角度看，效应模型在直觉上很有吸引力，因为它可能是基于这样的假设：$\mu$ 代表某种总体平均效应，$\tau_i$ 代表将 $T_i$ 分配给实验单位后对均值的效应，$\beta_j$ 代表将 $B_j$ 分配给实验单位后的效应，而 $\gamma_{ij}$ 代表同时使用 $T_i$ 和 $B_j$ 时可能对实验单位产生的任何额外的正面或负面效应。然而，如第 \@ref(chap6) 章所指出的，效应模型存在一些可估性问题。下面将讨论这两种模型。

## 参数估计 {#sec7-2}

在大多数情况下，$\sigma^2$ 的估计仅来自对实验设计结构的分析。然而，在某些情况下，实验者可能能够对 $\mu_{ij}$ 或处理效果做出某些假设，这些假设可能会提供一些关于 $\sigma^2$ 的额外信息。例如，如果实验者知道 $\mu_{11}=\mu_{12}$，那么可以将来自均值为 $\mu_{11}$ 和 $\mu_{12}$ 的总体的样本组合起来，以提供用于估计 $\sigma^2$ 的额外自由度。在这种情况下，相应的单自由度平方和由 $n(\bar{y}_{11\cdot}-\bar{y}_{12\cdot})^2/2$ 给出。

大多数实验者不会倾向于相信 $\mu_{11}=\mu_{12}$，但还有其他可能合适的信念 (beliefs). 其中一个信念是，两组处理的效应是**加性的** (additive). 也就是说，两组处理不会发生交互 (interact). 如果这是真的，那么额外的信息将可用于估计 $\sigma^2$.

如果将 $bt$ 种组合视为 $bt$ 个不同的处理，则第 \@ref(chap1) 章至第 \@ref(chap3) 章中针对单向处理结构提供的所有讨论都适用于双向处理结构；也就是说，比如 $[\mu_{11},\mu_{12},\ldots,\mu_{1b},\ldots,\mu_{t1},\mu_{t2},\ldots,\mu_{tb}]=[\mu_1,\mu_{2},\ldots,\mu_{tb}]$.

因此，均值模型中参数的最佳估计为

$$\hat{\mu}_{ij}=\frac1n\sum_{k=1}^ny_{ijk}=\bar{y}_{ij\cdot},\quad i=1,2,\ldots,t,\quad j=1,2,\ldots,b$$

以及

$$\hat{\sigma}^2=\frac1{N-bt}\sum_{ijk}(y_{ijk}-\bar{y}_{ij\cdot})^2$$

其中 $N=nbt$. $\hat \mu_{ij}$ 的抽样分布为 $N(\mu_{ij},\sigma^2/n)$，其中 $i=1,2\cdots,t,\,j=1,2,\cdots,b$. 且 $(N-bt)\hat{\sigma}^2/\sigma^2$ 的抽样分布为 $\chi^2(N^-bt)$. 另外，$\hat{\mu}_{11},\hat{\mu}_{12},\ldots,\hat{\mu}_{tb}$ 和 $\sigma^2$ 有独立的概率分布。

大多数情况下，实验者想要回答以下问题：

1) $T$ 处理如何影响响应？
2) $B$ 处理如何影响响应？

## 交互作用及它们的重要性 {#sec7-3}

为了很好地回答上述问题，实验者必须首先确定这两组处理是否发生交互。交互作用假设 (interaction hypothesis) 可以用几种等效的方式来表述。下面给出了其中一些。

1) $H_0\colon{{\mu}}_{ij}-\mu_{ij}=\mu_{i'j}-\mu_{i'j'}$ 对于所有的 $i\ne i'$ 和 $j\ne j'$
2) $H_0\colon\mu_{ij}-\mu_{i'j}=\mu_{ij'}-\mu_{i'j'}$ 对于所有的 $i\ne i'$ 和 $j\ne j'$
3) $H_0\colon{\mu_{ij}-\mu_{i'j}-\mu_{ij'}+\mu_{i'j'}=0}$ 对于所有的 $i\ne i'$ 和 $j\ne j'$
4) $H_0\colon\mu_{ij}=\mu+\tau_i+\beta_j$ 对于所有的 $i$ 和 $j$ 以及一些参数集 ${\mu},{\tau}_1,{\tau}_2,...,{\tau}_t,{\beta}_1,{\beta}_2,\cdots,{\beta}_b$

1-4 中的每一个都意味着两组处理效应之间没有交互作用。对 1 的解释是，任何一对 B 处理之间的差异都是相同的，无论它们与哪种 T 处理相结合。类似地，对 2 的解释是，任何一对 T 处理之间的差异都是相同的，无论它们与哪种 B 处理相结合。1 和 2 在代数上都等价于 3，3 通常被称为所有可能的二乘二表格差异的集合 (the set of all possible two by two table differences). 对 4 的解释是，这两组处理的效应是加性的。如果 1-4 中的任何一个是真的，那么说明 T 处理和 B 处理之间没有相互作用。

如果两组处理不发生交互，则一组处理的效应可以如此进行最佳比较：对另一组处理的效应进行平均之后。这样的比较是最佳的，是因为平均化增加了比较两个或多个处理效应的统计功效，或者等价地，平均化对效应差异给出了尽可能短的置信区间。如果两组处理发生交互，那么一组处理效应之间的差异将依赖于与它们结合的第二组处理的水平，这会使实验分析稍微复杂一些。

## 主效应 {#sec7-4}

如果实验者得出结论，这两组处理没有交互作用，那么关于**主效应** (main effects) 的假设就可以进行检验。这些假设可以写成：

$$\begin{aligned}H_{01}\colon\bar{\mu}_{1\cdot}=\bar{\mu}_{2\cdot}=\cdots=\bar{\mu}_{t\cdot}\quad\text{and}\quad H_{02}\colon\bar{\mu}_{\cdot1}=\bar{\mu}_{\cdot2}=\cdots=\bar{\mu}_{\cdot b}\end{aligned}$$

即使实验中存在交互作用，上述两个假设仍然可以检验。然而，这两种情况对检验结果的解释将截然不同。

## 计算机分析 {#sec7-5}

大多数统计分析包都会自动给出前两节中描述的两个主效应假设和交互作用假设的检验，前提是指定了以下形式的模型

$$y=T\mathrm{~}B\mathrm{~}T\times B$$

大多还具有一个选项，允许用户通过使用第 \@ref(chap3) 章中讨论的一个或多个多重比较程序来相互比较主效应均值。大多数软件包还允许用户指定和检验用户自己选择的对比。如果确定两组处理发生交互，则实验者可能想要比较所有 $bt$ 个处理组合两两之间的差异。如果所使用的统计包无法进行此类比较，则可以手动完成此操作。或者，如果统计分析包不允许对 $T\times B$ 单元格均值进行多重比较，通常可以通过一些技巧使其能够完成。为此，可以在数据文件中包含一个新的识别变量，使该新变量具有 $bt$ 个不同的值，对应 $bt$ 个处理组合。这个新变量可用于重新分析数据，作为单因素处理结构，从而得出双向单元格均值的多重比较。实验者可能还感兴趣于如何对多重检验进行调整，如第 \@ref(chap3) 章所述。

## 结束语 {#sec7-6}

当处理以双向处理结构进行安排时，通常会检验三个基本的前提假设。其中最重要的是交互作用假设。如果没有交互作用，那么通过对其他处理水平的平均化，可以最好地比较每种处理的主效应。如果存在交互作用，那么在比较第一种处理的效应时，实验者必须小心以确定对第二种处理的水平进行平均是否有意义。**通常这样做是没有意义的**。

## 练习 {#sec7-6}

