<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 6 章 模型的矩阵形式 | 混乱数据分析：设计的实验</title>
  <meta name="description" content="Analysis of Messy Data Volume 1: Designed Experiments的翻译" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="第 6 章 模型的矩阵形式 | 混乱数据分析：设计的实验" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Analysis of Messy Data Volume 1: Designed Experiments的翻译" />
  <meta name="github-repo" content="wangzhen89/AMD" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 6 章 模型的矩阵形式 | 混乱数据分析：设计的实验" />
  
  <meta name="twitter:description" content="Analysis of Messy Data Volume 1: Designed Experiments的翻译" />
  

<meta name="author" content="Wang Zhen" />


<meta name="date" content="2024-03-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap5.html"/>
<link rel="next" href="chap7.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      TeX: {
        Macros: {
          bm: ["{\\boldsymbol #1}",1],
        },
        extensions: ["cancel.js"]
      }
    });
</script>

<!-- add line break after theorem title -->
<script>
  document.addEventListener("DOMContentLoaded", (event) => {
    for (let s of document.querySelectorAll("span.theorem, span.lemma, span.proposition, span.corollary")) {
      s.insertAdjacentHTML('afterend', '<br style="line-height:2px;"/>');
    }
  });
</script>

<!-- check if --themcolor in style.css matches one of elegantbook theme colors. If so, generates the color palette  -->
<script>
  document.addEventListener("DOMContentLoaded", (event) => {
    const cssroot = document.querySelector(':root');
    let theme_color = getComputedStyle(document.documentElement).getPropertyValue('--themecolor').trim();
  
    // blue is the default option

    switch (theme_color) {
      case 'green': 
        cssroot.style.setProperty('--structurecolor', 'rgb(0,120,2)');
        cssroot.style.setProperty('--main', 'rgb(70,70,70)');
        cssroot.style.setProperty('--mainbg', 'rgba(0,166,82,0.05)');
        cssroot.style.setProperty('--second', 'rgb(115,45,2)');
        cssroot.style.setProperty('--secondbg', 'rgba(115,45,2,0.05)');
        cssroot.style.setProperty('--third', 'rgb(0,80,80)');
        cssroot.style.setProperty('--thirdbg', 'rgba(0,80,80,0.05)');
      break;
      case 'cyan':
        cssroot.style.setProperty('--structurecolor', 'rgb(31,186,190)');
        cssroot.style.setProperty('--main', 'rgb(59,180,5)');
        cssroot.style.setProperty('--mainbg', 'rgba(59,180,5,0.05)');
        cssroot.style.setProperty('--second', 'rgb(175,153,8)');
        cssroot.style.setProperty('--secondbg', 'rgba(175,153,8,0.05)');
        cssroot.style.setProperty('--third', 'rgb(244,105,102)');
        cssroot.style.setProperty('--thirdbg', 'rgba(244,105,102,0.05)');
      break;
      case 'gray':
        cssroot.style.setProperty('--structurecolor', 'rgb(150,150,150)');
        cssroot.style.setProperty('--main', 'rgb(150,150,150)');
        cssroot.style.setProperty('--mainbg', 'rgba(150,150,150,0.05)');
        cssroot.style.setProperty('--second', 'rgb(150,150,150)');
        cssroot.style.setProperty('--secondbg', 'rgba(150,150,150,0.05)');
        cssroot.style.setProperty('--third', 'rgb(150,150,150)');
        cssroot.style.setProperty('--thirdbg', 'rgba(150,150,150,0.05)');
      break;
      case 'black':
        cssroot.style.setProperty('--structurecolor', 'rgb(0,0,0)');
        cssroot.style.setProperty('--main', 'rgb(0,0,0)');
        cssroot.style.setProperty('--mainbg', 'rgba(0,0,0,0.05)');
        cssroot.style.setProperty('--second', 'rgb(0,0,0)');
        cssroot.style.setProperty('--secondbg', 'rgba(0,0,0,0.05)');
        cssroot.style.setProperty('--third', 'rgb(0,0,0)');
        cssroot.style.setProperty('--thirdbg', 'rgba(0,0,0,0.05)');
      break;
    default:
        cssroot.style.setProperty('--structurecolor', 'rgb(60,113,183)');
        cssroot.style.setProperty('--main', 'rgb(0,166,82)');
        cssroot.style.setProperty('--mainbg', 'rgba(0,166,82,0.05)');
        cssroot.style.setProperty('--second', 'rgb(255,134,24)');
        cssroot.style.setProperty('--secondbg', 'rgba(255,134,24,0.05)');
        cssroot.style.setProperty('--third', 'rgb(0,174,247)');
        cssroot.style.setProperty('--thirdbg', 'rgba(0,174,247,0.05)');
    }
  });
  </script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">混乱数据分析：设计的实验</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>介绍</a></li>
<li class="part"><span><b>I 热身</b></span></li>
<li class="chapter" data-level="1" data-path="chap1.html"><a href="chap1.html"><i class="fa fa-check"></i><b>1</b> 最简单的情况：具有同质误差的完全随机设计结构中的单向处理结构</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chap1.html"><a href="chap1.html#sec1-1"><i class="fa fa-check"></i><b>1.1</b> 模型定义和假设</a></li>
<li class="chapter" data-level="1.2" data-path="chap1.html"><a href="chap1.html#sec1-2"><i class="fa fa-check"></i><b>1.2</b> 参数估计</a></li>
<li class="chapter" data-level="1.3" data-path="chap1.html"><a href="chap1.html#sec1-3"><i class="fa fa-check"></i><b>1.3</b> 线性组合的推断：检验与置信区间</a></li>
<li class="chapter" data-level="1.4" data-path="chap1.html"><a href="chap1.html#sec1-4"><i class="fa fa-check"></i><b>1.4</b> 示例：任务和脉搏率</a></li>
<li class="chapter" data-level="1.5" data-path="chap1.html"><a href="chap1.html#sec1-5"><i class="fa fa-check"></i><b>1.5</b> 几个线性组合的同时检验</a></li>
<li class="chapter" data-level="1.6" data-path="chap1.html"><a href="chap1.html#sec1-6"><i class="fa fa-check"></i><b>1.6</b> 示例：任务和脉搏率（续）</a></li>
<li class="chapter" data-level="1.7" data-path="chap1.html"><a href="chap1.html#sec1-7"><i class="fa fa-check"></i><b>1.7</b> 检验所有均值相等</a></li>
<li class="chapter" data-level="1.8" data-path="chap1.html"><a href="chap1.html#sec1-8"><i class="fa fa-check"></i><b>1.8</b> 示例：任务和脉搏率（续）</a></li>
<li class="chapter" data-level="1.9" data-path="chap1.html"><a href="chap1.html#sec1-9"><i class="fa fa-check"></i><b>1.9</b> 比较两种模型的一般方法：条件误差原理</a></li>
<li class="chapter" data-level="1.10" data-path="chap1.html"><a href="chap1.html#sec1-10"><i class="fa fa-check"></i><b>1.10</b> 示例：任务和脉搏率（续）</a></li>
<li class="chapter" data-level="1.11" data-path="chap1.html"><a href="chap1.html#sec1-11"><i class="fa fa-check"></i><b>1.11</b> 计算机分析</a></li>
<li class="chapter" data-level="1.12" data-path="chap1.html"><a href="chap1.html#sec1-12"><i class="fa fa-check"></i><b>1.12</b> 结束语</a></li>
<li class="chapter" data-level="1.13" data-path="chap1.html"><a href="chap1.html#sec1-13"><i class="fa fa-check"></i><b>1.13</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap2.html"><a href="chap2.html"><i class="fa fa-check"></i><b>2</b> 具有异质误差的完全随机设计结构中的单向处理结构</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chap2.html"><a href="chap2.html#sec2-1"><i class="fa fa-check"></i><b>2.1</b> 模型定义和假设</a></li>
<li class="chapter" data-level="2.2" data-path="chap2.html"><a href="chap2.html#sec2-2"><i class="fa fa-check"></i><b>2.2</b> 参数估计</a></li>
<li class="chapter" data-level="2.3" data-path="chap2.html"><a href="chap2.html#sec2-3"><i class="fa fa-check"></i><b>2.3</b> 方差齐性检验</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chap2.html"><a href="chap2.html#sec2-3-1"><i class="fa fa-check"></i><b>2.3.1</b> Hartley’s <em>F</em>-Max Test</a></li>
<li class="chapter" data-level="2.3.2" data-path="chap2.html"><a href="chap2.html#sec2-3-2"><i class="fa fa-check"></i><b>2.3.2</b> Bartlett’s Test</a></li>
<li class="chapter" data-level="2.3.3" data-path="chap2.html"><a href="chap2.html#sec2-3-3"><i class="fa fa-check"></i><b>2.3.3</b> Levene’s Test</a></li>
<li class="chapter" data-level="2.3.4" data-path="chap2.html"><a href="chap2.html#sec2-4-4"><i class="fa fa-check"></i><b>2.3.4</b> Brown and Forsythe’s Test</a></li>
<li class="chapter" data-level="2.3.5" data-path="chap2.html"><a href="chap2.html#sec2-3-5"><i class="fa fa-check"></i><b>2.3.5</b> O’Brien’s Test</a></li>
<li class="chapter" data-level="2.3.6" data-path="chap2.html"><a href="chap2.html#sec2-3-6"><i class="fa fa-check"></i><b>2.3.6</b> 一些建议</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chap2.html"><a href="chap2.html#sec2-4"><i class="fa fa-check"></i><b>2.4</b> 示例：药物和错误</a></li>
<li class="chapter" data-level="2.5" data-path="chap2.html"><a href="chap2.html#sec2-5"><i class="fa fa-check"></i><b>2.5</b> 关于线性组合的推断</a></li>
<li class="chapter" data-level="2.6" data-path="chap2.html"><a href="chap2.html#sec2-6"><i class="fa fa-check"></i><b>2.6</b> 示例：药物和错误（续）</a></li>
<li class="chapter" data-level="2.7" data-path="chap2.html"><a href="chap2.html#sec2-7"><i class="fa fa-check"></i><b>2.7</b> 自由度的一般 Satterthwaite 近似</a></li>
<li class="chapter" data-level="2.8" data-path="chap2.html"><a href="chap2.html#sec2-8"><i class="fa fa-check"></i><b>2.8</b> 比较所有均值</a></li>
<li class="chapter" data-level="2.9" data-path="chap2.html"><a href="chap2.html#sec2-9"><i class="fa fa-check"></i><b>2.9</b> 结束语</a></li>
<li class="chapter" data-level="2.10" data-path="chap2.html"><a href="chap2.html#sec2-10"><i class="fa fa-check"></i><b>2.10</b> 练习</a></li>
</ul></li>
<li class="part"><span><b>II 磨刀</b></span></li>
<li class="chapter" data-level="3" data-path="chap3.html"><a href="chap3.html"><i class="fa fa-check"></i><b>3</b> 联合推断程序和多重比较</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chap3.html"><a href="chap3.html#sec3-1"><i class="fa fa-check"></i><b>3.1</b> 错误率</a></li>
<li class="chapter" data-level="3.2" data-path="chap3.html"><a href="chap3.html#sec3-2"><i class="fa fa-check"></i><b>3.2</b> 建议</a></li>
<li class="chapter" data-level="3.3" data-path="chap3.html"><a href="chap3.html#sec3-3"><i class="fa fa-check"></i><b>3.3</b> 最小显著差异</a></li>
<li class="chapter" data-level="3.4" data-path="chap3.html"><a href="chap3.html#sec3-4"><i class="fa fa-check"></i><b>3.4</b> Fisher’s LSD Procedure</a></li>
<li class="chapter" data-level="3.5" data-path="chap3.html"><a href="chap3.html#sec3-5"><i class="fa fa-check"></i><b>3.5</b> Bonferroni’s Method</a></li>
<li class="chapter" data-level="3.6" data-path="chap3.html"><a href="chap3.html#sec3-6"><i class="fa fa-check"></i><b>3.6</b> Scheffé’s Procedure</a></li>
<li class="chapter" data-level="3.7" data-path="chap3.html"><a href="chap3.html#sec3-7"><i class="fa fa-check"></i><b>3.7</b> Tukey–Kramer Method</a></li>
<li class="chapter" data-level="3.8" data-path="chap3.html"><a href="chap3.html#sec3-8"><i class="fa fa-check"></i><b>3.8</b> 模拟方法</a></li>
<li class="chapter" data-level="3.9" data-path="chap3.html"><a href="chap3.html#sec3-9"><i class="fa fa-check"></i><b>3.9</b> Šidák Procedure</a></li>
<li class="chapter" data-level="3.10" data-path="chap3.html"><a href="chap3.html#sec3-10"><i class="fa fa-check"></i><b>3.10</b> 示例：成对比较</a></li>
<li class="chapter" data-level="3.11" data-path="chap3.html"><a href="chap3.html#sec3-11"><i class="fa fa-check"></i><b>3.11</b> Dunnett’s Procedure</a></li>
<li class="chapter" data-level="3.12" data-path="chap3.html"><a href="chap3.html#sec3-12"><i class="fa fa-check"></i><b>3.12</b> 示例：与对照比较</a></li>
<li class="chapter" data-level="3.13" data-path="chap3.html"><a href="chap3.html#sec3-13"><i class="fa fa-check"></i><b>3.13</b> 多元 <span class="math inline">\(t\)</span></a></li>
<li class="chapter" data-level="3.14" data-path="chap3.html"><a href="chap3.html#sec3-14"><i class="fa fa-check"></i><b>3.14</b> 示例：线性独立比较</a></li>
<li class="chapter" data-level="3.15" data-path="chap3.html"><a href="chap3.html#sec3-15"><i class="fa fa-check"></i><b>3.15</b> 序贯拒绝方法</a>
<ul>
<li class="chapter" data-level="3.15.1" data-path="chap3.html"><a href="chap3.html#sec3-15-1"><i class="fa fa-check"></i><b>3.15.1</b> Bonferroni–Holm Method</a></li>
<li class="chapter" data-level="3.15.2" data-path="chap3.html"><a href="chap3.html#sec3-15-2"><i class="fa fa-check"></i><b>3.15.2</b> Šidák–Holm Method</a></li>
<li class="chapter" data-level="3.15.3" data-path="chap3.html"><a href="chap3.html#sec3-15-3"><i class="fa fa-check"></i><b>3.15.3</b> 控制 FDR 的 Benjamini 和 Hochberg Method</a></li>
</ul></li>
<li class="chapter" data-level="3.16" data-path="chap3.html"><a href="chap3.html#sec3-16"><i class="fa fa-check"></i><b>3.16</b> 示例：线性相关比较</a></li>
<li class="chapter" data-level="3.17" data-path="chap3.html"><a href="chap3.html#sec3-17"><i class="fa fa-check"></i><b>3.17</b> 多重极差检验</a>
<ul>
<li class="chapter" data-level="3.17.1" data-path="chap3.html"><a href="chap3.html#sec3-17-1"><i class="fa fa-check"></i><b>3.17.1</b> Student–Newman–Keul’s Method</a></li>
<li class="chapter" data-level="3.17.2" data-path="chap3.html"><a href="chap3.html#sec3-17-2"><i class="fa fa-check"></i><b>3.17.2</b> Duncan’s New Multiple Range Method</a></li>
</ul></li>
<li class="chapter" data-level="3.18" data-path="chap3.html"><a href="chap3.html#sec3-18"><i class="fa fa-check"></i><b>3.18</b> Waller–Duncan Procedure</a></li>
<li class="chapter" data-level="3.19" data-path="chap3.html"><a href="chap3.html#sec3-19"><i class="fa fa-check"></i><b>3.19</b> 示例：成对比较的多重极差</a></li>
<li class="chapter" data-level="3.20" data-path="chap3.html"><a href="chap3.html#sec3-20"><i class="fa fa-check"></i><b>3.20</b> 警示</a></li>
<li class="chapter" data-level="3.21" data-path="chap3.html"><a href="chap3.html#sec3-21"><i class="fa fa-check"></i><b>3.21</b> 结束语</a></li>
<li class="chapter" data-level="3.22" data-path="chap3.html"><a href="chap3.html#sec3-22"><i class="fa fa-check"></i><b>3.22</b> 练习</a></li>
<li class="chapter" data-level="" data-path="chap3.html"><a href="chap3.html#参考文献"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap4.html"><a href="chap4.html"><i class="fa fa-check"></i><b>4</b> 实验设计基础</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chap4.html"><a href="chap4.html#sec4-1"><i class="fa fa-check"></i><b>4.1</b> 介绍基本概念</a></li>
<li class="chapter" data-level="4.2" data-path="chap4.html"><a href="chap4.html#sec4-2"><i class="fa fa-check"></i><b>4.2</b> 设计实验的结构</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="chap4.html"><a href="chap4.html#sec4-2-1"><i class="fa fa-check"></i><b>4.2.1</b> 设计结构类型</a></li>
<li class="chapter" data-level="4.2.2" data-path="chap4.html"><a href="chap4.html#sec4-2-2"><i class="fa fa-check"></i><b>4.2.2</b> 处理结构类型</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chap4.html"><a href="chap4.html#sec4-3"><i class="fa fa-check"></i><b>4.3</b> 不同设计实验的示例</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chap4.html"><a href="chap4.html#sec4-3-1"><i class="fa fa-check"></i><b>4.3.1</b> 示例 4.1: 饮食</a></li>
<li class="chapter" data-level="4.3.2" data-path="chap4.html"><a href="chap4.html#sec4-3-2"><i class="fa fa-check"></i><b>4.3.2</b> 示例 4.2: 房屋油漆</a></li>
<li class="chapter" data-level="4.3.3" data-path="chap4.html"><a href="chap4.html#sec4-3-3"><i class="fa fa-check"></i><b>4.3.3</b> 示例 4.3: 钢板</a></li>
<li class="chapter" data-level="4.3.4" data-path="chap4.html"><a href="chap4.html#sec4-3-4"><i class="fa fa-check"></i><b>4.3.4</b> 示例 4.4: 氮和钾的水平</a></li>
<li class="chapter" data-level="4.3.5" data-path="chap4.html"><a href="chap4.html#sec4-3-5"><i class="fa fa-check"></i><b>4.3.5</b> 示例 4.5: 区组和重复</a></li>
<li class="chapter" data-level="4.3.6" data-path="chap4.html"><a href="chap4.html#sec4-3-6"><i class="fa fa-check"></i><b>4.3.6</b> 示例 4.6：行区组和列区组</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chap4.html"><a href="chap4.html#sec4-4"><i class="fa fa-check"></i><b>4.4</b> 结束语</a></li>
<li class="chapter" data-level="4.5" data-path="chap4.html"><a href="chap4.html#sec4-5"><i class="fa fa-check"></i><b>4.5</b> 练习</a></li>
<li class="chapter" data-level="" data-path="chap4.html"><a href="chap4.html#参考文献-1"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap5.html"><a href="chap5.html"><i class="fa fa-check"></i><b>5</b> 多水平设计：裂区、裂条区、重复测量及其组合</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap5.html"><a href="chap5.html#sec5-1"><i class="fa fa-check"></i><b>5.1</b> 识别实验单元的尺寸——四种基本设计结构</a></li>
<li class="chapter" data-level="5.2" data-path="chap5.html"><a href="chap5.html#sec5-2"><i class="fa fa-check"></i><b>5.2</b> 分层设计：一种多水平的设计结构</a></li>
<li class="chapter" data-level="5.3" data-path="chap5.html"><a href="chap5.html#sec5-3"><i class="fa fa-check"></i><b>5.3</b> 裂区设计结构：两水平设计结构</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chap5.html"><a href="chap5.html#sec5-3-1"><i class="fa fa-check"></i><b>5.3.1</b> 示例 5.1：烹饪大豆——最简单的裂区或两水平设计结构</a></li>
<li class="chapter" data-level="5.3.2" data-path="chap5.html"><a href="chap5.html#sec5-3-2"><i class="fa fa-check"></i><b>5.3.2</b> 示例 5.2：磨小麦——通常的裂区或两水平设计结构</a></li>
<li class="chapter" data-level="5.3.3" data-path="chap5.html"><a href="chap5.html#sec5-3-3"><i class="fa fa-check"></i><b>5.3.3</b> 示例 5.3：烘焙面包——具有不完全块设计结构的裂区</a></li>
<li class="chapter" data-level="5.3.4" data-path="chap5.html"><a href="chap5.html#sec5-3-4"><i class="fa fa-check"></i><b>5.3.4</b> 示例 5.4：展示柜中的肉——复杂裂区或四水平设计</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chap5.html"><a href="chap5.html#sec5-4"><i class="fa fa-check"></i><b>5.4</b> 裂条区设计结构：一种无层次的多水平设计</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chap5.html"><a href="chap5.html#sec5-4-1"><i class="fa fa-check"></i><b>5.4.1</b> 示例 5.5：制作奶酪</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="chap5.html"><a href="chap5.html#sec5-5"><i class="fa fa-check"></i><b>5.5</b> 重复测量设计</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="chap5.html"><a href="chap5.html#sec5-5-1"><i class="fa fa-check"></i><b>5.5.1</b> 示例 5.6：马足——基本重复测量设计</a></li>
<li class="chapter" data-level="5.5.2" data-path="chap5.html"><a href="chap5.html#sec5-5-2"><i class="fa fa-check"></i><b>5.5.2</b> 示例 5.7：舒适度研究——重复测量设计</a></li>
<li class="chapter" data-level="5.5.3" data-path="chap5.html"><a href="chap5.html#示例-5.8交叉或转换设计"><i class="fa fa-check"></i><b>5.5.3</b> 示例 5.8：交叉或转换设计</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="chap5.html"><a href="chap5.html#sec5-6"><i class="fa fa-check"></i><b>5.6</b> 涉及嵌套因素的设计</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="chap5.html"><a href="chap5.html#sec5-6-1"><i class="fa fa-check"></i><b>5.6.1</b> 示例 5.9：动物遗传学</a></li>
<li class="chapter" data-level="5.6.2" data-path="chap5.html"><a href="chap5.html#sec5-6-2"><i class="fa fa-check"></i><b>5.6.2</b> 示例 5.10：大豆的生育期组</a></li>
<li class="chapter" data-level="5.6.3" data-path="chap5.html"><a href="chap5.html#sec5-6-3"><i class="fa fa-check"></i><b>5.6.3</b> 示例 5.11：飞机引擎</a></li>
<li class="chapter" data-level="5.6.4" data-path="chap5.html"><a href="chap5.html#sec5-6-4"><i class="fa fa-check"></i><b>5.6.4</b> 示例 5.12：简单的舒适度实验</a></li>
<li class="chapter" data-level="5.6.5" data-path="chap5.html"><a href="chap5.html#sec5-6-5"><i class="fa fa-check"></i><b>5.6.5</b> 示例 5.13：重复测量的多地点研究</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="chap5.html"><a href="chap5.html#sec5-7"><i class="fa fa-check"></i><b>5.7</b> 结束语</a></li>
<li class="chapter" data-level="5.8" data-path="chap5.html"><a href="chap5.html#sec5-8"><i class="fa fa-check"></i><b>5.8</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap6.html"><a href="chap6.html"><i class="fa fa-check"></i><b>6</b> 模型的矩阵形式</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chap6.html"><a href="chap6.html#sec6-1"><i class="fa fa-check"></i><b>6.1</b> 基本符号</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chap6.html"><a href="chap6.html#sec6-1-1"><i class="fa fa-check"></i><b>6.1.1</b> 简单线性回归模型</a></li>
<li class="chapter" data-level="6.1.2" data-path="chap6.html"><a href="chap6.html#sec6-1-2"><i class="fa fa-check"></i><b>6.1.2</b> 单向处理结构模型</a></li>
<li class="chapter" data-level="6.1.3" data-path="chap6.html"><a href="chap6.html#sec6-1-3"><i class="fa fa-check"></i><b>6.1.3</b> 双向处理结构模型</a></li>
<li class="chapter" data-level="6.1.4" data-path="chap6.html"><a href="chap6.html#sec6-1-4"><i class="fa fa-check"></i><b>6.1.4</b> 示例 6.1：双向处理结构的均值模型</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chap6.html"><a href="chap6.html#sec6-2"><i class="fa fa-check"></i><b>6.2</b> 最小二乘估计</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="chap6.html"><a href="chap6.html#sec6-2-1"><i class="fa fa-check"></i><b>6.2.1</b> 最小二乘方程组</a></li>
<li class="chapter" data-level="6.2.2" data-path="chap6.html"><a href="chap6.html#sec6-2-2"><i class="fa fa-check"></i><b>6.2.2</b> 零和限制</a></li>
<li class="chapter" data-level="6.2.3" data-path="chap6.html"><a href="chap6.html#sec6-2-3"><i class="fa fa-check"></i><b>6.2.3</b> 置零限制</a></li>
<li class="chapter" data-level="6.2.4" data-path="chap6.html"><a href="chap6.html#sec6-2-4"><i class="fa fa-check"></i><b>6.2.4</b> 示例 6.2：单向处理结构</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="chap6.html"><a href="chap6.html#sec6-3"><i class="fa fa-check"></i><b>6.3</b> 可估性和连通的设计</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chap6.html"><a href="chap6.html#sec6-3-1"><i class="fa fa-check"></i><b>6.3.1</b> 可估函数</a></li>
<li class="chapter" data-level="6.3.2" data-path="chap6.html"><a href="chap6.html#sec6-3-2"><i class="fa fa-check"></i><b>6.3.2</b> 连通性</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="chap6.html"><a href="chap6.html#sec6-4"><i class="fa fa-check"></i><b>6.4</b> 关于线性模型参数的检验假设</a></li>
<li class="chapter" data-level="6.5" data-path="chap6.html"><a href="chap6.html#sec6-5"><i class="fa fa-check"></i><b>6.5</b> 总体边际均值</a></li>
<li class="chapter" data-level="6.6" data-path="chap6.html"><a href="chap6.html#sec6-6"><i class="fa fa-check"></i><b>6.6</b> 结束语</a></li>
<li class="chapter" data-level="6.7" data-path="chap6.html"><a href="chap6.html#sec6-7"><i class="fa fa-check"></i><b>6.7</b> 练习</a></li>
</ul></li>
<li class="part"><span><b>III 砍柴</b></span></li>
<li class="chapter" data-level="7" data-path="chap7.html"><a href="chap7.html"><i class="fa fa-check"></i><b>7</b> 均衡双向处理结构</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chap7.html"><a href="chap7.html#sec7-1"><i class="fa fa-check"></i><b>7.1</b> 模型定义和假设</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="chap7.html"><a href="chap7.html#sec7-1-1"><i class="fa fa-check"></i><b>7.1.1</b> 均值模型</a></li>
<li class="chapter" data-level="7.1.2" data-path="chap7.html"><a href="chap7.html#sec7-1-2"><i class="fa fa-check"></i><b>7.1.2</b> 效应模型</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="chap7.html"><a href="chap7.html#sec7-2"><i class="fa fa-check"></i><b>7.2</b> 参数估计</a></li>
<li class="chapter" data-level="7.3" data-path="chap7.html"><a href="chap7.html#sec7-3"><i class="fa fa-check"></i><b>7.3</b> 交互作用及它们的重要性</a></li>
<li class="chapter" data-level="7.4" data-path="chap7.html"><a href="chap7.html#sec7-4"><i class="fa fa-check"></i><b>7.4</b> 主效应</a></li>
<li class="chapter" data-level="7.5" data-path="chap7.html"><a href="chap7.html#sec7-5"><i class="fa fa-check"></i><b>7.5</b> 计算机分析</a></li>
<li class="chapter" data-level="7.6" data-path="chap7.html"><a href="chap7.html#sec7-6"><i class="fa fa-check"></i><b>7.6</b> 结束语</a></li>
<li class="chapter" data-level="7.7" data-path="chap7.html"><a href="chap7.html#sec7-7"><i class="fa fa-check"></i><b>7.7</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap8.html"><a href="chap8.html"><i class="fa fa-check"></i><b>8</b> 案例研究：均衡双向实验的完整分析</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chap8.html"><a href="chap8.html#sec8-1"><i class="fa fa-check"></i><b>8.1</b> 主效应均值对比</a></li>
<li class="chapter" data-level="8.2" data-path="chap8.html"><a href="chap8.html#sec8-2"><i class="fa fa-check"></i><b>8.2</b> 交互对比</a></li>
<li class="chapter" data-level="8.3" data-path="chap8.html"><a href="chap8.html#sec8-3"><i class="fa fa-check"></i><b>8.3</b> 油漆铺路示例</a></li>
<li class="chapter" data-level="8.4" data-path="chap8.html"><a href="chap8.html#sec8-4"><i class="fa fa-check"></i><b>8.4</b> 分析定量处理因素</a></li>
<li class="chapter" data-level="8.5" data-path="chap8.html"><a href="chap8.html#sec8-5"><i class="fa fa-check"></i><b>8.5</b> 多重检验</a></li>
<li class="chapter" data-level="8.6" data-path="chap8.html"><a href="chap8.html#sec8-6"><i class="fa fa-check"></i><b>8.6</b> 结束语</a></li>
<li class="chapter" data-level="8.7" data-path="chap8.html"><a href="chap8.html#sec8-7"><i class="fa fa-check"></i><b>8.7</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap9.html"><a href="chap9.html"><i class="fa fa-check"></i><b>9</b> 使用均值模型分析子类数不等的均衡双向处理结构</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chap9.html"><a href="chap9.html#sec9-1"><i class="fa fa-check"></i><b>9.1</b> 模型定义和假设</a></li>
<li class="chapter" data-level="9.2" data-path="chap9.html"><a href="chap9.html#sec9-2"><i class="fa fa-check"></i><b>9.2</b> 参数估计</a></li>
<li class="chapter" data-level="9.3" data-path="chap9.html"><a href="chap9.html#sec9-3"><i class="fa fa-check"></i><b>9.3</b> 检验所有均值是否相等</a></li>
<li class="chapter" data-level="9.4" data-path="chap9.html"><a href="chap9.html#sec9-4"><i class="fa fa-check"></i><b>9.4</b> 交互作用和主效应假设</a></li>
<li class="chapter" data-level="9.5" data-path="chap9.html"><a href="chap9.html#sec9-5"><i class="fa fa-check"></i><b>9.5</b> 总体边际均值</a></li>
<li class="chapter" data-level="9.6" data-path="chap9.html"><a href="chap9.html#sec9-6"><i class="fa fa-check"></i><b>9.6</b> 同时推断与多重比较</a></li>
<li class="chapter" data-level="9.7" data-path="chap9.html"><a href="chap9.html#sec9-7"><i class="fa fa-check"></i><b>9.7</b> 结束语</a></li>
<li class="chapter" data-level="9.8" data-path="chap9.html"><a href="chap9.html#sec9-8"><i class="fa fa-check"></i><b>9.8</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> 使用效应模型分析子类数不等的均衡双向处理结构</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chap10.html"><a href="chap10.html#sec10-1"><i class="fa fa-check"></i><b>10.1</b> 模型定义</a></li>
<li class="chapter" data-level="10.2" data-path="chap10.html"><a href="chap10.html#sec10-2"><i class="fa fa-check"></i><b>10.2</b> 参数估计和 I 型分析</a></li>
<li class="chapter" data-level="10.3" data-path="chap10.html"><a href="chap10.html#sec10-3"><i class="fa fa-check"></i><b>10.3</b> 在 SAS 中使用可估函数</a></li>
<li class="chapter" data-level="10.4" data-path="chap10.html"><a href="chap10.html#sec10-4"><i class="fa fa-check"></i><b>10.4</b> I–IV 型假设</a></li>
<li class="chapter" data-level="10.5" data-path="chap10.html"><a href="chap10.html#sec10-5"><i class="fa fa-check"></i><b>10.5</b> 在 SAS-GLM 中使用 I–IV 型可估函数</a></li>
<li class="chapter" data-level="10.6" data-path="chap10.html"><a href="chap10.html#sec10-6"><i class="fa fa-check"></i><b>10.6</b> 总体边际均值与最小二乘均值</a></li>
<li class="chapter" data-level="10.7" data-path="chap10.html"><a href="chap10.html#sec10-7"><i class="fa fa-check"></i><b>10.7</b> 计算机分析</a></li>
<li class="chapter" data-level="10.8" data-path="chap10.html"><a href="chap10.html#sec10-8"><i class="fa fa-check"></i><b>10.8</b> 结束语</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap11.html"><a href="chap11.html"><i class="fa fa-check"></i><b>11</b> 分析子类数不等的大型均衡双向实验</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chap11.html"><a href="chap11.html#sec11-1"><i class="fa fa-check"></i><b>11.1</b> 可行性问题</a></li>
<li class="chapter" data-level="11.2" data-path="chap11.html"><a href="chap11.html#sec11-2"><i class="fa fa-check"></i><b>11.2</b> 未加权均值法</a></li>
<li class="chapter" data-level="11.3" data-path="chap11.html"><a href="chap11.html#sec11-3"><i class="fa fa-check"></i><b>11.3</b> 同时推断与多重比较</a></li>
<li class="chapter" data-level="11.4" data-path="chap11.html"><a href="chap11.html#sec11-4"><i class="fa fa-check"></i><b>11.4</b> 未加权均值的示例</a></li>
<li class="chapter" data-level="11.5" data-path="chap11.html"><a href="chap11.html#sec11-5"><i class="fa fa-check"></i><b>11.5</b> 计算机分析</a></li>
<li class="chapter" data-level="11.6" data-path="chap11.html"><a href="chap11.html#sec11-6"><i class="fa fa-check"></i><b>11.6</b> 结束语</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chap12.html"><a href="chap12.html"><i class="fa fa-check"></i><b>12</b> 案例研究：子类数不等的均衡双向处理结构</a>
<ul>
<li class="chapter" data-level="12.1" data-path="chap12.html"><a href="chap12.html#sec12-1"><i class="fa fa-check"></i><b>12.1</b> 脂肪-表面活性剂示例</a></li>
<li class="chapter" data-level="12.2" data-path="chap12.html"><a href="chap12.html#sec12-2"><i class="fa fa-check"></i><b>12.2</b> 结束语</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap13.html"><a href="chap13.html"><i class="fa fa-check"></i><b>13</b> 使用均值模型分析缺失处理组合的双向处理结构</a>
<ul>
<li class="chapter" data-level="13.1" data-path="chap13.html"><a href="chap13.html#sec13-1"><i class="fa fa-check"></i><b>13.1</b> 参数估计</a></li>
<li class="chapter" data-level="13.2" data-path="chap13.html"><a href="chap13.html#sec13-2"><i class="fa fa-check"></i><b>13.2</b> 假设检验和置信区间</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="chap13.html"><a href="chap13.html#sec13-2-1"><i class="fa fa-check"></i><b>13.2.1</b> 示例 13.1</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="chap13.html"><a href="chap13.html#sec13-3"><i class="fa fa-check"></i><b>13.3</b> 计算机分析</a></li>
<li class="chapter" data-level="13.4" data-path="chap13.html"><a href="chap13.html#sec13-4"><i class="fa fa-check"></i><b>13.4</b> 结束语</a></li>
<li class="chapter" data-level="13.5" data-path="chap13.html"><a href="chap13.html#sec13-5"><i class="fa fa-check"></i><b>13.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="chap14.html"><a href="chap14.html"><i class="fa fa-check"></i><b>14</b> 使用效应模型分析缺失处理组合的双向处理结构</a>
<ul>
<li class="chapter" data-level="14.1" data-path="chap14.html"><a href="chap14.html#i-型和-ii-型假设"><i class="fa fa-check"></i><b>14.1</b> I 型和 II 型假设</a></li>
<li class="chapter" data-level="14.2" data-path="chap14.html"><a href="chap14.html#iii-型假设"><i class="fa fa-check"></i><b>14.2</b> III 型假设</a></li>
<li class="chapter" data-level="14.3" data-path="chap14.html"><a href="chap14.html#sec14-3"><i class="fa fa-check"></i><b>14.3</b> IV 型假设</a></li>
<li class="chapter" data-level="14.4" data-path="chap14.html"><a href="chap14.html#sec14-4"><i class="fa fa-check"></i><b>14.4</b> 总体边际均值和最小二乘均值</a></li>
<li class="chapter" data-level="14.5" data-path="chap14.html"><a href="chap14.html#sec14-5"><i class="fa fa-check"></i><b>14.5</b> 计算机分析</a></li>
<li class="chapter" data-level="14.6" data-path="chap14.html"><a href="chap14.html#sec14-6"><i class="fa fa-check"></i><b>14.6</b> 结束语</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="chap15.html"><a href="chap15.html"><i class="fa fa-check"></i><b>15</b> 案例研究：缺失处理组合的双向处理结构</a>
<ul>
<li class="chapter" data-level="15.1" data-path="chap15.html"><a href="chap15.html#sec15-1"><i class="fa fa-check"></i><b>15.1</b> 案例研究</a></li>
<li class="chapter" data-level="15.2" data-path="chap15.html"><a href="chap15.html#sec15-2"><i class="fa fa-check"></i><b>15.2</b> 结束语</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="chap16.html"><a href="chap16.html"><i class="fa fa-check"></i><b>16</b> 分析三向和高阶处理结构</a>
<ul>
<li class="chapter" data-level="16.1" data-path="chap16.html"><a href="chap16.html#sec16-1"><i class="fa fa-check"></i><b>16.1</b> 一般策略</a></li>
<li class="chapter" data-level="16.2" data-path="chap16.html"><a href="chap16.html#sec16-2"><i class="fa fa-check"></i><b>16.2</b> 均衡和不均衡实验</a></li>
<li class="chapter" data-level="16.3" data-path="chap16.html"><a href="chap16.html#sec16-3"><i class="fa fa-check"></i><b>16.3</b> I 型和 II 型分析</a></li>
<li class="chapter" data-level="16.4" data-path="chap16.html"><a href="chap16.html#sec16-4"><i class="fa fa-check"></i><b>16.4</b> 结束语</a></li>
<li class="chapter" data-level="16.5" data-path="chap16.html"><a href="chap16.html#sec16-5"><i class="fa fa-check"></i><b>16.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="chap17.html"><a href="chap17.html"><i class="fa fa-check"></i><b>17</b> 案例研究：具有许多缺失处理组合的三向处理结构</a>
<ul>
<li class="chapter" data-level="17.1" data-path="chap17.html"><a href="chap17.html#sec17-1"><i class="fa fa-check"></i><b>17.1</b> 营养评分示例</a></li>
<li class="chapter" data-level="17.2" data-path="chap17.html"><a href="chap17.html#sec17-2"><i class="fa fa-check"></i><b>17.2</b> SAS-GLM 分析</a></li>
<li class="chapter" data-level="17.3" data-path="chap17.html"><a href="chap17.html#sec17-3"><i class="fa fa-check"></i><b>17.3</b> 一个完整的分析</a></li>
<li class="chapter" data-level="17.4" data-path="chap17.html"><a href="chap17.html#sec17-4"><i class="fa fa-check"></i><b>17.4</b> 结束语</a></li>
<li class="chapter" data-level="17.5" data-path="chap17.html"><a href="chap17.html#sec17-5"><i class="fa fa-check"></i><b>17.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="chap18.html"><a href="chap18.html"><i class="fa fa-check"></i><b>18</b> 随机效应模型和方差分量</a>
<ul>
<li class="chapter" data-level="18.1" data-path="chap18.html"><a href="chap18.html#sec18-1"><i class="fa fa-check"></i><b>18.1</b> 介绍</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="chap18.html"><a href="chap18.html#sec18-1-1"><i class="fa fa-check"></i><b>18.1.1</b> 示例 18.1：随机效应嵌套处理结构</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="chap18.html"><a href="chap18.html#sec18-2"><i class="fa fa-check"></i><b>18.2</b> 矩阵表示法中的一般随机效应模型</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="chap18.html"><a href="chap18.html#sec18-2-1"><i class="fa fa-check"></i><b>18.2.1</b> 示例 18.2：单向随机效应模型</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="chap18.html"><a href="chap18.html#sec18-3"><i class="fa fa-check"></i><b>18.3</b> 计算期望均方</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="chap18.html"><a href="chap18.html#sec18-3-1"><i class="fa fa-check"></i><b>18.3.1</b> 代数方法</a></li>
<li class="chapter" data-level="18.3.2" data-path="chap18.html"><a href="chap18.html#sec18-3-2"><i class="fa fa-check"></i><b>18.3.2</b> Hartley 综合法的计算</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="chap18.html"><a href="chap18.html#sec18-4"><i class="fa fa-check"></i><b>18.4</b> 结束语</a></li>
<li class="chapter" data-level="18.5" data-path="chap18.html"><a href="chap18.html#sec18-5"><i class="fa fa-check"></i><b>18.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="chap19.html"><a href="chap19.html"><i class="fa fa-check"></i><b>19</b> 方差分量的估计方法</a>
<ul>
<li class="chapter" data-level="19.1" data-path="chap19.html"><a href="chap19.html#sec19-1"><i class="fa fa-check"></i><b>19.1</b> 矩法</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="chap19.html"><a href="chap19.html#sec19-1-1"><i class="fa fa-check"></i><b>19.1.1</b> 应用。示例 19.1：不均衡单向模型</a></li>
<li class="chapter" data-level="19.1.2" data-path="chap19.html"><a href="chap19.html#sec19-1-2"><i class="fa fa-check"></i><b>19.1.2</b> 示例 19.2：单向随机效应模型中的小麦品种</a></li>
<li class="chapter" data-level="19.1.3" data-path="chap19.html"><a href="chap19.html#sec19-1-3"><i class="fa fa-check"></i><b>19.1.3</b> 示例 19.3：表 18.2 中的双向设计数据</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="chap19.html"><a href="chap19.html#sec19-2"><i class="fa fa-check"></i><b>19.2</b> 最大似然</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="chap19.html"><a href="chap19.html#sec19-2-1"><i class="fa fa-check"></i><b>19.2.1</b> 示例 19.4：均衡单向模型的最大似然解</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="chap19.html"><a href="chap19.html#sec19-3"><i class="fa fa-check"></i><b>19.3</b> 受限或残差最大似然估计</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="chap19.html"><a href="chap19.html#sec19-3-1"><i class="fa fa-check"></i><b>19.3.1</b> 示例 19.5：均衡单向模型的 REML 解</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="chap19.html"><a href="chap19.html#sec19-4"><i class="fa fa-check"></i><b>19.4</b> MIVQUE 法</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="chap19.html"><a href="chap19.html#sec19-4-1"><i class="fa fa-check"></i><b>19.4.1</b> 方法说明</a></li>
<li class="chapter" data-level="19.4.2" data-path="chap19.html"><a href="chap19.html#sec19-4-2"><i class="fa fa-check"></i><b>19.4.2</b> 应用。示例 19.6：MIVQUE 用于不均衡单向设计</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="chap19.html"><a href="chap19.html#sec19-5"><i class="fa fa-check"></i><b>19.5</b> 使用 JMP 估计方差分量</a></li>
<li class="chapter" data-level="19.6" data-path="chap19.html"><a href="chap19.html#sec19-6"><i class="fa fa-check"></i><b>19.6</b> 结束语</a></li>
<li class="chapter" data-level="19.7" data-path="chap19.html"><a href="chap19.html#sec19-7"><i class="fa fa-check"></i><b>19.7</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="chap20.html"><a href="chap20.html"><i class="fa fa-check"></i><b>20</b> 方差分量的推断方法</a>
<ul>
<li class="chapter" data-level="20.1" data-path="chap20.html"><a href="chap20.html#sec20-1"><i class="fa fa-check"></i><b>20.1</b> 假设检验</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="chap20.html"><a href="chap20.html#sec20-1-1"><i class="fa fa-check"></i><b>20.1.1</b> 使用方差分析表</a></li>
<li class="chapter" data-level="20.1.2" data-path="chap20.html"><a href="chap20.html#sec20-1-2"><i class="fa fa-check"></i><b>20.1.2</b> 示例 20.1：完全随机设计结构中的双向随机效应检验统计量</a></li>
<li class="chapter" data-level="20.1.3" data-path="chap20.html"><a href="chap20.html#sec20-1-3"><i class="fa fa-check"></i><b>20.1.3</b> 示例 20.2：复杂三向随机效应检验统计量</a></li>
<li class="chapter" data-level="20.1.4" data-path="chap20.html"><a href="chap20.html#sec20-1-4"><i class="fa fa-check"></i><b>20.1.4</b> 似然比检验</a></li>
<li class="chapter" data-level="20.1.5" data-path="chap20.html"><a href="chap20.html#sec20-1-5"><i class="fa fa-check"></i><b>20.1.5</b> 示例 20.3：小麦品种——单向随机效应模型</a></li>
<li class="chapter" data-level="20.1.6" data-path="chap20.html"><a href="chap20.html#sec20-1-6"><i class="fa fa-check"></i><b>20.1.6</b> 示例 20.4：不均衡双向</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="chap20.html"><a href="chap20.html#sec20-2"><i class="fa fa-check"></i><b>20.2</b> 构造置信区间</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="chap20.html"><a href="chap20.html#sec20-2-1"><i class="fa fa-check"></i><b>20.2.1</b> 残差方差 <span class="math inline">\(\sigma^2_\varepsilon\)</span></a></li>
<li class="chapter" data-level="20.2.2" data-path="chap20.html"><a href="chap20.html#sec20-2-2"><i class="fa fa-check"></i><b>20.2.2</b> 一般 Satterthwaite 近似</a></li>
<li class="chapter" data-level="20.2.3" data-path="chap20.html"><a href="chap20.html#sec20-2-3"><i class="fa fa-check"></i><b>20.2.3</b> 方差分量函数的近似置信区间</a></li>
<li class="chapter" data-level="20.2.4" data-path="chap20.html"><a href="chap20.html#sec20-2-4"><i class="fa fa-check"></i><b>20.2.4</b> 方差分量的 Wald 型置信区间</a></li>
<li class="chapter" data-level="20.2.5" data-path="chap20.html"><a href="chap20.html#sec20-2-5"><i class="fa fa-check"></i><b>20.2.5</b> 一些精确的置信区间</a></li>
<li class="chapter" data-level="20.2.6" data-path="chap20.html"><a href="chap20.html#sec20-2-6"><i class="fa fa-check"></i><b>20.2.6</b> 示例 20.5：均衡单向随机效应处理结构</a></li>
<li class="chapter" data-level="20.2.7" data-path="chap20.html"><a href="chap20.html#sec20-2-7"><i class="fa fa-check"></i><b>20.2.7</b> 示例 20.6</a></li>
<li class="chapter" data-level="20.2.8" data-path="chap20.html"><a href="chap20.html#sec20-2-8"><i class="fa fa-check"></i><b>20.2.8</b> 示例 20.6 （续）</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="chap20.html"><a href="chap20.html#sec20-3"><i class="fa fa-check"></i><b>20.3</b> 模拟研究</a></li>
<li class="chapter" data-level="20.4" data-path="chap20.html"><a href="chap20.html#sec20-4"><i class="fa fa-check"></i><b>20.4</b> 结束语</a></li>
<li class="chapter" data-level="20.5" data-path="chap20.html"><a href="chap20.html#sec20-5"><i class="fa fa-check"></i><b>20.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="chap21.html"><a href="chap21.html"><i class="fa fa-check"></i><b>21</b> 案例研究：随机效应模型分析</a>
<ul>
<li class="chapter" data-level="21.1" data-path="chap21.html"><a href="chap21.html#sec21-1"><i class="fa fa-check"></i><b>21.1</b> 数据集</a></li>
<li class="chapter" data-level="21.2" data-path="chap21.html"><a href="chap21.html#sec21-2"><i class="fa fa-check"></i><b>21.2</b> 估计</a></li>
<li class="chapter" data-level="21.3" data-path="chap21.html"><a href="chap21.html#sec21-3"><i class="fa fa-check"></i><b>21.3</b> 模型构建</a></li>
<li class="chapter" data-level="21.4" data-path="chap21.html"><a href="chap21.html#sec21-4"><i class="fa fa-check"></i><b>21.4</b> 缩减模型</a></li>
<li class="chapter" data-level="21.5" data-path="chap21.html"><a href="chap21.html#sec21-5"><i class="fa fa-check"></i><b>21.5</b> 置信区间</a></li>
<li class="chapter" data-level="21.6" data-path="chap21.html"><a href="chap21.html#sec21-6"><i class="fa fa-check"></i><b>21.6</b> 使用 JMP 进行计算</a></li>
<li class="chapter" data-level="21.7" data-path="chap21.html"><a href="chap21.html#sec21-7"><i class="fa fa-check"></i><b>21.7</b> 结束语</a></li>
<li class="chapter" data-level="21.8" data-path="chap21.html"><a href="chap21.html#sec21-8"><i class="fa fa-check"></i><b>21.8</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="chap22.html"><a href="chap22.html"><i class="fa fa-check"></i><b>22</b> 混合模型的分析</a>
<ul>
<li class="chapter" data-level="22.1" data-path="chap22.html"><a href="chap22.html#sec22-1"><i class="fa fa-check"></i><b>22.1</b> 混合模型简介</a></li>
<li class="chapter" data-level="22.2" data-path="chap22.html"><a href="chap22.html#sec22-2"><i class="fa fa-check"></i><b>22.2</b> 混合模型随机效应部分的分析</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="chap22.html"><a href="chap22.html#sec22-2-1"><i class="fa fa-check"></i><b>22.2.1</b> 矩法</a></li>
<li class="chapter" data-level="22.2.2" data-path="chap22.html"><a href="chap22.html#sec22-2-2"><i class="fa fa-check"></i><b>22.2.2</b> 最大似然方法</a></li>
<li class="chapter" data-level="22.2.3" data-path="chap22.html"><a href="chap22.html#sec22-2-3"><i class="fa fa-check"></i><b>22.2.3</b> 残差最大似然法</a></li>
<li class="chapter" data-level="22.2.4" data-path="chap22.html"><a href="chap22.html#sec22-2-4"><i class="fa fa-check"></i><b>22.2.4</b> MINQUE 法</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="chap22.html"><a href="chap22.html#sec22-3"><i class="fa fa-check"></i><b>22.3</b> 混合模型固定效应部分的分析</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="chap22.html"><a href="chap22.html#sec22-3-1"><i class="fa fa-check"></i><b>22.3.1</b> 估计</a></li>
<li class="chapter" data-level="22.3.2" data-path="chap22.html"><a href="chap22.html#sec22-3-2"><i class="fa fa-check"></i><b>22.3.2</b> 置信区间的构建</a></li>
<li class="chapter" data-level="22.3.3" data-path="chap22.html"><a href="chap22.html#sec22-3-3"><i class="fa fa-check"></i><b>22.3.3</b> 假设检验</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="chap22.html"><a href="chap22.html#sec22-4"><i class="fa fa-check"></i><b>22.4</b> 最佳线性无偏预测</a></li>
<li class="chapter" data-level="22.5" data-path="chap22.html"><a href="chap22.html#sec22-5"><i class="fa fa-check"></i><b>22.5</b> 混合模型方程组</a></li>
<li class="chapter" data-level="22.6" data-path="chap22.html"><a href="chap22.html#sec22-6"><i class="fa fa-check"></i><b>22.6</b> 结束语</a></li>
<li class="chapter" data-level="22.7" data-path="chap22.html"><a href="chap22.html#sec22-7"><i class="fa fa-check"></i><b>22.7</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="chap29.html"><a href="chap29.html"><i class="fa fa-check"></i><b>23</b> 交叉设计的分析</a>
<ul>
<li class="chapter" data-level="23.1" data-path="chap29.html"><a href="chap29.html#sec29-1"><i class="fa fa-check"></i><b>23.1</b> 定义，假设和模型</a></li>
<li class="chapter" data-level="23.2" data-path="chap29.html"><a href="chap29.html#sec29-2"><i class="fa fa-check"></i><b>23.2</b> 两时期/两处理交叉设计</a></li>
<li class="chapter" data-level="23.3" data-path="chap29.html"><a href="chap29.html#sec29-3"><i class="fa fa-check"></i><b>23.3</b> 具有两个以上时期的交叉设计</a></li>
<li class="chapter" data-level="23.4" data-path="chap29.html"><a href="chap29.html#sec29-4"><i class="fa fa-check"></i><b>23.4</b> 具有两种以上处理的交叉设计</a></li>
<li class="chapter" data-level="23.5" data-path="chap29.html"><a href="chap29.html#sec29-5"><i class="fa fa-check"></i><b>23.5</b> 小结</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">混乱数据分析：设计的实验</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap6" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">第 6 章</span> 模型的矩阵形式<a href="chap6.html#chap6" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>当使用不均衡 (unbalanced) 的固定效应模型、随机效应模型或混合效应模型时，求和符号变得非常费力，有时甚至几乎无法使用。这个问题可以通过使用模型的矩阵形式表达来解决。本章讨论了模型矩阵形式的构建，并描述了如何使用矩阵获得最小二乘估计、检验假设、计算最小二乘均值或总体边际均值以及构建置信区间。在 <a href="chap6.html#sec6-3">6.3</a> 节中讨论了可估性 (estimability) 的概念。</p>
<div id="sec6-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> 基本符号<a href="chap6.html#sec6-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>模型的矩阵形式可以表示为</p>
<p><span class="math display" id="eq:6-1">\[\begin{equation}
\underset{n\times1}{\boldsymbol y}=\underset{n × p}{\vphantom{\boldsymbol y}\boldsymbol X} \,\,\underset{p × 1}{\vphantom{\boldsymbol y}\boldsymbol \beta}+\underset{n × 1}{\vphantom{\boldsymbol y}\boldsymbol\varepsilon}
\tag{6.1}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(\boldsymbol y\)</span> 表示 <span class="math inline">\(n \times 1\)</span> 观测向量，<span class="math inline">\(\boldsymbol X\)</span> 表示 <span class="math inline">\(n \times p\)</span> 已知常数矩阵，称为<strong>设计矩阵</strong> (designed matrix)，<span class="math inline">\(\boldsymbol \beta\)</span> 表示 <span class="math inline">\(p \times 1\)</span> 未知参数向量，<span class="math inline">\(\boldsymbol \varepsilon\)</span> 表示 <span class="math inline">\(n \times 1\)</span> 未观测的误差向量。第 <span class="math inline">\(i\)</span> 个观测值（<span class="math inline">\(\boldsymbol y\)</span> 的第 <span class="math inline">\(i\)</span> 个元素）的模型具有以下形式</p>
<p><span class="math display" id="eq:6-2">\[\begin{equation}
y_i=\beta_0+\beta_1x_{i1}+\beta_2x_{i2}+\cdots+\beta_{p-1}x_{ip-1}+\varepsilon_i,\quad i=1,2,\ldots,n
\tag{6.2}
\end{equation}\]</span></p>
<p>用于将模型 <a href="chap6.html#eq:6-2">(6.2)</a> 表示为矩阵模型 <a href="chap6.html#eq:6-1">(6.1)</a> 的向量和矩阵是</p>
<p><span class="math display" id="eq:6-3">\[\begin{equation}
\boldsymbol{y}=\begin{bmatrix}y_1\\y_2\\\vdots\\y_n\end{bmatrix},\quad\boldsymbol{X}=\begin{bmatrix}1&amp;x_{11}&amp;x_{12}&amp;\cdots&amp;x_{1p-1}\\1&amp;x_{21}&amp;x_{22}&amp;\cdots&amp;x_{2p-1}\\\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\1&amp;x_{n1}&amp;x_{n2}&amp;\cdots&amp;x_{np-1}\end{bmatrix},\quad\boldsymbol{\beta}=\begin{bmatrix}\beta_0\\\beta_1\\\beta_2\\\vdots\\\beta_{p-1}\end{bmatrix},\quad\mathrm{and}\quad\boldsymbol{\varepsilon}=\begin{bmatrix}\varepsilon_1\\\varepsilon_2\\\vdots\\\varepsilon_n\end{bmatrix}
\tag{6.3}
\end{equation}\]</span></p>
<p>式 <a href="chap6.html#eq:6-3">(6.3)</a> 中的矩阵可用于表示多种模型类型，包括单向模型、双向模型、析因模型和部分析因模型等设计模型以及回归模型、协方差分析模型、随机模型等。通过指定 <span class="math inline">\(\boldsymbol X\)</span> 的适当元素以及 <span class="math inline">\(\boldsymbol \beta\)</span> 和 <span class="math inline">\(\boldsymbol \varepsilon\)</span> 的适当假设，可以构建效应模型、混合效应模型、裂区模型、重复测量模型和随机系数回归模型。以下各节介绍了各种实验情况下的一些矩阵模型。</p>
<div id="sec6-1-1" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> 简单线性回归模型<a href="chap6.html#sec6-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>简单线性回归模型可以表示为 <span class="math inline">\(y_i=\beta_0+\beta_1x_i+\varepsilon_i,i=1,2,\ldots,n\)</span> 并且可以用矩阵形式表示为</p>
<p><span class="math display">\[\begin{bmatrix}y_1\\y_2\\\vdots\\y_n\end{bmatrix}=\begin{bmatrix}1&amp;x_1\\1&amp;x_2\\\vdots&amp;\vdots\\1&amp;x_n\end{bmatrix}\begin{bmatrix}{\beta}_0\\{\beta}_1\end{bmatrix}+\begin{bmatrix}{\varepsilon}_1\\{\varepsilon}_2\\\vdots\\{\varepsilon}_n\end{bmatrix}\]</span></p>
<p><span class="math inline">\(\boldsymbol X\)</span> 中的全 1 列对应于回归模型的截距 <span class="math inline">\(\boldsymbol \beta_0\)</span>，<span class="math inline">\(x_i\)</span> 列对应于回归模型的斜率。</p>
</div>
<div id="sec6-1-2" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> 单向处理结构模型<a href="chap6.html#sec6-1-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>为了在完全随机设计结构中表示具有 <span class="math inline">\(t\)</span> 个处理的单向处理结构的模型，其中第 <span class="math inline">\(i\)</span> 个处理有 <span class="math inline">\(n_i\)</span> 个观测结果，设自变量 <span class="math inline">\(x_{ij}\)</span> 定义为</p>
<p><span class="math display">\[x_{kij}=\begin{cases}0&amp;\text{ if the }ij\text{th observation is not from the }k\text{th treatment}\\1&amp;\text{ if the }ij\text{th observation is from the }k\text{th treatment}&amp;\end{cases}\]</span></p>
<p>其中 <span class="math inline">\(i=1,2,\cdots,t\)</span>，<span class="math inline">\(j=1,2,\cdots,n_i\)</span>. 变量 <span class="math inline">\(x_{kij}\)</span> 被称为<strong>指示变量</strong> (indicator variable)，因为当它的值为 1 时，它表明观测结果来自处理 k. 当它的值为 0 时，它表明观测结果不来自处理 k.</p>
<p><strong>均值模型</strong> (means model) 可表示为 <span class="math inline">\(y_{ij}={\mu}_1x_{1ij}+{\mu}_2x_{2ij}+\cdots+{\mu}_tx_{tij}+{\varepsilon}_{ij}\)</span>，其中 <span class="math inline">\(i=1,2,\cdots,t\)</span>，<span class="math inline">\(j=1,2,\cdots,n_i\)</span>. 或者以矩阵表示法</p>
<p><span class="math display">\[\begin{bmatrix}{y}_{11}\\{y}_{12}\\\vdots\\{y}_{1n_1}\\{y}_{22}\\\vdots\\{y}_{2{n}_2}\\\vdots\\{y}_{t1}\\\vdots\\{y}_{t{n}_t}\end{bmatrix}=\begin{bmatrix}1&amp;0&amp;\cdots&amp;0\\1&amp;0&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\vdots&amp;\vdots\\1&amp;0&amp;\cdots&amp;0\\0&amp;1&amp;\cdots&amp;0\\0&amp;1&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\vdots&amp;\vdots\\0&amp;1&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\vdots&amp;\vdots\\0&amp;0&amp;\cdots&amp;1\\\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\0&amp;0&amp;\cdots&amp;1\end{bmatrix}\begin{bmatrix}\mu_1\\\mu_2\\\vdots\\\mu_t\end{bmatrix}+\boldsymbol \varepsilon\]</span></p>
<p>均值模型通常表示为 <span class="math inline">\(y_{ij}=\mu_i+\varepsilon_{ij}\)</span>，其中 <span class="math inline">\(i=1,2,\cdots,t\)</span>，<span class="math inline">\(j=1,2,\cdots,n_i\)</span>.</p>
<p><strong>效应模型</strong> (effect model) 可表示为 <span class="math inline">\(y_{ij}=\mu+\tau_1x_{1ij}+\tau_2x_{2ij}+\cdots+\tau_tx_{tij}+\varepsilon_{ij}\)</span>，其中 <span class="math inline">\(i=1,2,\cdots,t\)</span>，<span class="math inline">\(j=1,2,\cdots,n_i\)</span>. 或者以矩阵表示法</p>
<p><span class="math display">\[\begin{bmatrix}{y}_{11}\\{y}_{12}\\\vdots\\{y}_{1{n}_1}\\{y}_{21}\\{y}_{22}\\\vdots\\{y}_{2{n}_2}\\\vdots\\{y}_{t1}\\\vdots\\{y}_{t{n}_t}\end{bmatrix}=\begin{bmatrix}1&amp;1&amp;0&amp;\cdots&amp;0\\1&amp;1&amp;0&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots\\1&amp;1&amp;0&amp;\cdots&amp;0\\1&amp;0&amp;1&amp;\cdots&amp;0\\1&amp;0&amp;1&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots\\1&amp;0&amp;1&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots\\1&amp;0&amp;0&amp;\cdots&amp;1\\\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\1&amp;0&amp;0&amp;\cdots&amp;1\end{bmatrix}\begin{bmatrix}\mu\\\tau_1\\\tau_2\\\vdots\\\tau_t\end{bmatrix}+\boldsymbol \varepsilon \]</span></p>
<p>效应模型通常表示为 <span class="math inline">\(y_{ij}=\mu+\tau_i+\varepsilon_{ij}\)</span>，其中 <span class="math inline">\(i=1,2,\cdots,t\)</span>，<span class="math inline">\(j=1,2,\cdots,n_i\)</span>.</p>
<p>均值模型和效应模型之间的区别在于，效应模型的设计矩阵包含模型截距 <span class="math inline">\(\mu\)</span> 的全 1 列，而均值模型不包含全 1 列。</p>
</div>
<div id="sec6-1-3" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> 双向处理结构模型<a href="chap6.html#sec6-1-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在完全随机设计结构中，对于具有 <span class="math inline">\(t\)</span> 行处理和 <span class="math inline">\(b\)</span> 列处理的双向处理结构，模型的一种形式为</p>
<p><span class="math display" id="eq:6-4">\[\begin{equation}
y_{ijk}=\mu_{ij}+\varepsilon_{ijk}\quad i=1,2,\ldots,t,j=1,2,\ldots,b,\mathrm{~and~}k=1,2,\ldots,n_{ij}
\tag{6.4}
\end{equation}\]</span></p>
<p>式子 <a href="chap6.html#eq:6-4">(6.4)</a> 中使用的模型称为均值模型，可以用矩阵形式表示为</p>
<p><span class="math display">\[\begin{bmatrix}y_{111}\\y_{112}\\\vdots\\y_{11n_1}\\y_{121}\\\vdots\\y_{12n_2}\\\vdots\\y_{1b1}\\\vdots\\y_{1bn_{1b}}
\\y_{211}\\\vdots\\y_{21n_{21}}\\\vdots\\y_{tb1}\\\vdots\\y_{tbn_{tb}}
\end{bmatrix}=\begin{bmatrix}
1&amp;0&amp;\cdots&amp;0&amp;0&amp;\cdots&amp;0\\
1&amp;0&amp;\cdots&amp;0&amp;0&amp;\cdots&amp;0\\
\vdots&amp;\vdots&amp;\cdots&amp;\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\
1&amp;0&amp;\cdots&amp;0&amp;0&amp;\cdots&amp;0\\
0&amp;1&amp;\cdots&amp;0&amp;0&amp;\cdots&amp;0\\
\vdots&amp;\vdots&amp;\cdots&amp;\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\
0&amp;1&amp;\cdots&amp;0&amp;0&amp;\cdots&amp;0\\
\vdots&amp;\vdots&amp;\cdots&amp;\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\
0&amp;0&amp;\cdots&amp;1&amp;0&amp;\cdots&amp;0\\
\vdots&amp;\vdots&amp;\cdots&amp;\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\
0&amp;0&amp;\cdots&amp;1&amp;0&amp;\cdots&amp;0\\
0&amp;0&amp;\cdots&amp;0&amp;1&amp;\cdots&amp;0\\
\vdots&amp;\vdots&amp;\cdots&amp;\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\
0&amp;0&amp;\cdots&amp;0&amp;1&amp;\cdots&amp;0\\
\vdots&amp;\vdots&amp;\cdots&amp;\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\
0&amp;0&amp;\cdots&amp;0&amp;0&amp;\cdots&amp;1\\
\vdots&amp;\vdots&amp;\cdots&amp;\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\
0&amp;0&amp;\cdots&amp;0&amp;0&amp;\cdots&amp;1\end{bmatrix}
\begin{bmatrix}\mu_{11}\\\mu_{12}\\\vdots\\\mu_{1b}\\\mu_{21}\\\vdots\\\mu_{tb}\end{bmatrix} +
\boldsymbol \varepsilon \]</span></p>
<p>双向效应模型可表示为</p>
<p><span class="math display" id="eq:6-5">\[\begin{equation}
y_{ijk}=\mu+\tau_i+\beta_j+\gamma_{ij}+\varepsilon_{ijk}\quad i=1,2,\ldots,t,j=1,2,\ldots,b,k=1,2,\ldots,n_{ij}
\tag{6.5}
\end{equation}\]</span></p>
<p>双向效应模型的矩阵形式为</p>
<p><span class="math display">\[
\begin{bmatrix}y_{111}\\y_{112}\\\vdots\\y_{11n_1}\\y_{121}\\\vdots\\y_{12n_2}\\\vdots\\y_{1b1}\\\vdots\\y_{1bn_{1b}}
\\y_{211}\\\vdots\\y_{21n_{21}}\\\vdots\\y_{tb1}\\\vdots\\y_{tbn_{tb}}
\end{bmatrix}=\begin{bmatrix}
1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \cdots &amp; \vdots &amp; \vdots &amp; \cdots &amp; \vdots \\
1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; 1 &amp; \cdots &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \cdots &amp; \vdots &amp; \vdots &amp; \cdots &amp; \vdots \\
0 &amp; 1 &amp; \cdots &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \cdots &amp; \vdots &amp; \vdots &amp; \cdots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \cdots &amp; \vdots &amp; \vdots &amp; \cdots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \cdots &amp; \vdots &amp; \vdots &amp; \cdots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \cdots &amp; \vdots &amp; \vdots &amp; \cdots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; \cdots &amp; 1 \\
\vdots &amp; \vdots &amp; \cdots &amp; \vdots &amp; \vdots &amp; \cdots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; \cdots &amp; 1 \\
\end{bmatrix}  \begin{bmatrix}\mu_{11}\\\mu_{12}\\\vdots\\\mu_{1b}\\\mu_{21}\\\vdots\\\mu_{tb}\end{bmatrix}+
\boldsymbol \varepsilon
\]</span></p>
<p>本书强调与实验设计情境相对应的模型，而不是纯粹的回归情境。接下来的两个例子将展示如何从数据结构构建这样的模型。</p>
</div>
<div id="sec6-1-4" class="section level3 hasAnchor" number="6.1.4">
<h3><span class="header-section-number">6.1.4</span> 示例 6.1：双向处理结构的均值模型<a href="chap6.html#sec6-1-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>表 <a href="chap6.html#tab:table6-1">6.1</a> 中的信息代表了一个完全随机设计结构中的双向处理结构的数据，其中有三行处理和三列处理，每个单元格有一个或两个观测值。表 <a href="chap6.html#tab:table6-1">6.1</a> 中数据的均值模型的矩阵形式为：</p>
<p><span class="math display">\[\begin{bmatrix}3\\6\\9\\10\\2\\5\\3\\8\\4\\2\\6\end{bmatrix}=\begin{bmatrix}
1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\
1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\
0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\
0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\
0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0\\
0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0\\
0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0\\
0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0\\
0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0\\
0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0\\
0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1\end{bmatrix}\begin{bmatrix}\mu_{11}\\\mu_{12}\\\mu_{13}\\\mu_{21}\\\mu_{22}\\\mu_{23}\\\mu_{31}\\\mu_{32}\\\mu_{33}\end{bmatrix}+\boldsymbol \varepsilon\]</span></p>
<p>表 <a href="chap6.html#tab:table6-1">6.1</a> 中数据的效应模型的矩阵形式为</p>
<p><span class="math display">\[
\begin{bmatrix}3\\6\\9\\10\\2\\5\\3\\8\\4\\2\\6\end{bmatrix}=\begin{bmatrix}
1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
\mu_1 \\
\tau_1 \\
\tau_2 \\
\tau_3 \\
\beta_1 \\
\beta_2 \\
\beta_3 \\
\gamma_{11} \\
\gamma_{12} \\
\gamma_{13} \\
\gamma_{21} \\
\gamma_{22} \\
\gamma_{23} \\
\gamma_{31} \\
\gamma_{32} \\
\gamma_{33}
\end{bmatrix}
+\boldsymbol \varepsilon
\]</span></p>
<p>或</p>
<p><span class="math display">\[\boldsymbol y=\boldsymbol j\boldsymbol\mu+\boldsymbol X_1\boldsymbol \tau+\boldsymbol X_2\boldsymbol\beta+\boldsymbol X_3\boldsymbol \gamma+\boldsymbol\varepsilon \]</span></p>
<p>其中，<span class="math inline">\(\boldsymbol j\)</span> 是与上述设计矩阵的第一列对应的 11×1 向量，<span class="math inline">\(\boldsymbol X_1\)</span> 是与第 2-4 列对应的 11×3 矩阵，<span class="math inline">\(\boldsymbol X_2\)</span> 是与第 5-7 列对应的 11×3 矩阵，<span class="math inline">\(\boldsymbol X_3\)</span> 是与以上设计矩阵的最后九列对应的 11×9 矩阵。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table6-1">表 6.1: </span>CRD 结构中双向处理结构的数据
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%206.1.png">
</td>
</tr>
</tbody>
</table>
<p>其他处理和设计结构的设计矩阵也是以类似的方式构建的。幸运的是，大多数用于拟合非均衡数据结构的软件都会使用上述类型的表示形式，并在模型中指定分类效应 (categorical effects) 时自动生成设计矩阵的必要列。</p>
</div>
</div>
<div id="sec6-2" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> 最小二乘估计<a href="chap6.html#sec6-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>一旦模型以矩阵形式指定，分析的下一步是获得参数向量 <span class="math inline">\(\boldsymbol \beta\)</span> 的<strong>最小二乘估计</strong> (least squares estimator)。最小二乘法可用于估计模型的参数。要使用此方法，假设模型可以表示为</p>
<p><span class="math display" id="eq:6-6">\[\begin{equation}
y_i=f(x_i;\boldsymbol{\beta})+\varepsilon_i\quad\mathrm{~for~}i=1,2,\ldots,n
\tag{6.6}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(y_i=f(x_i;\boldsymbol{\beta})\)</span> 是由 <span class="math inline">\(x_i\)</span> 表示的设计变量向量的函数，且依赖于参数向量 <span class="math inline">\(\boldsymbol \beta\)</span>. <span class="math inline">\(\boldsymbol \beta\)</span> 的最小二乘估计通常用 <span class="math inline">\(\hat {\boldsymbol \beta}\)</span> 表示，它能最小化平方和</p>
<p><span class="math display" id="eq:6-7">\[\begin{equation}
SS(\boldsymbol{\beta})=\sum_{i=1}^n[y_i-f(x_i;\boldsymbol{\beta})]^2
\tag{6.7}
\end{equation}\]</span></p>
<p>如果除了假设模型的形式为 <a href="chap6.html#eq:6-6">(6.6)</a> 之外，还额外假设 <span class="math inline">\(\varepsilon_i \sim i.i.d\,N(0,\sigma^2),i＝1,2,\cdots,n\)</span>，则 <span class="math inline">\(\boldsymbol \beta\)</span> 的最小二乘估计也是<strong>最大似然估计</strong> (maximum likelihood estimator).</p>
<p>例如，完全随机设计中单向处理结构的均值模型的模型函数为</p>
<p><span class="math display">\[f(x_{ij};\boldsymbol{\beta})=\mu_i,\quad i=1,2,\ldots,t;\quad j=1,2,\ldots,n_i\]</span></p>
<p><span class="math inline">\(\mu_i\)</span> 的最小二乘估计记作 <span class="math inline">\(\hat \mu_1,\cdots,\hat \mu_t\)</span>，它们是这样的值，即能够最小化</p>
<p><span class="math display">\[\begin{aligned}SS({\mu})=\sum_{i=1}^t\sum_{j=1}^{n_j}(y_{ij}-\mu_i)^2\end{aligned}\]</span></p>
<p>完全随机设计中双向处理结构的均值模型的模型函数为</p>
<p><span class="math display">\[f(x_{ijk};\boldsymbol{\beta})=\mu_{ij}\quad i=1,2,\ldots,t;j=1,2,\ldots,b;k=1,2,\ldots,n_{ij}\]</span></p>
<p><span class="math inline">\(\mu_{ij}\)</span> 的最小二乘估计记作 <span class="math inline">\(\hat \mu_{11},\cdots,\hat \mu_{tb}\)</span>，它们是这样的值，即能够最小化</p>
<p><span class="math display">\[\begin{aligned}SS({\mu})=\sum_{i=1}^{t}\sum_{j=1}^{b}\sum_{k=1}^{n_{ij}}(y_{ijk}-\mu_{ij})^2\end{aligned}\]</span></p>
<p>完全随机设计中双向处理结构的效应模型的模型函数为</p>
<p><span class="math display">\[f(x_{ijk};\boldsymbol{\beta})=\mu+\tau_i+{\beta}_j+\gamma_{ij},\quad i=1,2,\ldots,t;j=1,2,\ldots,b;k=1,2,\ldots,n_{ij}\]</span></p>
<p><span class="math inline">\(\mu,\tau_i,\beta_j,\gamma_{ij}\)</span> 的最小二乘估计是通过最小化下式来获得的</p>
<p><span class="math display">\[SS(\mu,\tau_i,\beta_j,\gamma_{ij})=\sum_{i=1}^t\sum_{j=1}^b\sum_{k=1}^{n_{ij}}(y_{ijk}-\mu-\tau_i-\beta_j-\gamma_{ij})^2\]</span></p>
<p>通常，模型可以写成矩阵形式，如式 <a href="chap6.html#eq:6-1">(6.1)</a> 中的矩阵形式，并且 <span class="math inline">\(\boldsymbol \beta\)</span> 的最小二乘估计是这样的 <span class="math inline">\(\hat {\boldsymbol \beta}\)</span> ，即能最小化平方和</p>
<p><span class="math display" id="eq:6-8">\[\begin{equation}
SS(\boldsymbol\beta)=(\boldsymbol y-\boldsymbol X \boldsymbol\beta)^{\prime}(\boldsymbol y-\boldsymbol X \boldsymbol\beta)
\tag{6.8}
\end{equation}\]</span></p>
<div id="sec6-2-1" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> 最小二乘方程组<a href="chap6.html#sec6-2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>矩阵表示和计算可用于确定能使残差平方和最小化的 <span class="math inline">\(\boldsymbol\beta\)</span> 值。当进行最小化时，会得到一组 <span class="math inline">\(\hat {\boldsymbol \beta}\)</span> 必须满足的方程，这些方程被称为模型的<strong>最小二乘方程组</strong> (least squares
equations) 或<strong>正规方程组</strong> (normal equations). 对于模型 <a href="chap6.html#eq:6-1">(6.1)</a>，正规方程组由下式给出：</p>
<p><span class="math display" id="eq:6-9">\[\begin{equation}
\boldsymbol X^{\prime} \boldsymbol X\hat{\boldsymbol{\beta}}=\boldsymbol X^{\prime}\boldsymbol{y}
\tag{6.9}
\end{equation}\]</span></p>
<p>任何满足正规方程组的向量 <span class="math inline">\(\hat {\boldsymbol \beta}\)</span> 都是 <span class="math inline">\(\boldsymbol\beta\)</span> 的最小二乘估计。对于一些模型，最小二乘估计不必是唯一的。为了帮助读者更加熟悉正规方程组，下面提供了第 <a href="chap6.html#sec6-1">6.1</a> 节中讨论的模型的正规方程组。</p>
<p>单向均值模型的正规方程组为</p>
<p><span class="math display">\[\begin{bmatrix}n_1&amp;0&amp;\cdots&amp;0\\0&amp;n_2&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\0&amp;0&amp;\cdots&amp;n_t\end{bmatrix}\begin{bmatrix}\hat{\mu}_1\\\hat{\mu}_2\\\vdots\\\hat{\mu}_t\end{bmatrix}=\begin{bmatrix}y_{1\cdot}\\y_{2\cdot}\\\vdots\\y_{t\cdot}\end{bmatrix}\mathrm{~where~}y_{i\cdot}=\sum_{i=1}^{n_i}y_{ij}\]</span></p>
<p>单向效应模型的正规方程组为</p>
<p><span class="math display">\[\begin{bmatrix}n_{\cdot}&amp;n_1&amp;n_2&amp;\cdots&amp;n_t\\n_1&amp;n_1&amp;0&amp;\cdots&amp;0\\n_2&amp;0&amp;n_2&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\n_t&amp;0&amp;0&amp;\cdots&amp;n_t\end{bmatrix}\begin{bmatrix}\hat{\mu}\\\hat{\tau}_1\\\hat \tau_2\\\vdots\\\hat{\tau}_t\end{bmatrix}=\begin{bmatrix}y_{\cdot\cdot}\\y_{1\cdot}\\y_{2\cdot}\\\vdots\\y_{t\cdot}\end{bmatrix}\quad\mathrm{where~}y_{\cdot\cdot}=\sum_{i=1}^t\sum_{j=1}^{n_i}y_{ij}\quad\mathrm{and}\quad n_{\cdot}=\sum_{i=1}^tn_t\]</span></p>
<p>使用表 <a href="chap6.html#tab:table6-1">6.1</a> 中数据的双向均值模型的正规方程组为</p>
<p><span class="math display">\[\begin{bmatrix}2&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0\\0&amp;0&amp;0&amp;0&amp;2&amp;0&amp;0&amp;0&amp;0\\0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0\\0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0\\0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0\\0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1\end{bmatrix}\begin{bmatrix}\hat{\mu}_{11}\\\hat{\mu}_{12}\\\hat{\mu}_{13}\\\hat{\mu}_{21}\\\hat{\mu}_{22}\\\hat{\mu}_{23}\\\hat{\mu}_{31}\\\hat{\mu}_{32}\\\hat{\mu}_{33}\end{bmatrix}=\begin{bmatrix}y_{11\cdot}\\y_{12\cdot}\\y_{13\cdot}\\y_{21\cdot}\\y_{22\cdot}\\y_{23\cdot}\\y_{31\cdot}\\y_{32\cdot}\\y_{33\cdot}\end{bmatrix}\]</span></p>
<p>其中</p>
<p><span class="math display">\[y_{ij\cdot}=\sum_{k=1}^{n_{ij}}y_{ijk}\]</span></p>
<p>与表 <a href="chap6.html#tab:table6-1">6.1</a> 中的数据相对应的双向效应模型的正规方程组为</p>
<p>$$$$</p>
<p><span class="math display">\[\begin{bmatrix}
11&amp;4&amp;4&amp;3&amp;4&amp;4&amp;3&amp;2&amp;1&amp;1&amp;1&amp;2&amp;1&amp;1&amp;1&amp;1\\
4&amp;4&amp;0&amp;0&amp;2&amp;1&amp;1&amp;2&amp;1&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\
4&amp;0&amp;4&amp;0&amp;1&amp;2&amp;1&amp;0&amp;0&amp;0&amp;1&amp;2&amp;1&amp;0&amp;0&amp;0\\
3&amp;0&amp;0&amp;3&amp;1&amp;1&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;1&amp;1\\
4&amp;2&amp;1&amp;1&amp;4&amp;0&amp;0&amp;2&amp;0&amp;0&amp;1&amp;0&amp;0&amp;1&amp;0&amp;0\\
4&amp;1&amp;2&amp;1&amp;0&amp;4&amp;0&amp;0&amp;1&amp;0&amp;0&amp;2&amp;0&amp;0&amp;1&amp;0\\
3&amp;1&amp;1&amp;1&amp;0&amp;0&amp;3&amp;0&amp;0&amp;1&amp;0&amp;0&amp;1&amp;0&amp;0&amp;1\\
2&amp;2&amp;0&amp;0&amp;2&amp;0&amp;0&amp;2&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\
1&amp;1&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\
1&amp;1&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\
1&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0\\
2&amp;0&amp;2&amp;0&amp;0&amp;2&amp;0&amp;0&amp;0&amp;0&amp;0&amp;2&amp;0&amp;0&amp;0&amp;0\\
1&amp;0&amp;1&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0\\
1&amp;0&amp;0&amp;1&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0\\
1&amp;0&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1&amp;0\\
1&amp;0&amp;0&amp;1&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;1\end{bmatrix}
\begin{bmatrix}\hat\mu\\\hat\tau_{1}\\\hat{\tau}_2\\\hat\tau_{3}\\\hat\beta_{1}\\\hat\beta_{2}\\\hat\beta_{3}\\\hat\gamma_{11}\\\hat\gamma_{12}\\\hat\gamma_{13}\\\hat\gamma_{21}\\\hat\gamma_{22}\\\hat\gamma_{23}\\\hat\gamma_{31}\\\hat\gamma_{32}\\\hat\gamma_{33}\end{bmatrix}=\begin{bmatrix}y_{\cdot\cdot\cdot}\\y_{1\cdot\cdot}\\y_{2\cdot\cdot}\\y_{3\cdot\cdot}\\y_{\cdot1\cdot}\\y_{\cdot2\cdot}\\y_{\cdot3\cdot}\\y_{11\cdot}\\y_{12\cdot}\\y_{13\cdot}\\y_{21\cdot}\\y_{22\cdot}\\y_{23\cdot}\\y_{31\cdot}\\y_{32\cdot}\\y_{33\cdot}\end{bmatrix}\]</span></p>
<p>其中</p>
<p><span class="math display">\[y_{\cdot\cdot\cdot}=\sum_{i=1}^t\sum_{j=1}^b\sum_{k=1}^{n_{ij}}y_{ijk},\quad y_{i\cdot\cdot}=\sum_{j=1}^b\sum_{k=1}^{n_{ij}}y_{ijk},\quad y_{\cdot j\cdot}=\sum_{i=1}^t\sum_{k=1}^{n_{ij}}y_{ijk},\quad\mathrm{and}\quad y_{ij\cdot}=\sum_{k=1}^{n_{ij}}y_{ijk}\]</span></p>
<p>当 <span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 满秩时 (Graybill, 1976)，即 <span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 是非奇异的，则 <span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 的逆存在，并且 <span class="math inline">\({\boldsymbol \beta}\)</span> 的最小二乘估计（方程 <a href="chap6.html#eq:6-9">(6.9)</a> 中 <span class="math inline">\(\hat {\boldsymbol \beta}\)</span> 的解）为</p>
<p><span class="math display" id="eq:6-10">\[\begin{equation}
\hat {\boldsymbol \beta}=(\boldsymbol X^\prime \boldsymbol X)^{-1}\boldsymbol{X^{\prime}y}
\tag{6.10}
\end{equation}\]</span></p>
<p>当 <span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 是满秩时，最小二乘估计是唯一的。计算 <span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 的逆通常不是一项容易的任务。计算软件开发的最重要方面之一是，现在统计学家可以求超大型矩阵的逆，这在计算机出现之前是不可能的。然而，当 <span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 中存在某些模式时，可以利用这些模式更容易地求逆。对于单向均值模型和双向均值模型的正规方程组，<span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 是对角矩阵（所有对角元非零，非对角元为零），并且 <span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 的逆是通过简单地将每个对角元替换为其倒数来获得的。因此，单向均值模型的 <span class="math inline">\(\mu_i\)</span> 的最小二乘估计为</p>
<p><span class="math display">\[\begin{bmatrix}\hat{{\mu}}_1\\\hat{{\mu}}_2\\\vdots\\\hat{{\mu}}_t\end{bmatrix}=\begin{bmatrix}\frac1{n_1}&amp;0&amp;\cdots&amp;0\\0&amp;\frac1{n_2}&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\0&amp;0&amp;\cdots&amp;\frac1{n_t}\end{bmatrix}\begin{bmatrix}y_{1\cdot}\\y_{2\cdot}\\\vdots\\y_{t\cdot}\end{bmatrix}\]</span></p>
<p>或等价地</p>
<p><span class="math display">\[\hat{\mu}_i=\frac{y_{i\cdot}}{n_i}=\bar{y}_{i\cdot}\quad i=1,2,\ldots,t\]</span></p>
<p>类似地，双向均值模型 <span class="math inline">\(\mu_{ij}\)</span> 的最小二乘估计为</p>
<p><span class="math display">\[\hat{\mu}_{ij}=\frac{y_{ij\cdot}}{n_{ij}}=\bar{y}_{ij\cdot}\quad i=1,2,\ldots,t,\quad j=1,2,\ldots,b\]</span></p>
<p>与均值模型的正规方程组不同，效应模型的 <span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 是奇异的，并且 <span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 的逆不存在。在这种情况下，正规方程组有许多解（实际上是无穷多个最小二乘解）。效应模型被称为<strong>过度指定</strong> (overspecified models) 或<strong>奇异模型</strong> (sigular models)，因为与从收集的数据中可以唯一估计的参数相比，这些模型具有更多的参数。通常使用过度指定的模型，并且有几种方法可以求解其相应的正规方程组。以下讨论涉及完全随机设计结构中的双向处理结构，但类似的技术也可用于其他因素效应模型。</p>
<p>理论上，广义逆可用于求解关于 <span class="math inline">\({\boldsymbol \beta}\)</span> 的正规方程组 (Graybill, 1976)，但求解过度指定模型的正规方程组的常用方法是对模型中的参数进行限制（这实际上产生了 g-inverse 解）。对模型参数施加限制可以通过多种方式实现，这里考虑其中两种方式。</p>
</div>
<div id="sec6-2-2" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> 零和限制<a href="chap6.html#sec6-2-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>一种常见的技术是要求某些参数的和等于零。这种方法自方差分析之初就被用来求解正规方程组。对于使用表 <a href="chap6.html#tab:table6-1">6.1</a> 中数据的双向效应模型，<strong>零和限制</strong> (Sum-to-Zero Restrictions) 为：</p>
<p><span class="math display">\[\begin{aligned}
&amp;\begin{aligned}\sum_{i=1}^3\tau_i=0,\sum_{j=1}^3\beta_j=0,\sum_{i=1}^3\gamma_{i1}=0,\sum_{i=1}^3\gamma_{i2}=0,\sum_{i=1}^3\gamma_{i3}=0\end{aligned} \\
&amp;\sum_{j=1}^3\gamma_{1j}=0,\sum_{j=1}^3\gamma_{2j}=0,\,\text{and }\sum_{j=1}^3\gamma_{3j}=0
\end{aligned}\]</span></p>
<p>接下来，通过在考虑限制的情况下根据其他参数求解一些参数，然后将表达式替换回模型，将这些限制合并到模型中。例如，可以替换的参数有</p>
<p><span class="math display">\[\begin{aligned}\tau_3&amp;=-\tau_1-\tau_2,\quad\beta_3=-\beta_1-\beta_2,\quad\gamma_{13}=-\gamma_{11}-\gamma_{12}\\\gamma_{23}&amp;=-\gamma_{21}-\gamma_{22},\quad\gamma_{31}=-\gamma_{11}-\gamma_{21},\quad\gamma_{32}=-\gamma_{12}-\gamma_{22}\\\gamma_{33}&amp;=-\gamma_{13}-\gamma_{23}=-\gamma_{31}-\gamma_{32}=\gamma_{11}+\gamma_{12}+\gamma_{21}+\gamma_{22}\end{aligned}\]</span></p>
<p>因此，替换模型中的 <span class="math inline">\(\tau_3,~\beta_3,~\gamma_{13},~\gamma_{23},~\gamma_{33},~\gamma_{31}\)</span> 和 <span class="math inline">\(\gamma_{32}\)</span>，以获得重新参数化的模型</p>
<p><span class="math display">\[
\begin{bmatrix}y_{111}\\y_{112}\\y_{121}\\y_{131}\\y_{211}\\y_{221}\\y_{222}\\y_{231}\\y_{311}\\y_{321}\\y_{331}\end{bmatrix}=
\begin{bmatrix}1&amp;1&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0&amp;0\\1&amp;1&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0&amp;0\\1&amp;1&amp;0&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0\\1&amp;1&amp;0&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0\\1&amp;1&amp;0&amp;-1&amp;-1&amp;-1&amp;-1&amp;0&amp;0\\1&amp;0&amp;1&amp;1&amp;0&amp;0&amp;0&amp;1&amp;0\\1&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0&amp;0&amp;1\\1&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0&amp;0&amp;1\\1&amp;0&amp;1&amp;-1&amp;-1&amp;0&amp;0&amp;-1&amp;-1\\1&amp;-1&amp;-1&amp;0&amp;0&amp;-1&amp;0&amp;-1&amp;0\\1&amp;-1&amp;-1&amp;0&amp;1&amp;0&amp;-1&amp;0&amp;-1\\1&amp;-1&amp;-1&amp;-1&amp;-1&amp;1&amp;1&amp;1&amp;1\end{bmatrix}\begin{bmatrix}\mu^*\\\tau_1^*\\\tau_2^*\\\beta_1^*\\\beta_2^*\\\gamma_{11}^*\\\gamma_{12}^*\\\gamma_{21}^*\\\gamma_{22}^*\end{bmatrix}+\boldsymbol{\varepsilon}
\]</span></p>
<p>其表示为</p>
<p><span class="math display">\[\begin{aligned}\boldsymbol{y}=\boldsymbol{X}^*\boldsymbol{\beta}^*+\boldsymbol{\varepsilon}\end{aligned}\]</span></p>
<p>表 <a href="chap6.html#tab:table6-1">6.1</a> 中数据对应的零和限制正态方程的解为 <span class="math inline">\(\hat{\boldsymbol{\beta^*}}=(\boldsymbol X^{*\prime} \boldsymbol X^*)^{-1}\boldsymbol X^{*\prime}\boldsymbol{y}\)</span>. 可得到</p>
<p><span class="math display">\[\begin{aligned}
\hat{\boldsymbol \beta}^{*\prime}&amp;=[\hat{\mu}^*,\hat{\tau}_1^*,\hat{\tau}_2^*,\hat{\beta}_1^*,\hat{\beta}_2^*,\hat{\gamma}_{11}^*,\hat{\gamma}_{12}^*,\hat{\gamma}_{21}^*,\hat{\gamma}_{22}^*] \\
&amp;=[5.500,2.333,-0.833,-2.000,-0.5000,-1.333,1.667,-0.667,-0.167]
\end{aligned}\]</span></p>
<p><span class="math inline">\(\boldsymbol \beta\)</span> 剩余元素的估计从如下限制中获得：</p>
<p><span class="math display">\[\begin{aligned}
\hat{{\tau}}_3^*&amp;=-\hat{{\tau}}_1^*-\hat{{\tau}}_2^*=-1.500,\quad\hat{{\beta}}_3^*=-\hat{{\beta}}_1^*-\hat{{\beta}}_2^*=2.500 \\
\hat{\gamma}_{13}^*&amp;=-\hat{\gamma}_{11}^*-\hat{\gamma}_{12}^*=-0.333,\quad\hat{\gamma}_{23}^*=-\hat{\gamma}_{21}^*-\hat{\gamma}_{22}^*=0.833 \\
\hat{\gamma}_{31}^*&amp;=-\hat{\gamma}_{11}^*-\hat{\gamma}_{21}^*=2.000,\quad\hat{\gamma}_{32}^*=-\hat{\gamma}_{12}^*-\hat{\gamma}_{22}^*=-1.500 \\
\hat{\gamma}_{33}^*&amp;=\hat{\gamma}_{11}^*+\hat{\gamma}_{12}^*+\hat{\gamma}_{21}^*+\hat{\gamma}_{22}^*=-0.500
\end{aligned}\]</span></p>
<p>关于均值模型参数 <span class="math inline">\(\mu_{ij}\)</span>，参数 <span class="math inline">\(\mu^*,t_i^*,\beta_{j}^*,\gamma^*_{ij}\)</span> 可以通过如下定义以满足零和限制</p>
<p><span class="math display">\[\mu^*=\bar{\mu}_{\cdot\cdot},\quad\tau_i^*=\bar{\mu}_{i\cdot}-\bar{\mu}_{\cdot\cdot\cdot},\quad\beta_j^*=\bar{\mu}_{\cdot j}-\bar{\mu}_{\cdot\cdot\cdot},\quad\mathrm{and}\quad\gamma_{ij}^*=\mu_{ij}-\bar{\mu}_{i\cdot}-\bar{\mu}_{\cdot j}+\bar{\mu}_{\cdot\cdot}\]</span></p>
</div>
<div id="sec6-2-3" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> 置零限制<a href="chap6.html#sec6-2-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>另一种常用于求解双向效应模型正规方程组的重新参数化技术为，将每组中的最后一个参数<strong>设置为零</strong> (Set-to-Zero)（选择最后一个参数是为了方便；也可以选择第一个、第二个或任何其他参数）。对于表 <a href="chap6.html#tab:table6-1">6.1</a> 中数据的双向效应模型，限制为</p>
<p><span class="math display">\[\tau_3=0,\beta_3=0,\gamma_{13}=0,\gamma_{23}=0,\gamma_{33}=0,\gamma_{31}=0,\mathrm{~and~}\gamma_{23}=0\]</span></p>
<p>通过将上述限制条件纳入双向效应模型，得到重新参数化后的模型为</p>
<p><span class="math display">\[\begin{bmatrix}y_{111}\\y_{112}\\y_{121}\\y_{131}\\y_{211}\\y_{221}\\y_{222}\\y_{231}\\y_{311}\\y_{321}\\y_{331}\end{bmatrix}=\begin{bmatrix}1&amp;1&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0&amp;0\\1&amp;1&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0&amp;0\\1&amp;1&amp;0&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0\\1&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\1&amp;0&amp;1&amp;1&amp;0&amp;0&amp;0&amp;1&amp;0\\1&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0&amp;0&amp;1\\1&amp;0&amp;1&amp;0&amp;1&amp;0&amp;0&amp;0&amp;1\\1&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\\1&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0&amp;0\\1&amp;0&amp;0&amp;0&amp;1&amp;0&amp;0&amp;0&amp;0\\1&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0&amp;0\end{bmatrix}\begin{bmatrix}\mu^+\\\tau_1^+\\\tau_2^+\\\beta_1^+\\\beta_2^+\\\gamma_{11}^+\\\gamma_{12}^+\\\gamma_{21}^+\\\gamma_{22}^+\end{bmatrix}+\boldsymbol\varepsilon  \]</span></p>
<p>可以表示为 <span class="math inline">\(\boldsymbol{y}=\boldsymbol{X}^+\boldsymbol{\beta}^++\boldsymbol{\varepsilon}\)</span>。矩阵 <span class="math inline">\(\boldsymbol{X}^+\)</span> 是通过从双向效应模型完整设计矩阵 <span class="math inline">\(\boldsymbol X\)</span> 中删除与 <span class="math inline">\(\tau_3,\beta_3,\gamma_{31},\gamma_{32},\gamma_{33},\gamma_{13},\gamma_{23}\)</span> 对应的列而获得的。关于重新参数化模型设计矩阵的求解过程，置零限制比零和限制简单得多。置零限制对应的正规方程组的解为</p>
<p><span class="math display">\[\hat{\boldsymbol{\beta}}^+=(\boldsymbol X^{+\prime}\boldsymbol X^{+})^{-1}\boldsymbol X^{+\prime}\boldsymbol y\]</span></p>
<p>可以得到</p>
<p><span class="math display">\[\begin{aligned}
\hat{\boldsymbol{\beta}}^{+\prime}&amp; =[\hat{{\mu}}^+,\hat{{\tau}}_1^+,\hat{{\tau}}_2^+,\hat{{\beta}}_1^+,\hat{{\beta}}_2^+,\hat{{\gamma}}_{11}^+,\hat{{\gamma}}_{12}^+,\hat{{\gamma}}_{21}^+,\hat{{\gamma}}_{22}^+]  \\
&amp;=[6.0,4.0,2.0,-2.0,-4.0,-3.5,3.0,-4.0,0.0]
\end{aligned}\]</span></p>
<p>其余参数的估计是零，因为它们是由置零限制指定的，即，</p>
<p><span class="math display">\[\hat{\tau}_3^+=\hat{\beta}_3^+=\hat{\gamma}_{31}^+=\hat{\gamma}_{32}^+=\hat{\gamma}_{33}^+=\hat{\gamma}_{13}^+=\hat{\gamma}_{23}^+=0\]</span></p>
<p>为了将参数置零限制条件与均值模型参数 <span class="math inline">\(\mu_{ij}\)</span> 关联起来，定义 <span class="math inline">\(\mu^+,t_i^+,\beta_j^+,\gamma_{ij}^+\)</span></p>
<p><span class="math display">\[\begin{aligned}\mu^+=\mu_{tb},&amp;\,\,\tau_i^+=\mu_{ib}-\mu_{tb},\,\,\beta_j^+=\mu_{tj}-\mu_{tb}\,\mathrm{~and~}\,\gamma_{ij}^+=\mu_{ij}-\mu_{tj}-\mu_{ib}+\mu_{tb}\end{aligned}\]</span></p>
<p>当 <span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 的不满秩时（即 <span class="math inline">\(\boldsymbol X^\prime \boldsymbol X\)</span> 是奇异的），正规方程组有多个可能的解。这是因为模型参数过多，即模型中的参数（在双向效应模型的情况下为 16 个）比可用数据（有 9 个数据单元，因此最多可以估计 9 个参数）能够唯一确定的参数要多。可以唯一估计的参数数量可被称为<strong>基本</strong> (essential) 参数数量。为了应对过度参数化模型以及非唯一的最小二乘解，必须考虑可估性的概念，这是 <a href="chap6.html#sec6-3">6.3</a> 节的主题。下一个例子将给出单向处理结构效应模型的两种可能的解。</p>
</div>
<div id="sec6-2-4" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> 示例 6.2：单向处理结构<a href="chap6.html#sec6-2-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table6-2">表 6.2: </span>第 <a href="chap6.html#sec6-2-4">6.2.4</a> 节中均值和效应模型的单向处理结构数据
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%206.2.png">
</td>
</tr>
</tbody>
</table>
<p>这是一个单向处理结构的示例，在完全随机设计结构中具有四种处理。数据如表 <a href="chap6.html#tab:table6-2">6.2</a> 所示。 <span class="math inline">\(\boldsymbol X^*\)</span> 矩阵是通过使用零和限制重新参数化模型来构造的；即，假设 <span class="math inline">\(\tau_1^*+\tau_2^*+\tau_3^*+\tau_4^*=0\)</span>.</p>
<p>由此产生的设计矩阵为</p>
<p><span class="math display">\[\boldsymbol X^*=\begin{bmatrix}
1 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 0 &amp; 1 \\
1 &amp; 0 &amp; 0 &amp; 1 \\
1 &amp; 0 &amp; 0 &amp; 1 \\
1 &amp; 0 &amp; 0 &amp; 1 \\
1 &amp; 0 &amp; 0 &amp; 1 \\
1 &amp; 0 &amp; 0 &amp; 1 \\
1 &amp; -1 &amp; -1 &amp; -1 \\
1 &amp; -1 &amp; -1 &amp; -1 \\
1 &amp; -1 &amp; -1 &amp; -1 \\
1 &amp; -1 &amp; -1 &amp; -1 \\
1 &amp; -1 &amp; -1 &amp; -1 \\
1 &amp; -1 &amp; -1 &amp; -1 \\
1 &amp; -1 &amp; -1 &amp; -1 \\
1 &amp; -1 &amp; -1 &amp; -1 \\
\end{bmatrix}\]</span></p>
<p>零和限制模型的正规方程组为</p>
<p><span class="math display">\[\begin{bmatrix}26&amp;-1&amp;-3&amp;-2\\-1&amp;15&amp;8&amp;8\\-3&amp;8&amp;13&amp;8\\-2&amp;8&amp;8&amp;14\end{bmatrix}\begin{bmatrix}\hat{\mu}^*\\\hat{\tau}_1^*\\\hat{\tau}_2^*\\\hat{\tau}_3^*\end{bmatrix}=\begin{bmatrix}55.1\\-0.9\\-2.5\\-5.9\end{bmatrix}\]</span></p>
<p>零和限制模型的正规方程组相应最小二乘解为</p>
<p><span class="math display">\[\hat{\boldsymbol{\beta}}^*=\begin{bmatrix}\hat{{\mu}}^*\\\hat{{\tau}}_1^*\\\hat{{\tau}}_2^*\\\hat{{\tau}}_3^*\end{bmatrix}=\begin{bmatrix}2.1510\\0.0204\\0.5690\\-0.4510\end{bmatrix}\]</span></p>
<p>以及 <span class="math inline">\(\hat{\tau}_4^*=-\hat{\tau}_1^*-\hat{\tau}_2^*-\hat{\tau}_3^*=-0.1384\)</span>. 就均值模型参数而言，零和限制参数可表示为</p>
<p><span class="math display">\[\mu^*=\bar{\mu}_{\cdot},\quad\tau_1^*=\mu_1-\bar{\mu}_{\cdot},\quad\tau_2^*=\mu_2-\bar{\mu}_{\cdot},\quad\tau_3^*=\mu_3-\bar{\mu}_{\cdot},\quad\tau_4^*=\mu_4-\bar{\mu}_{\cdot}\]</span></p>
<p>具有 <span class="math inline">\(\tau_ 4 ^+ = 0\)</span> 的置零限制设计矩阵 <span class="math inline">\(\boldsymbol X^+\)</span> 是通过在 <span class="math inline">\(\boldsymbol X^*\)</span> 中用“0”替换“-1”来构建的。置零限制模型的正规方程组为</p>
<p><span class="math display">\[\begin{bmatrix}26&amp;7&amp;5&amp;6\\7&amp;7&amp;0&amp;0\\5&amp;0&amp;5&amp;0\\6&amp;0&amp;0&amp;6\end{bmatrix}\begin{bmatrix}\hat{{\mu}}^+\\\hat{{\tau}}_1^+\\\hat{{\tau}}_2^+\\\hat{{\tau}}_3^+\end{bmatrix}=\begin{bmatrix}55.1\\15.2\\13.6\\10.2\end{bmatrix}\]</span></p>
<p>置零限制模型的最小二乘解为</p>
<p><span class="math display">\[\boldsymbol{\hat{\beta}}^+=\begin{bmatrix}{\hat{\mu}}^+\\{\hat{\tau}}_1^+\\{\hat{\tau}}_2^+\\{\hat{\tau}}_3^+\end{bmatrix}=\begin{bmatrix}2.0125\\0.1589\\0.7075\\-0.3125\end{bmatrix}\]</span></p>
<p>且 <span class="math inline">\(\tau_ 4 ^+ = 0\)</span>. 就均值模型参数而言，置零限制参数可表示为</p>
<p><span class="math display">\[\mu^+=\mu_4,\quad\tau_1^+=\mu_1-\mu_4,\quad\tau_2^+=\mu_2-\mu_4,\quad\tau_3^+=\mu_3-\mu_4,\quad\tau_4^+=\mu_4-\mu_4=0\]</span></p>
<p>需要估计的最后一个参数是总体方差 <span class="math inline">\(\sigma^2\)</span>. 基于 <span class="math inline">\(\boldsymbol \beta\)</span> 最小二乘解的 <span class="math inline">\(\sigma^2\)</span> 的估计为</p>
<p><span class="math display" id="eq:6-11">\[\begin{align}
\hat{\sigma}^2&amp; =\frac{1}{n-r}(\boldsymbol y-X\hat{\boldsymbol \beta})&#39;(\boldsymbol y-\boldsymbol X\hat{\boldsymbol \beta})  \\
&amp;=\frac1{n-r}\sum_{i=1}^n{(y_i-\hat{\beta}_0-\hat{\beta}_1x_{i1}-\hat{\beta}_2x_{i2}-\cdots-\hat{\beta}_{p-1}x_{ip-1})^2}
\tag{6.11}
\end{align}\]</span></p>
<p>其中 <span class="math inline">\(r=\operatorname{rank}(\boldsymbol X)\)</span>.</p>
<p>如果假设误差独立分布，且前四阶矩等于正态分布的前四阶矩，那么 <span class="math inline">\(\hat \sigma^2\)</span> 是 <span class="math inline">\(\sigma^2\)</span> 的最佳二次无偏估计 (best quadratic unbiased estimate). 如果误差也服从正态分布，那么 <span class="math inline">\(\hat \sigma^2\)</span> 是 <span class="math inline">\(\sigma^2\)</span> 的最佳无偏估计 (best unbiased estimate)，且 <span class="math inline">\((n - r)\hat \sigma^2 /\sigma^2\)</span> 的抽样分布是自由度为 <span class="math inline">\(n - r\)</span> 的中心卡方分布。</p>
</div>
</div>
<div id="sec6-3" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> 可估性和连通的设计<a href="chap6.html#sec6-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>当过度指定模型或非满秩模型用于实验情况时，存在许多不同的最小二乘解（实际上有无限多个解）。如果两名研究人员分析上述两个数据集，一个使用零和限制，另一个使用置零限制，他们可能会得出不同的结论。对于上一节中的双向示例，<span class="math inline">\(\tau_2^* = -0.833, \tau_2^+ = 2.000\)</span>；因此，一位研究人员可能会说 <span class="math inline">\(\tau_2\)</span> 很可能为负，而另一位研究人员可能会说 <span class="math inline">\(\tau_2\)</span> 很可能为正——<strong>而这两种说法都是错误的</strong>。</p>
<div id="sec6-3-1" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> 可估函数<a href="chap6.html#sec6-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>由于两位研究人员都在分析相同的数据集，因此他们似乎应该只考虑对两个重新参数化模型具有相同估计的参数或参数的函数。这种参数函数称为<strong>参数的可估函数</strong> (estimable functions of the parameters).</p>
<div class="definition">
<p><span id="def:6-1" class="definition"><strong>定义 6.1  </strong></span>♦</p>
<p>参数或参数的函数 <span class="math inline">\(f(\boldsymbol \beta)\)</span> 是可估的，当且仅当参数或参数的函数的估计值对于最小二乘解的选择是不变的；也就是说，无论使用正规方程组的哪个解，估计值都是相同的。</p>
</div>
<p>如果两位研究人员对参数的可估函数进行了估计，即使他们采用了两种不同的最小二乘解，他们也会得到相同的估计值。因此，他们对于参数的可估函数会得出相同的结论。对于矩阵模型，<span class="math inline">\(\boldsymbol \beta\)</span> 的线性可估函数表现为参数向量的线性组合，如 <span class="math inline">\(\boldsymbol a^\prime \boldsymbol \beta\)</span>，其中 <span class="math inline">\(\boldsymbol a^\prime\)</span> 是一个 p × 1 的常数向量。线性函数 <span class="math inline">\(\boldsymbol a^\prime \boldsymbol \beta\)</span> 是可估的，当且仅当存在向量 <span class="math inline">\(r\)</span>，使得 <span class="math inline">\(\boldsymbol a =\boldsymbol X ^\prime \boldsymbol X r\)</span>. 每个形如 <span class="math inline">\(\boldsymbol x^\prime_i \boldsymbol \beta\)</span> 的函数都是可估的，其中 <span class="math inline">\(\boldsymbol x^\prime_i\)</span> 是 <span class="math inline">\(\boldsymbol X\)</span> 的第 <span class="math inline">\(i\)</span> 行。此外，<span class="math inline">\(\boldsymbol x^\prime_i \boldsymbol \beta\)</span> 的任何线性组合都是可估的函数。考虑 <a href="chap6.html#sec6-2">6.2</a> 节中单向示例的两个解。由于每个参数 <span class="math inline">\(\mu,\tau_1,\tau_2,\tau_3,\tau_4\)</span> 都有两个不同的解，因此这些参数被认为是<strong>不可估的</strong> (nonestimable). 但是，通过计算每种方法关于 <span class="math inline">\(\mu + \tau_i\)</span> 的估计值，可以发现</p>
<p><span class="math display">\[\hat{\mu}^*+\hat{\tau}_i^*=\hat{\mu}^++\hat{\tau}_i^+,\quad i=1,2,3,4\]</span></p>
<p>证明 <span class="math inline">\(\mu + \tau_i\)</span> 是参数的可估函数。</p>
<p><span class="math inline">\(\tau_i\)</span> 的所有对比，如差异 <span class="math inline">\({\tau}_1{-\tau}_2{,\tau}_1{-\tau}_3{,\tau}_2{-\tau}_3\)</span> 或者 <span class="math inline">\(\sum_{i=1}^tc_i\tau_i\)</span> 其中 <span class="math inline">\(\sum_{i=1}^tc_i=0\)</span>，可证明是单向模型的可估函数。</p>
<p>对于双向效应模型，一些可估函数为</p>
<p><span class="math inline">\(\mu+\tau_i+\beta_j+\gamma_{ij},\quad\gamma_{ij}-\gamma_{ij^\prime}-\gamma_{i^\prime j}+\gamma_{i^\prime j^\prime},\quad\beta_j-\beta_j+\bar{\gamma}_{\cdot j}-\bar{\gamma}_{\cdot j^\prime},\quad\tau_i-\tau_i+\bar{\gamma}_{i\cdot}-\bar{\gamma}_{i^\prime\cdot}\)</span></p>
<p>可估函数在第 <a href="chap10.html#chap10">10</a> 章进行了更详细的讨论。这里需记住的重点是可估函数的定义。从数据集中进行推断时，必须只考虑可估的参数函数，因为它们是参数的函数，其估计值不依赖于选择的最小二乘解。SAS<sup>®</sup>-GLM 和 SAS<sup>®</sup>-Mixed 都会检查所请求估计的参数或参数函数是否确实是可估的。如果参数或参数函数不可估，则不提供估计值。</p>
</div>
<div id="sec6-3-2" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> 连通性<a href="chap6.html#sec6-3-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>与可估函数相关的另一个概念是双向处理结构的<strong>连通性</strong> (connectedness). 如果可以假设行处理和列处理的水平之间没有交互作用，那么可以将处理组合平均值建模为</p>
<p><span class="math display" id="eq:6-12">\[\begin{equation}
\mu_{ij}=\mu+\tau_i+\beta_j,\quad i=1,2,\ldots,b,j=1,2,\ldots,t
\tag{6.12}
\end{equation}\]</span></p>
<p>如果双向处理结构中的数据以这样的方式出现在双向单元格中，即对于模型 <a href="chap6.html#eq:6-12">(6.12)</a> 中的所有 <span class="math inline">\(j\ne j^\prime\)</span> 以及 <span class="math inline">\(i\ne i^\prime\)</span>，<span class="math inline">\(\beta_j-\beta_{j^\prime}\)</span> 和 <span class="math inline">\(\tau_i-\tau_{i^\prime}\)</span> 都是可估的，则该双向处理结构被称为<strong>连通的</strong> (connected)。图 <a href="chap6.html#fig:figure6-1">6.1</a> 中的安排 I 是一个连通的实验，而安排 II 不是。例如，使用安排 I，</p>
<p><span class="math display">\[\beta_1-\beta_2=(\mu+\tau_1+\beta_1)-(\mu+\tau_1+\beta_5)+(\mu+\tau_2+\beta_5)-(\mu+\tau_2+\beta_2)\]</span></p>
<p>我们可以得到单元格均值的线性组合，因此 <span class="math inline">\(\beta_1-\beta_2\)</span> 是可估的。对于安排 II，没有这样的单元格均值的线性组合可以得到 <span class="math inline">\(\beta_1-\beta_2\)</span>，因此 <span class="math inline">\(\beta_1-\beta_2\)</span> 是不可估的。下一节将讨论关于参数的可估函数的假设检验。</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figure6-1"></span>
<img src="figure/figure%206.1.png" alt="连通和非连通的双向处理结构" width="972" />
<p class="caption">
图 6.1: 连通和非连通的双向处理结构
</p>
</div>
</div>
</div>
<div id="sec6-4" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> 关于线性模型参数的检验假设<a href="chap6.html#sec6-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>对于线性模型中参数线性函数的假设检验，有多种方法可以开发适当的统计量。这里使用的方法用矩阵表示法，相当于条件误差原理（第 <a href="chap1.html#chap1">1</a> 章）和似然比统计量。讨论仅限于检验关于参数的可估函数的假设。特别是，考虑检验假设</p>
<p><span class="math display" id="eq:6-13">\[\begin{equation}
H_0{:\boldsymbol{H\beta}}=\boldsymbol{h}\mathrm{~vs~}H_a{:\boldsymbol{H\beta}}\neq\boldsymbol{h}
\tag{6.13}
\end{equation}\]</span></p>
<p>其中线性组合 <span class="math inline">\(\boldsymbol{H\beta}\)</span> 是 <span class="math inline">\(\boldsymbol \beta\)</span> 的可估函数，<span class="math inline">\(\boldsymbol H\)</span> 是秩为 <span class="math inline">\(q\)</span> 的 q × p矩阵（即，<span class="math inline">\(\boldsymbol H\)</span> 的所有行是线性无关的）。相应的检验统计量为</p>
<p><span class="math display" id="eq:6-14">\[\begin{equation}
F_c=\frac{SSH_0/q}{\hat{\sigma}^2}
\tag{6.14}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(\hat \sigma^2\)</span> 由式 <a href="chap6.html#eq:6-11">(6.11)</a> 给出，并且</p>
<p><span class="math display" id="eq:6-15">\[\begin{equation}
SSH_0=(\boldsymbol H\hat{\boldsymbol{\beta}}-\boldsymbol h)^{\prime}\left[\boldsymbol H(\boldsymbol X^{\prime}\boldsymbol X)^{-}\boldsymbol H^{\prime}\right]^{-1}(\boldsymbol H\hat{\boldsymbol{\beta}}-\boldsymbol h)
\tag{6.15}
\end{equation}\]</span></p>
<p>这被称为<strong>因偏离零假设而产生的平方和</strong> (sum of squares due to deviations from the null hypothesis)（记号 “<span class="math inline">\((\boldsymbol X^{\prime}\boldsymbol X)^{-}\)</span>” 表示矩阵 <span class="math inline">\(\boldsymbol X^{\prime}\boldsymbol X\)</span> 的广义逆，Graybill, 1976）。在误差向量元素为 <span class="math inline">\(i.i.d.\,N(0,\sigma^2)\)</span> 的假设下，<span class="math inline">\(F_c\)</span> 服从自由度为 <span class="math inline">\(q,n-r\)</span> 的 <span class="math inline">\(F\)</span> 分布。</p>
<p>式 <a href="chap6.html#eq:6-13">(6.13)</a> 中的假设总是可以用重新参数模型 <span class="math inline">\(\boldsymbol{y}=\boldsymbol{X}^*\boldsymbol{\beta}^*+\boldsymbol \varepsilon\)</span> 来等价地表述为下式，其中 <span class="math inline">\(\boldsymbol X^{*\prime}\boldsymbol X^*\)</span> 是非奇异的</p>
<p><span class="math display">\[H_0{:}H^*\boldsymbol{\beta}^*=\boldsymbol{h}^*\mathrm{~vs~}H_a{:}H^*\boldsymbol{\beta}^*\neq\boldsymbol{h}^*\]</span></p>
<p>则式 <a href="chap6.html#eq:6-15">(6.15)</a> 的 <span class="math inline">\(SSH_0\)</span> 可计算为</p>
<p><span class="math display">\[SSH_0=(\boldsymbol H^*\hat{\boldsymbol{\beta}}^*-\boldsymbol{h}^*)^{\prime}[\boldsymbol H^*(\boldsymbol X^{*\prime}\boldsymbol X^*)^{-1}(\boldsymbol{H}^*{}^{\prime}\hat{\boldsymbol{\beta}}^*-\boldsymbol{h}^*)]\]</span></p>
<p>对于单向模型，在原始效应模型中检验假设</p>
<p><span class="math display">\[\begin{aligned}H_0\colon\tau_1=\tau_2=\cdots=\tau_t\text{ vs }H_a\colon\tau_i\neq\tau_{i&#39;}\quad\text{for some }i\neq i&#39;\end{aligned}\]</span></p>
<p>相当于在置零重新参数化模型中检验</p>
<p><span class="math display">\[\begin{aligned}H_0\colon\tau_1^*=\tau_2^*=&amp;\cdots=\tau_{t-1}^*=0\text{ vs }H_a{:}\tau_i^*\neq0\quad\text{for some }i\leq t\text{ -1}\end{aligned}\]</span></p>
<p>对于示例 <a href="chap6.html#sec6-2-4">6.2</a> 关于 <span class="math inline">\(\boldsymbol \beta^*\)</span> 的零假设是</p>
<p><span class="math display">\[H_0{:}\begin{bmatrix}0&amp;1&amp;0&amp;0\\0&amp;0&amp;1&amp;0\\0&amp;0&amp;0&amp;1\end{bmatrix}\begin{bmatrix}\mu^*\\\tau_1^*\\\tau_2^*\\\tau_3^*\end{bmatrix}=0\quad\mathrm{or}\quad \boldsymbol H^*\boldsymbol \beta^*=0\]</span></p>
<p>偏离 <span class="math inline">\(H_0\)</span> 而产生的平方和为</p>
<p><span class="math display">\[SSH_0=(\hat{\tau}_1^*\quad\hat{\tau}_1^*\quad\hat{\tau}_1^*)\,\boldsymbol{Z}^{-1}\begin{bmatrix}\hat{\tau}_1^*\\\hat{\tau}_2^*\\\hat{\tau}_3^*\end{bmatrix}\]</span></p>
<p>其中 <span class="math inline">\(\boldsymbol{Z}=\boldsymbol{H}^*(\boldsymbol{X}^*\boldsymbol{&#39;}\boldsymbol{X}^*)^{-1}\boldsymbol{H}^*\boldsymbol{&#39;}\)</span>. 这是矩阵 <span class="math inline">\((\boldsymbol{X}^*\boldsymbol{&#39;}\boldsymbol{X}^*)^{-1}\)</span> 中与 <span class="math inline">\(\tau_1,\tau_2,\tau_3)\)</span> 相关的行和列的部分。</p>
<p>可估函数 <span class="math inline">\(\boldsymbol a^\prime \boldsymbol \beta\)</span> 的一个 <span class="math inline">\((1-\alpha)100\%\)</span> 置信区间为</p>
<p><span class="math display">\[\boldsymbol a^{\prime}\hat{\boldsymbol \beta}-[t_{\alpha/2,n-p}]S_{\boldsymbol a^{\prime}\hat{\boldsymbol \beta}}\leq a^{\prime}\boldsymbol{\beta}\leq a^{\prime}\hat{\beta}+[t_{\alpha/2,n-p}]S_{\boldsymbol a^{\prime}\hat{\boldsymbol \beta}}\]</span></p>
<p>其中 <span class="math inline">\(S_{\boldsymbol a&#39;\boldsymbol{\beta}}^2=\hat{\sigma}^2\boldsymbol{a&#39;}(\boldsymbol{X&#39;}\boldsymbol{X})^{-1}\boldsymbol{a}\)</span>. 通过使用第 <a href="chap3.html#chap3">3</a> 章中讨论的多重比较程序，可以构造关于几个可估函数的同时置信区间 (simultaneous confidence intervals).</p>
</div>
<div id="sec6-5" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> 总体边际均值<a href="chap6.html#sec6-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在通过方差分析对交叉分类数据集进行分析后，实验者通常对估计特定效应或单元格均值感兴趣。<strong>总体边际均值</strong> (population marginal means) 被定义为在特定类别上平均化的参数线性组合，就好像每个单元格中都有一个观测值一样 (Searle et al., 1980). 如果每个单元格中至少有一个观测值，那么所有的总体边际均值都是可估的，而如果某些单元格为空，则它们不一定可估。这个定义不依赖于单元格中的样本量。如果数据代表单元格的比例抽样，那么实验者可能希望考虑单元格均值的加权平均值，其中权重由样本量给出（参见第 <a href="chap10.html#chap10">10</a> 章）。或者，可能需要使用其他加权方案来对各个单元格进行平均。本节末尾提供了一个示例，以演示不同的可能性。</p>
<p>对于完全随机设计的单向处理结构，第 <span class="math inline">\(i\)</span> 个处理的总体边际平均值为 <span class="math inline">\(\mu+\tau_i=\mu_i\)</span>，并由下式估计</p>
<p><span class="math display">\[\widehat{\mu+\tau_i}=\hat{\mu}+\hat{\tau_i}\]</span></p>
<p>其中 <span class="math inline">\(\hat \mu,\hat \tau_i\)</span> 是从正规方程组的任何解得到的。这些估计值被称为<strong>总体边际均值估计</strong> (estimated population marginal means).</p>
<p>对于完全随机设计中的双向处理结构，第 <span class="math inline">\((i,j)\)</span> 个单元格的总体边际平均值为 <span class="math inline">\(\begin{aligned}\mu_{ij}=\mu+\tau_i+\beta_j+\gamma_{ij}\end{aligned}\)</span>. 第 <span class="math inline">\(i\)</span> 行的总体边际均值是该行中 <span class="math inline">\(\mu_{ij}\)</span> 的平均值，或者</p>
<p><span class="math display">\[\bar{\mu}_{i\cdot}=\sum_{j=1}^b\frac{\mu_{ij}}b=\mu+\tau_i+\bar{\beta}_{\cdot}+\bar{\gamma}_{i\cdot}\]</span></p>
<p>第 <span class="math inline">\(j\)</span> 列的总体边际均值是该列中 <span class="math inline">\(\mu_{ij}\)</span> 的平均值，或者</p>
<p><span class="math display">\[\bar{{\mu}}_{\cdot j}=\sum_{i=1}^t\frac{{\mu}_{ij}}t={\mu}+\bar{{\tau}}_{\cdot}+{\beta}_j+\bar{{\gamma}}_{\cdot j}\]</span></p>
<p>总体边际均值估计分别为</p>
<p><span class="math display">\[\begin{aligned}
\hat{{\mu}}_{ij} &amp;=\hat{\mu}+\hat{\tau}_i+\hat{\beta}_j+\hat{\gamma}_{ij},  \\
\hat{\bar{{\mu}}}_{i\cdot} &amp;=\hat{\mu}+\hat{\tau}_i+\sum_{j=1}^b\frac{\hat{\beta}_j}b+\sum_{j=1}^b\frac{\hat{\gamma}_{ij}}b,\\
\hat{\bar{{\mu}}}_{\cdot j}&amp;=\hat{{\mu}}+\sum_{i=1}^t\frac{\hat{{\tau}}_i}t+\hat{{\beta}}_j+\sum_{i=1}^t\frac{\hat{{\gamma}}_{ij}}t
\end{aligned}\]</span></p>
<p>这些估计对于任何可能的最小二乘解都是唯一的</p>
<p><span class="math display">\[\hat{\mu},\hat{\tau}_1,\hat{\tau}_2,\ldots,\hat{\tau}_t,\hat{\beta}_1,\hat{\beta}_2,\ldots,\hat{\beta}_b,\hat{\gamma}_{11},\hat{\gamma}_{12},\ldots,\hat{\gamma}_{tb}\]</span></p>
<p>根据零和限制模型，表 <a href="chap6.html#tab:table6-1">6.1</a> 中双向示例的总体边际平均值 <span class="math inline">\(\hat{\bar\mu}_{1\cdot}\)</span> 的估计为</p>
<p><span class="math display">\[\begin{aligned}
\hat{\bar{\mu}}_{1\cdot}&amp; =\hat{\mu}^*+\hat{\tau}_1^*+\frac{\hat{\beta}_1^*+\hat{\beta}_2^*+\hat{\beta}_3^*}3+\frac{\hat{\gamma}_{11}^*+\hat{\gamma}_{12}^*+\hat{\gamma}_{13}^*}3  \\
&amp;=5.500+2.333+\frac{-2.000-0.500+2.500}3+\frac{-1.333+1.667-0.333}3 \\
&amp;=7.833
\end{aligned}\]</span></p>
<p>当按预期使用置零限制的最小二乘解时，可以获得与 <span class="math inline">\(\hat{\bar\mu}_{1\cdot}\)</span> 相同的值，因为 <span class="math inline">\({\bar\mu}_{1\cdot}\)</span> 在这个例子中是可估的。</p>
<p>当没有空单元格时，所有的总体边际均值都是可估的。如果有空单元格，那么任何涉及一个或多个缺失单元格的总体边际均值都是不可估的。例如，如果 <span class="math inline">\((2,2)\)</span> 单元格在 2×2 处理结构中缺失，则没有关于 <span class="math inline">\(\mu_{22}\)</span> 的信息，因此 <span class="math inline">\(\mu_{22}\)</span> 是不可估的。第 2 列的总体边际均值为</p>
<p><span class="math display">\[\bar{\mu}_{\cdot 2}=\frac{\mu_{12}+\mu_{22}}2\]</span></p>
<p>由于 <span class="math inline">\(\bar{\mu}_{\cdot 2}\)</span> 依赖于 <span class="math inline">\(\mu_{22}\)</span>，因此 <span class="math inline">\(\bar{\mu}_{\cdot 2}\)</span> 是不可估的（<span class="math inline">\(\bar{\mu}_{2\cdot }\)</span> 也不可估）。</p>
<p><strong>任何可估的总体边际均值都可以表示为重新参数化模型参数向量元素的线性组合</strong>；也就是说，对于 <span class="math inline">\(\boldsymbol a\)</span> 的适当选择，总体边际均值可以表示为 <span class="math inline">\(\boldsymbol a^\prime\boldsymbol \beta^*\)</span>. 总体边际均值估计的方差为</p>
<p><span class="math display">\[\mathrm{Var}(\boldsymbol a^{\prime}\hat{\boldsymbol{\beta}^*})=\sigma^2 \boldsymbol a^{\prime}(\boldsymbol X^{*\prime}\boldsymbol X^*)^{-1}\boldsymbol a\]</span></p>
<p>且 <span class="math inline">\(\boldsymbol a^\prime\boldsymbol \beta^*\)</span> 的标准误估计为</p>
<p><span class="math display">\[\widehat{s.e.}(\boldsymbol a^{\prime}\hat{\boldsymbol \beta}^*)=\hat{\sigma}\sqrt{\boldsymbol a^{\prime}(\boldsymbol X^{*\prime} \boldsymbol X^*)^{-1}\boldsymbol a}\]</span></p>
<p>对于置零限制的单向模型，总体边际均值估计为</p>
<p><span class="math display">\[\widehat{\mu+\tau_i}=\hat{\mu}^*+\hat{\tau}_i^*,\quad i=1,2,\ldots,t-1\]</span></p>
<p>且</p>
<p><span class="math display">\[\widehat{{\mu}+{\tau}_t}=\hat{{\mu}}^*\]</span></p>
<p>这些总体边际均值估计的方差为</p>
<p><span class="math display">\[\mathrm{Var}(\widehat{\mu+\tau_i})=\mathrm{Var}(\hat{\mu}^*)+2\mathrm{Cov}(\hat{\mu}^*,\hat{\tau}_i^*)+\mathrm{Var}(\hat{\tau}_i^*)\quad i=1,2,\ldots,t-1\]</span></p>
<p>且</p>
<p><span class="math display">\[\mathrm{Var}(\widehat{\mu+\tau_t})=\mathrm{Var}(\hat{\mu}^*)\]</span></p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table6-3">表 6.3: </span>双向处理结构的平均绩点数据
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%206.3.png">
</td>
</tr>
</tbody>
</table>
<p>表 <a href="chap6.html#tab:table6-3">6.3</a> 中的数据是一所学校学生样本的平均绩点 (GPA)，学生按学年和性别进行分类。双向模型</p>
<p><span class="math display">\[y_{ijk}=\mu+\tau_i+\beta_j+\gamma_{ij}+\varepsilon_{ijk}\quad i=1,2,3,4,\quad j=1,2,\quad k=1,2,\ldots,n_{ij}\]</span></p>
<p>用于描述数据，其中 <span class="math inline">\(y_{ijk}\)</span> 是 GPA 值，<span class="math inline">\(\tau_i\)</span> 是第 <span class="math inline">\(i\)</span> 年的效应，<span class="math inline">\(\beta_j\)</span> 是第 <span class="math inline">\(j\)</span> 个性别的效应，<span class="math inline">\(\gamma_{ij}\)</span> 是交互作用效应。参数的置零最小二乘解如表 <a href="chap6.html#tab:table6-4">6.4</a> 所示。对于那些置零的参数，标准误估计为零。第 <span class="math inline">\(1\)</span> 学年和女性的单元格均值估计为</p>
<p><span class="math display">\[\hat{\mu}_{1f}=\hat{\mu}+\hat{\tau}_1+\hat{\beta}_f+\hat{\gamma}_{1f}=3.333-0.133-0.033+0.205=3.372\]</span></p>
<p>其余单元格均值可类似计算，如表 <a href="chap6.html#tab:table6-6">6.6</a> 所示。表 <a href="chap6.html#tab:table6-6">6.6</a> 和 <a href="chap6.html#tab:table6-7">6.7</a> 提供了边际年份和边际性别的均值估计。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table6-4">表 6.4: </span>双向处理结构中 GPA 数据的最小二乘解
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%206.4.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table6-5">表 6.5: </span>单元格均值及标准误估计
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%206.5.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table6-6">表 6.6: </span>跨性别水平的年份原始均值、最小二乘均值和加权平均值
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%206.6.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table6-7">表 6.7: </span>跨年份水平的女性和男性平均原始均值、最小二乘均值和加权平均值
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%206.7.png">
</td>
</tr>
</tbody>
</table>
<p><strong>原始均值</strong> (raw measn) 是各个单元格均值的加权平均值，使用单元格中的观测数量作为权重。例如，第 1 年的原始均值或<strong>未调整的均值</strong> (unadjusted mean) 计算为</p>
<p><span class="math display">\[\hat{\bar{\mu}}_{1\cdot}=\frac{7^*3.371+5^*3.200}{7+5}=3.300\]</span></p>
<p>年份和性别效应的<strong>最小二乘均值</strong> (least square means) 是相应单元格均值的未加权平均值，第 1 年的最小二乘均值为</p>
<p><span class="math display">\[\hat{\bar{\mu}}_{1\cdot}=\frac{3.371+3.200}2=3.286\]</span></p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table6-8">表 6.8: </span>平均成绩研究中的学生在班级中的分布
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%206.8.png">
</td>
</tr>
</tbody>
</table>
<p>在论述边际年份或边际性别效应时，人们可能想要使用原始均值（根据观察到的单元格大小进行加权）或最小二乘均值（每个单元格均值具有相同的权重，就好像单元格大小相同一样）。对于设计的实验，最小二乘均值可能是人们感兴趣的均值，因为您可能设计了一个每个单元格中观测数量相等的实验，因此，即使某些数据可能缺失，提供假设单元格大小相等的边际均值估计也是一个合理的解决方案。但是，如果数据来自观察性研究，则未加权的均值可能不是人们感兴趣的边际均值。如果数据来自总体的简单随机样本，那么单元格大小可能反映了总体的比例成员结构 (proportional membership structure). 如果情况确实如此，那么原始均值或按样本量加权的均值就是感兴趣的边际均值。但如果单元格中的样本量不代表总体结构，那么最小二乘均值和原始均值都不是感兴趣的指标。当总体中的某些部分因设计或偶然原因被过度采样或采样不足时，就会出现这种现象。当已知总体结构，即每个单元格的总体比例已知时，通过使用已知的总体比例作为权重，可以获得感兴趣的边际均值。例如，假设研究每年中男性和女性的比例如表 <a href="chap6.html#tab:table6-8">6.8</a> 所示。使用权重估计的第 1 年的边际均值为：</p>
<p><span class="math display">\[\hat{\tilde{\mu}}_{1\cdot}=\frac{11^*3.371+22^*3.200}{33}=3.257\]</span></p>
<p>使用权重对女性所有年份的边际均值估计为</p>
<p><span class="math display">\[\hat{\tilde{\mu}}_{\cdot f}=\frac{11^*3.371+12^*3.180+10^*3.475+8^*3.300}{41}=3.327\]</span></p>
<p>使用权重对男性所有年份的边际均值估计为</p>
<p><span class="math display">\[\hat{\tilde{\mu}}_{\cdot m}=\frac{22^*3.200+14^*3.300+13^*3.267+10^*3.333}{59}=3.261\]</span></p>
<p>计算几种调整的均值并从中选择你喜欢的值并不是问题，但有必要尽可能准确地指定总体结构中的比例，然后使用这些权重计算的边际平均估计。这可以通过允许使用 <code>estimate</code> 语句的软件包来完成，其中提供了所需边际均值的估计和标准误的估计。表 <a href="chap6.html#tab:table6-9">6.9</a> 包含使用 SAS-GLM 程序的代码，以表 <a href="chap6.html#tab:table6-8">6.8</a> 中的比例作为权重提供边际均值的估计。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table6-9">表 6.9: </span>带 <code>estimate</code> 语句的SAS<sup>®</sup>-GLM代码，使用表 <a href="chap6.html#tab:table6-8">6.8</a> 中的权重提供性别和年份水平的总体边际均值估计
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%206.9.png">
</td>
</tr>
</tbody>
</table>
</div>
<div id="sec6-6" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> 结束语<a href="chap6.html#sec6-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>本章仅供对理论背景感兴趣的人阅读，介绍了最小二乘估计程序，并讨论了可估性的重要概念。还讨论了总体边际均值的定义和估计。本章为那些想开发供自己使用的统计软件的人提供了通用公式。</p>
</div>
<div id="sec6-7" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> 练习<a href="chap6.html#sec6-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="chap5.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap7.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": false,
"smooth_scroll": false,
"search": {
"engine": "lunr"
}
},
"toc_float": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
