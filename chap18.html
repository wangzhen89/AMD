<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 18 章 随机效应模型和方差分量 | 混乱数据分析：设计的实验</title>
  <meta name="description" content="Analysis of Messy Data Volume 1: Designed Experiments的翻译" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="第 18 章 随机效应模型和方差分量 | 混乱数据分析：设计的实验" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Analysis of Messy Data Volume 1: Designed Experiments的翻译" />
  <meta name="github-repo" content="wangzhen89/AMD" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 18 章 随机效应模型和方差分量 | 混乱数据分析：设计的实验" />
  
  <meta name="twitter:description" content="Analysis of Messy Data Volume 1: Designed Experiments的翻译" />
  

<meta name="author" content="Wang Zhen" />


<meta name="date" content="2024-03-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap17.html"/>
<link rel="next" href="chap19.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      TeX: {
        Macros: {
          bm: ["{\\boldsymbol #1}",1],
        },
        extensions: ["cancel.js"]
      }
    });
</script>

<!-- add line break after theorem title -->
<script>
  document.addEventListener("DOMContentLoaded", (event) => {
    for (let s of document.querySelectorAll("span.theorem, span.lemma, span.proposition, span.corollary")) {
      s.insertAdjacentHTML('afterend', '<br style="line-height:2px;"/>');
    }
  });
</script>

<!-- check if --themcolor in style.css matches one of elegantbook theme colors. If so, generates the color palette  -->
<script>
  document.addEventListener("DOMContentLoaded", (event) => {
    const cssroot = document.querySelector(':root');
    let theme_color = getComputedStyle(document.documentElement).getPropertyValue('--themecolor').trim();
  
    // blue is the default option

    switch (theme_color) {
      case 'green': 
        cssroot.style.setProperty('--structurecolor', 'rgb(0,120,2)');
        cssroot.style.setProperty('--main', 'rgb(70,70,70)');
        cssroot.style.setProperty('--mainbg', 'rgba(0,166,82,0.05)');
        cssroot.style.setProperty('--second', 'rgb(115,45,2)');
        cssroot.style.setProperty('--secondbg', 'rgba(115,45,2,0.05)');
        cssroot.style.setProperty('--third', 'rgb(0,80,80)');
        cssroot.style.setProperty('--thirdbg', 'rgba(0,80,80,0.05)');
      break;
      case 'cyan':
        cssroot.style.setProperty('--structurecolor', 'rgb(31,186,190)');
        cssroot.style.setProperty('--main', 'rgb(59,180,5)');
        cssroot.style.setProperty('--mainbg', 'rgba(59,180,5,0.05)');
        cssroot.style.setProperty('--second', 'rgb(175,153,8)');
        cssroot.style.setProperty('--secondbg', 'rgba(175,153,8,0.05)');
        cssroot.style.setProperty('--third', 'rgb(244,105,102)');
        cssroot.style.setProperty('--thirdbg', 'rgba(244,105,102,0.05)');
      break;
      case 'gray':
        cssroot.style.setProperty('--structurecolor', 'rgb(150,150,150)');
        cssroot.style.setProperty('--main', 'rgb(150,150,150)');
        cssroot.style.setProperty('--mainbg', 'rgba(150,150,150,0.05)');
        cssroot.style.setProperty('--second', 'rgb(150,150,150)');
        cssroot.style.setProperty('--secondbg', 'rgba(150,150,150,0.05)');
        cssroot.style.setProperty('--third', 'rgb(150,150,150)');
        cssroot.style.setProperty('--thirdbg', 'rgba(150,150,150,0.05)');
      break;
      case 'black':
        cssroot.style.setProperty('--structurecolor', 'rgb(0,0,0)');
        cssroot.style.setProperty('--main', 'rgb(0,0,0)');
        cssroot.style.setProperty('--mainbg', 'rgba(0,0,0,0.05)');
        cssroot.style.setProperty('--second', 'rgb(0,0,0)');
        cssroot.style.setProperty('--secondbg', 'rgba(0,0,0,0.05)');
        cssroot.style.setProperty('--third', 'rgb(0,0,0)');
        cssroot.style.setProperty('--thirdbg', 'rgba(0,0,0,0.05)');
      break;
    default:
        cssroot.style.setProperty('--structurecolor', 'rgb(60,113,183)');
        cssroot.style.setProperty('--main', 'rgb(0,166,82)');
        cssroot.style.setProperty('--mainbg', 'rgba(0,166,82,0.05)');
        cssroot.style.setProperty('--second', 'rgb(255,134,24)');
        cssroot.style.setProperty('--secondbg', 'rgba(255,134,24,0.05)');
        cssroot.style.setProperty('--third', 'rgb(0,174,247)');
        cssroot.style.setProperty('--thirdbg', 'rgba(0,174,247,0.05)');
    }
  });
  </script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">混乱数据分析：设计的实验</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>介绍</a></li>
<li class="part"><span><b>I 热身</b></span></li>
<li class="chapter" data-level="1" data-path="chap1.html"><a href="chap1.html"><i class="fa fa-check"></i><b>1</b> 最简单的情况：具有同质误差的完全随机设计结构中的单向处理结构</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chap1.html"><a href="chap1.html#sec1-1"><i class="fa fa-check"></i><b>1.1</b> 模型定义和假设</a></li>
<li class="chapter" data-level="1.2" data-path="chap1.html"><a href="chap1.html#sec1-2"><i class="fa fa-check"></i><b>1.2</b> 参数估计</a></li>
<li class="chapter" data-level="1.3" data-path="chap1.html"><a href="chap1.html#sec1-3"><i class="fa fa-check"></i><b>1.3</b> 线性组合的推断：检验与置信区间</a></li>
<li class="chapter" data-level="1.4" data-path="chap1.html"><a href="chap1.html#sec1-4"><i class="fa fa-check"></i><b>1.4</b> 示例：任务和脉搏率</a></li>
<li class="chapter" data-level="1.5" data-path="chap1.html"><a href="chap1.html#sec1-5"><i class="fa fa-check"></i><b>1.5</b> 几个线性组合的同时检验</a></li>
<li class="chapter" data-level="1.6" data-path="chap1.html"><a href="chap1.html#sec1-6"><i class="fa fa-check"></i><b>1.6</b> 示例：任务和脉搏率（续）</a></li>
<li class="chapter" data-level="1.7" data-path="chap1.html"><a href="chap1.html#sec1-7"><i class="fa fa-check"></i><b>1.7</b> 检验所有均值相等</a></li>
<li class="chapter" data-level="1.8" data-path="chap1.html"><a href="chap1.html#sec1-8"><i class="fa fa-check"></i><b>1.8</b> 示例：任务和脉搏率（续）</a></li>
<li class="chapter" data-level="1.9" data-path="chap1.html"><a href="chap1.html#sec1-9"><i class="fa fa-check"></i><b>1.9</b> 比较两种模型的一般方法：条件误差原理</a></li>
<li class="chapter" data-level="1.10" data-path="chap1.html"><a href="chap1.html#sec1-10"><i class="fa fa-check"></i><b>1.10</b> 示例：任务和脉搏率（续）</a></li>
<li class="chapter" data-level="1.11" data-path="chap1.html"><a href="chap1.html#sec1-11"><i class="fa fa-check"></i><b>1.11</b> 计算机分析</a></li>
<li class="chapter" data-level="1.12" data-path="chap1.html"><a href="chap1.html#sec1-12"><i class="fa fa-check"></i><b>1.12</b> 结束语</a></li>
<li class="chapter" data-level="1.13" data-path="chap1.html"><a href="chap1.html#sec1-13"><i class="fa fa-check"></i><b>1.13</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap2.html"><a href="chap2.html"><i class="fa fa-check"></i><b>2</b> 具有异质误差的完全随机设计结构中的单向处理结构</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chap2.html"><a href="chap2.html#sec2-1"><i class="fa fa-check"></i><b>2.1</b> 模型定义和假设</a></li>
<li class="chapter" data-level="2.2" data-path="chap2.html"><a href="chap2.html#sec2-2"><i class="fa fa-check"></i><b>2.2</b> 参数估计</a></li>
<li class="chapter" data-level="2.3" data-path="chap2.html"><a href="chap2.html#sec2-3"><i class="fa fa-check"></i><b>2.3</b> 方差齐性检验</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chap2.html"><a href="chap2.html#sec2-3-1"><i class="fa fa-check"></i><b>2.3.1</b> Hartley’s <em>F</em>-Max Test</a></li>
<li class="chapter" data-level="2.3.2" data-path="chap2.html"><a href="chap2.html#sec2-3-2"><i class="fa fa-check"></i><b>2.3.2</b> Bartlett’s Test</a></li>
<li class="chapter" data-level="2.3.3" data-path="chap2.html"><a href="chap2.html#sec2-3-3"><i class="fa fa-check"></i><b>2.3.3</b> Levene’s Test</a></li>
<li class="chapter" data-level="2.3.4" data-path="chap2.html"><a href="chap2.html#sec2-4-4"><i class="fa fa-check"></i><b>2.3.4</b> Brown and Forsythe’s Test</a></li>
<li class="chapter" data-level="2.3.5" data-path="chap2.html"><a href="chap2.html#sec2-3-5"><i class="fa fa-check"></i><b>2.3.5</b> O’Brien’s Test</a></li>
<li class="chapter" data-level="2.3.6" data-path="chap2.html"><a href="chap2.html#sec2-3-6"><i class="fa fa-check"></i><b>2.3.6</b> 一些建议</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chap2.html"><a href="chap2.html#sec2-4"><i class="fa fa-check"></i><b>2.4</b> 示例：药物和错误</a></li>
<li class="chapter" data-level="2.5" data-path="chap2.html"><a href="chap2.html#sec2-5"><i class="fa fa-check"></i><b>2.5</b> 关于线性组合的推断</a></li>
<li class="chapter" data-level="2.6" data-path="chap2.html"><a href="chap2.html#sec2-6"><i class="fa fa-check"></i><b>2.6</b> 示例：药物和错误（续）</a></li>
<li class="chapter" data-level="2.7" data-path="chap2.html"><a href="chap2.html#sec2-7"><i class="fa fa-check"></i><b>2.7</b> 自由度的一般 Satterthwaite 近似</a></li>
<li class="chapter" data-level="2.8" data-path="chap2.html"><a href="chap2.html#sec2-8"><i class="fa fa-check"></i><b>2.8</b> 比较所有均值</a></li>
<li class="chapter" data-level="2.9" data-path="chap2.html"><a href="chap2.html#sec2-9"><i class="fa fa-check"></i><b>2.9</b> 结束语</a></li>
<li class="chapter" data-level="2.10" data-path="chap2.html"><a href="chap2.html#sec2-10"><i class="fa fa-check"></i><b>2.10</b> 练习</a></li>
</ul></li>
<li class="part"><span><b>II 磨刀</b></span></li>
<li class="chapter" data-level="3" data-path="chap3.html"><a href="chap3.html"><i class="fa fa-check"></i><b>3</b> 联合推断程序和多重比较</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chap3.html"><a href="chap3.html#sec3-1"><i class="fa fa-check"></i><b>3.1</b> 错误率</a></li>
<li class="chapter" data-level="3.2" data-path="chap3.html"><a href="chap3.html#sec3-2"><i class="fa fa-check"></i><b>3.2</b> 建议</a></li>
<li class="chapter" data-level="3.3" data-path="chap3.html"><a href="chap3.html#sec3-3"><i class="fa fa-check"></i><b>3.3</b> 最小显著差异</a></li>
<li class="chapter" data-level="3.4" data-path="chap3.html"><a href="chap3.html#sec3-4"><i class="fa fa-check"></i><b>3.4</b> Fisher’s LSD Procedure</a></li>
<li class="chapter" data-level="3.5" data-path="chap3.html"><a href="chap3.html#sec3-5"><i class="fa fa-check"></i><b>3.5</b> Bonferroni’s Method</a></li>
<li class="chapter" data-level="3.6" data-path="chap3.html"><a href="chap3.html#sec3-6"><i class="fa fa-check"></i><b>3.6</b> Scheffé’s Procedure</a></li>
<li class="chapter" data-level="3.7" data-path="chap3.html"><a href="chap3.html#sec3-7"><i class="fa fa-check"></i><b>3.7</b> Tukey–Kramer Method</a></li>
<li class="chapter" data-level="3.8" data-path="chap3.html"><a href="chap3.html#sec3-8"><i class="fa fa-check"></i><b>3.8</b> 模拟方法</a></li>
<li class="chapter" data-level="3.9" data-path="chap3.html"><a href="chap3.html#sec3-9"><i class="fa fa-check"></i><b>3.9</b> Šidák Procedure</a></li>
<li class="chapter" data-level="3.10" data-path="chap3.html"><a href="chap3.html#sec3-10"><i class="fa fa-check"></i><b>3.10</b> 示例：成对比较</a></li>
<li class="chapter" data-level="3.11" data-path="chap3.html"><a href="chap3.html#sec3-11"><i class="fa fa-check"></i><b>3.11</b> Dunnett’s Procedure</a></li>
<li class="chapter" data-level="3.12" data-path="chap3.html"><a href="chap3.html#sec3-12"><i class="fa fa-check"></i><b>3.12</b> 示例：与对照比较</a></li>
<li class="chapter" data-level="3.13" data-path="chap3.html"><a href="chap3.html#sec3-13"><i class="fa fa-check"></i><b>3.13</b> 多元 <span class="math inline">\(t\)</span></a></li>
<li class="chapter" data-level="3.14" data-path="chap3.html"><a href="chap3.html#sec3-14"><i class="fa fa-check"></i><b>3.14</b> 示例：线性独立比较</a></li>
<li class="chapter" data-level="3.15" data-path="chap3.html"><a href="chap3.html#sec3-15"><i class="fa fa-check"></i><b>3.15</b> 序贯拒绝方法</a>
<ul>
<li class="chapter" data-level="3.15.1" data-path="chap3.html"><a href="chap3.html#sec3-15-1"><i class="fa fa-check"></i><b>3.15.1</b> Bonferroni–Holm Method</a></li>
<li class="chapter" data-level="3.15.2" data-path="chap3.html"><a href="chap3.html#sec3-15-2"><i class="fa fa-check"></i><b>3.15.2</b> Šidák–Holm Method</a></li>
<li class="chapter" data-level="3.15.3" data-path="chap3.html"><a href="chap3.html#sec3-15-3"><i class="fa fa-check"></i><b>3.15.3</b> 控制 FDR 的 Benjamini 和 Hochberg Method</a></li>
</ul></li>
<li class="chapter" data-level="3.16" data-path="chap3.html"><a href="chap3.html#sec3-16"><i class="fa fa-check"></i><b>3.16</b> 示例：线性相关比较</a></li>
<li class="chapter" data-level="3.17" data-path="chap3.html"><a href="chap3.html#sec3-17"><i class="fa fa-check"></i><b>3.17</b> 多重极差检验</a>
<ul>
<li class="chapter" data-level="3.17.1" data-path="chap3.html"><a href="chap3.html#sec3-17-1"><i class="fa fa-check"></i><b>3.17.1</b> Student–Newman–Keul’s Method</a></li>
<li class="chapter" data-level="3.17.2" data-path="chap3.html"><a href="chap3.html#sec3-17-2"><i class="fa fa-check"></i><b>3.17.2</b> Duncan’s New Multiple Range Method</a></li>
</ul></li>
<li class="chapter" data-level="3.18" data-path="chap3.html"><a href="chap3.html#sec3-18"><i class="fa fa-check"></i><b>3.18</b> Waller–Duncan Procedure</a></li>
<li class="chapter" data-level="3.19" data-path="chap3.html"><a href="chap3.html#sec3-19"><i class="fa fa-check"></i><b>3.19</b> 示例：成对比较的多重极差</a></li>
<li class="chapter" data-level="3.20" data-path="chap3.html"><a href="chap3.html#sec3-20"><i class="fa fa-check"></i><b>3.20</b> 警示</a></li>
<li class="chapter" data-level="3.21" data-path="chap3.html"><a href="chap3.html#sec3-21"><i class="fa fa-check"></i><b>3.21</b> 结束语</a></li>
<li class="chapter" data-level="3.22" data-path="chap3.html"><a href="chap3.html#sec3-22"><i class="fa fa-check"></i><b>3.22</b> 练习</a></li>
<li class="chapter" data-level="" data-path="chap3.html"><a href="chap3.html#参考文献"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap4.html"><a href="chap4.html"><i class="fa fa-check"></i><b>4</b> 实验设计基础</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chap4.html"><a href="chap4.html#sec4-1"><i class="fa fa-check"></i><b>4.1</b> 介绍基本概念</a></li>
<li class="chapter" data-level="4.2" data-path="chap4.html"><a href="chap4.html#sec4-2"><i class="fa fa-check"></i><b>4.2</b> 设计实验的结构</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="chap4.html"><a href="chap4.html#sec4-2-1"><i class="fa fa-check"></i><b>4.2.1</b> 设计结构类型</a></li>
<li class="chapter" data-level="4.2.2" data-path="chap4.html"><a href="chap4.html#sec4-2-2"><i class="fa fa-check"></i><b>4.2.2</b> 处理结构类型</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chap4.html"><a href="chap4.html#sec4-3"><i class="fa fa-check"></i><b>4.3</b> 不同设计实验的示例</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chap4.html"><a href="chap4.html#sec4-3-1"><i class="fa fa-check"></i><b>4.3.1</b> 示例 4.1: 饮食</a></li>
<li class="chapter" data-level="4.3.2" data-path="chap4.html"><a href="chap4.html#sec4-3-2"><i class="fa fa-check"></i><b>4.3.2</b> 示例 4.2: 房屋油漆</a></li>
<li class="chapter" data-level="4.3.3" data-path="chap4.html"><a href="chap4.html#sec4-3-3"><i class="fa fa-check"></i><b>4.3.3</b> 示例 4.3: 钢板</a></li>
<li class="chapter" data-level="4.3.4" data-path="chap4.html"><a href="chap4.html#sec4-3-4"><i class="fa fa-check"></i><b>4.3.4</b> 示例 4.4: 氮和钾的水平</a></li>
<li class="chapter" data-level="4.3.5" data-path="chap4.html"><a href="chap4.html#sec4-3-5"><i class="fa fa-check"></i><b>4.3.5</b> 示例 4.5: 区组和重复</a></li>
<li class="chapter" data-level="4.3.6" data-path="chap4.html"><a href="chap4.html#sec4-3-6"><i class="fa fa-check"></i><b>4.3.6</b> 示例 4.6：行区组和列区组</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chap4.html"><a href="chap4.html#sec4-4"><i class="fa fa-check"></i><b>4.4</b> 结束语</a></li>
<li class="chapter" data-level="4.5" data-path="chap4.html"><a href="chap4.html#sec4-5"><i class="fa fa-check"></i><b>4.5</b> 练习</a></li>
<li class="chapter" data-level="" data-path="chap4.html"><a href="chap4.html#参考文献-1"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap5.html"><a href="chap5.html"><i class="fa fa-check"></i><b>5</b> 多水平设计：裂区、条区、重复测量及其组合</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap5.html"><a href="chap5.html#sec5-1"><i class="fa fa-check"></i><b>5.1</b> 识别实验单元的尺寸——四种基本设计结构</a></li>
<li class="chapter" data-level="5.2" data-path="chap5.html"><a href="chap5.html#sec5-2"><i class="fa fa-check"></i><b>5.2</b> 分层设计：一种多水平的设计结构</a></li>
<li class="chapter" data-level="5.3" data-path="chap5.html"><a href="chap5.html#sec5-3"><i class="fa fa-check"></i><b>5.3</b> 裂区设计结构：两水平设计结构</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chap5.html"><a href="chap5.html#sec5-3-1"><i class="fa fa-check"></i><b>5.3.1</b> 示例 5.1：烹饪大豆——最简单的裂区或两水平设计结构</a></li>
<li class="chapter" data-level="5.3.2" data-path="chap5.html"><a href="chap5.html#sec5-3-2"><i class="fa fa-check"></i><b>5.3.2</b> 示例 5.2：磨小麦——通常的裂区或两水平设计结构</a></li>
<li class="chapter" data-level="5.3.3" data-path="chap5.html"><a href="chap5.html#sec5-3-3"><i class="fa fa-check"></i><b>5.3.3</b> 示例 5.3：烘焙面包——具有不完全块设计结构的裂区</a></li>
<li class="chapter" data-level="5.3.4" data-path="chap5.html"><a href="chap5.html#sec5-3-4"><i class="fa fa-check"></i><b>5.3.4</b> 示例 5.4：展示柜中的肉——复杂裂区或四水平设计</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chap5.html"><a href="chap5.html#sec5-4"><i class="fa fa-check"></i><b>5.4</b> 条区设计结构：一种无层次的多水平设计</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="chap5.html"><a href="chap5.html#sec5-4-1"><i class="fa fa-check"></i><b>5.4.1</b> 示例 5.5：制作奶酪</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="chap5.html"><a href="chap5.html#sec5-5"><i class="fa fa-check"></i><b>5.5</b> 重复测量设计</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="chap5.html"><a href="chap5.html#sec5-5-1"><i class="fa fa-check"></i><b>5.5.1</b> 示例 5.6：马足——基本重复测量设计</a></li>
<li class="chapter" data-level="5.5.2" data-path="chap5.html"><a href="chap5.html#sec5-5-2"><i class="fa fa-check"></i><b>5.5.2</b> 示例 5.7：舒适度研究——重复测量设计</a></li>
<li class="chapter" data-level="5.5.3" data-path="chap5.html"><a href="chap5.html#示例-5.8交叉或转换设计"><i class="fa fa-check"></i><b>5.5.3</b> 示例 5.8：交叉或转换设计</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="chap5.html"><a href="chap5.html#sec5-6"><i class="fa fa-check"></i><b>5.6</b> 涉及嵌套因素的设计</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="chap5.html"><a href="chap5.html#sec5-6-1"><i class="fa fa-check"></i><b>5.6.1</b> 示例 5.9：动物遗传学</a></li>
<li class="chapter" data-level="5.6.2" data-path="chap5.html"><a href="chap5.html#sec5-6-2"><i class="fa fa-check"></i><b>5.6.2</b> 示例 5.10：大豆的生育期组</a></li>
<li class="chapter" data-level="5.6.3" data-path="chap5.html"><a href="chap5.html#sec5-6-3"><i class="fa fa-check"></i><b>5.6.3</b> 示例 5.11：飞机引擎</a></li>
<li class="chapter" data-level="5.6.4" data-path="chap5.html"><a href="chap5.html#sec5-6-4"><i class="fa fa-check"></i><b>5.6.4</b> 示例 5.12：简单的舒适度实验</a></li>
<li class="chapter" data-level="5.6.5" data-path="chap5.html"><a href="chap5.html#sec5-6-5"><i class="fa fa-check"></i><b>5.6.5</b> 示例 5.13：重复测量的多地点研究</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="chap5.html"><a href="chap5.html#sec5-7"><i class="fa fa-check"></i><b>5.7</b> 结束语</a></li>
<li class="chapter" data-level="5.8" data-path="chap5.html"><a href="chap5.html#sec5-8"><i class="fa fa-check"></i><b>5.8</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap6.html"><a href="chap6.html"><i class="fa fa-check"></i><b>6</b> 模型的矩阵形式</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chap6.html"><a href="chap6.html#sec6-1"><i class="fa fa-check"></i><b>6.1</b> 基本符号</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chap6.html"><a href="chap6.html#sec6-1-1"><i class="fa fa-check"></i><b>6.1.1</b> 简单线性回归模型</a></li>
<li class="chapter" data-level="6.1.2" data-path="chap6.html"><a href="chap6.html#sec6-1-2"><i class="fa fa-check"></i><b>6.1.2</b> 单向处理结构模型</a></li>
<li class="chapter" data-level="6.1.3" data-path="chap6.html"><a href="chap6.html#sec6-1-3"><i class="fa fa-check"></i><b>6.1.3</b> 双向处理结构模型</a></li>
<li class="chapter" data-level="6.1.4" data-path="chap6.html"><a href="chap6.html#sec6-1-4"><i class="fa fa-check"></i><b>6.1.4</b> 示例 6.1：双向处理结构的均值模型</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chap6.html"><a href="chap6.html#sec6-2"><i class="fa fa-check"></i><b>6.2</b> 最小二乘估计</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="chap6.html"><a href="chap6.html#sec6-2-1"><i class="fa fa-check"></i><b>6.2.1</b> 最小二乘方程组</a></li>
<li class="chapter" data-level="6.2.2" data-path="chap6.html"><a href="chap6.html#sec6-2-2"><i class="fa fa-check"></i><b>6.2.2</b> 零和限制</a></li>
<li class="chapter" data-level="6.2.3" data-path="chap6.html"><a href="chap6.html#sec6-2-3"><i class="fa fa-check"></i><b>6.2.3</b> 置零限制</a></li>
<li class="chapter" data-level="6.2.4" data-path="chap6.html"><a href="chap6.html#sec6-2-4"><i class="fa fa-check"></i><b>6.2.4</b> 示例 6.2：单向处理结构</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="chap6.html"><a href="chap6.html#sec6-3"><i class="fa fa-check"></i><b>6.3</b> 可估性和连通的设计</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chap6.html"><a href="chap6.html#sec6-3-1"><i class="fa fa-check"></i><b>6.3.1</b> 可估函数</a></li>
<li class="chapter" data-level="6.3.2" data-path="chap6.html"><a href="chap6.html#sec6-3-2"><i class="fa fa-check"></i><b>6.3.2</b> 连通性</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="chap6.html"><a href="chap6.html#sec6-4"><i class="fa fa-check"></i><b>6.4</b> 关于线性模型参数的检验假设</a></li>
<li class="chapter" data-level="6.5" data-path="chap6.html"><a href="chap6.html#sec6-5"><i class="fa fa-check"></i><b>6.5</b> 总体边际均值</a></li>
<li class="chapter" data-level="6.6" data-path="chap6.html"><a href="chap6.html#sec6-6"><i class="fa fa-check"></i><b>6.6</b> 结束语</a></li>
<li class="chapter" data-level="6.7" data-path="chap6.html"><a href="chap6.html#sec6-7"><i class="fa fa-check"></i><b>6.7</b> 练习</a></li>
</ul></li>
<li class="part"><span><b>III 砍柴</b></span></li>
<li class="chapter" data-level="7" data-path="chap7.html"><a href="chap7.html"><i class="fa fa-check"></i><b>7</b> 均衡双向处理结构</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chap7.html"><a href="chap7.html#sec7-1"><i class="fa fa-check"></i><b>7.1</b> 模型定义和假设</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="chap7.html"><a href="chap7.html#sec7-1-1"><i class="fa fa-check"></i><b>7.1.1</b> 均值模型</a></li>
<li class="chapter" data-level="7.1.2" data-path="chap7.html"><a href="chap7.html#sec7-1-2"><i class="fa fa-check"></i><b>7.1.2</b> 效应模型</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="chap7.html"><a href="chap7.html#sec7-2"><i class="fa fa-check"></i><b>7.2</b> 参数估计</a></li>
<li class="chapter" data-level="7.3" data-path="chap7.html"><a href="chap7.html#sec7-3"><i class="fa fa-check"></i><b>7.3</b> 交互作用及它们的重要性</a></li>
<li class="chapter" data-level="7.4" data-path="chap7.html"><a href="chap7.html#sec7-4"><i class="fa fa-check"></i><b>7.4</b> 主效应</a></li>
<li class="chapter" data-level="7.5" data-path="chap7.html"><a href="chap7.html#sec7-5"><i class="fa fa-check"></i><b>7.5</b> 计算机分析</a></li>
<li class="chapter" data-level="7.6" data-path="chap7.html"><a href="chap7.html#sec7-6"><i class="fa fa-check"></i><b>7.6</b> 结束语</a></li>
<li class="chapter" data-level="7.7" data-path="chap7.html"><a href="chap7.html#sec7-7"><i class="fa fa-check"></i><b>7.7</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap8.html"><a href="chap8.html"><i class="fa fa-check"></i><b>8</b> 案例研究：均衡双向实验的完整分析</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chap8.html"><a href="chap8.html#sec8-1"><i class="fa fa-check"></i><b>8.1</b> 主效应均值对比</a></li>
<li class="chapter" data-level="8.2" data-path="chap8.html"><a href="chap8.html#sec8-2"><i class="fa fa-check"></i><b>8.2</b> 交互对比</a></li>
<li class="chapter" data-level="8.3" data-path="chap8.html"><a href="chap8.html#sec8-3"><i class="fa fa-check"></i><b>8.3</b> 油漆铺路示例</a></li>
<li class="chapter" data-level="8.4" data-path="chap8.html"><a href="chap8.html#sec8-4"><i class="fa fa-check"></i><b>8.4</b> 分析定量处理因素</a></li>
<li class="chapter" data-level="8.5" data-path="chap8.html"><a href="chap8.html#sec8-5"><i class="fa fa-check"></i><b>8.5</b> 多重检验</a></li>
<li class="chapter" data-level="8.6" data-path="chap8.html"><a href="chap8.html#sec8-6"><i class="fa fa-check"></i><b>8.6</b> 结束语</a></li>
<li class="chapter" data-level="8.7" data-path="chap8.html"><a href="chap8.html#sec8-7"><i class="fa fa-check"></i><b>8.7</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap9.html"><a href="chap9.html"><i class="fa fa-check"></i><b>9</b> 使用均值模型分析子类数不等的均衡双向处理结构</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chap9.html"><a href="chap9.html#sec9-1"><i class="fa fa-check"></i><b>9.1</b> 模型定义和假设</a></li>
<li class="chapter" data-level="9.2" data-path="chap9.html"><a href="chap9.html#sec9-2"><i class="fa fa-check"></i><b>9.2</b> 参数估计</a></li>
<li class="chapter" data-level="9.3" data-path="chap9.html"><a href="chap9.html#sec9-3"><i class="fa fa-check"></i><b>9.3</b> 检验所有均值是否相等</a></li>
<li class="chapter" data-level="9.4" data-path="chap9.html"><a href="chap9.html#sec9-4"><i class="fa fa-check"></i><b>9.4</b> 交互作用和主效应假设</a></li>
<li class="chapter" data-level="9.5" data-path="chap9.html"><a href="chap9.html#sec9-5"><i class="fa fa-check"></i><b>9.5</b> 总体边际均值</a></li>
<li class="chapter" data-level="9.6" data-path="chap9.html"><a href="chap9.html#sec9-6"><i class="fa fa-check"></i><b>9.6</b> 同时推断与多重比较</a></li>
<li class="chapter" data-level="9.7" data-path="chap9.html"><a href="chap9.html#sec9-7"><i class="fa fa-check"></i><b>9.7</b> 结束语</a></li>
<li class="chapter" data-level="9.8" data-path="chap9.html"><a href="chap9.html#sec9-8"><i class="fa fa-check"></i><b>9.8</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> 使用效应模型分析子类数不等的均衡双向处理结构</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chap10.html"><a href="chap10.html#sec10-1"><i class="fa fa-check"></i><b>10.1</b> 模型定义</a></li>
<li class="chapter" data-level="10.2" data-path="chap10.html"><a href="chap10.html#sec10-2"><i class="fa fa-check"></i><b>10.2</b> 参数估计和 I 型分析</a></li>
<li class="chapter" data-level="10.3" data-path="chap10.html"><a href="chap10.html#sec10-3"><i class="fa fa-check"></i><b>10.3</b> 在 SAS 中使用可估函数</a></li>
<li class="chapter" data-level="10.4" data-path="chap10.html"><a href="chap10.html#sec10-4"><i class="fa fa-check"></i><b>10.4</b> I–IV 型假设</a></li>
<li class="chapter" data-level="10.5" data-path="chap10.html"><a href="chap10.html#sec10-5"><i class="fa fa-check"></i><b>10.5</b> 在 SAS-GLM 中使用 I–IV 型可估函数</a></li>
<li class="chapter" data-level="10.6" data-path="chap10.html"><a href="chap10.html#sec10-6"><i class="fa fa-check"></i><b>10.6</b> 总体边际均值与最小二乘均值</a></li>
<li class="chapter" data-level="10.7" data-path="chap10.html"><a href="chap10.html#sec10-7"><i class="fa fa-check"></i><b>10.7</b> 计算机分析</a></li>
<li class="chapter" data-level="10.8" data-path="chap10.html"><a href="chap10.html#sec10-8"><i class="fa fa-check"></i><b>10.8</b> 结束语</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap11.html"><a href="chap11.html"><i class="fa fa-check"></i><b>11</b> 分析子类数不等的大型均衡双向实验</a>
<ul>
<li class="chapter" data-level="11.1" data-path="chap11.html"><a href="chap11.html#sec11-1"><i class="fa fa-check"></i><b>11.1</b> 可行性问题</a></li>
<li class="chapter" data-level="11.2" data-path="chap11.html"><a href="chap11.html#sec11-2"><i class="fa fa-check"></i><b>11.2</b> 未加权均值法</a></li>
<li class="chapter" data-level="11.3" data-path="chap11.html"><a href="chap11.html#sec11-3"><i class="fa fa-check"></i><b>11.3</b> 同时推断与多重比较</a></li>
<li class="chapter" data-level="11.4" data-path="chap11.html"><a href="chap11.html#sec11-4"><i class="fa fa-check"></i><b>11.4</b> 未加权均值的示例</a></li>
<li class="chapter" data-level="11.5" data-path="chap11.html"><a href="chap11.html#sec11-5"><i class="fa fa-check"></i><b>11.5</b> 计算机分析</a></li>
<li class="chapter" data-level="11.6" data-path="chap11.html"><a href="chap11.html#sec11-6"><i class="fa fa-check"></i><b>11.6</b> 结束语</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chap12.html"><a href="chap12.html"><i class="fa fa-check"></i><b>12</b> 案例研究：子类数不等的均衡双向处理结构</a>
<ul>
<li class="chapter" data-level="12.1" data-path="chap12.html"><a href="chap12.html#sec12-1"><i class="fa fa-check"></i><b>12.1</b> 脂肪-表面活性剂示例</a></li>
<li class="chapter" data-level="12.2" data-path="chap12.html"><a href="chap12.html#sec12-2"><i class="fa fa-check"></i><b>12.2</b> 结束语</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap13.html"><a href="chap13.html"><i class="fa fa-check"></i><b>13</b> 使用均值模型分析缺失处理组合的双向处理结构</a>
<ul>
<li class="chapter" data-level="13.1" data-path="chap13.html"><a href="chap13.html#sec13-1"><i class="fa fa-check"></i><b>13.1</b> 参数估计</a></li>
<li class="chapter" data-level="13.2" data-path="chap13.html"><a href="chap13.html#sec13-2"><i class="fa fa-check"></i><b>13.2</b> 假设检验和置信区间</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="chap13.html"><a href="chap13.html#sec13-2-1"><i class="fa fa-check"></i><b>13.2.1</b> 示例 13.1</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="chap13.html"><a href="chap13.html#sec13-3"><i class="fa fa-check"></i><b>13.3</b> 计算机分析</a></li>
<li class="chapter" data-level="13.4" data-path="chap13.html"><a href="chap13.html#sec13-4"><i class="fa fa-check"></i><b>13.4</b> 结束语</a></li>
<li class="chapter" data-level="13.5" data-path="chap13.html"><a href="chap13.html#sec13-5"><i class="fa fa-check"></i><b>13.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="chap14.html"><a href="chap14.html"><i class="fa fa-check"></i><b>14</b> 使用效应模型分析缺失处理组合的双向处理结构</a>
<ul>
<li class="chapter" data-level="14.1" data-path="chap14.html"><a href="chap14.html#i-型和-ii-型假设"><i class="fa fa-check"></i><b>14.1</b> I 型和 II 型假设</a></li>
<li class="chapter" data-level="14.2" data-path="chap14.html"><a href="chap14.html#iii-型假设"><i class="fa fa-check"></i><b>14.2</b> III 型假设</a></li>
<li class="chapter" data-level="14.3" data-path="chap14.html"><a href="chap14.html#sec14-3"><i class="fa fa-check"></i><b>14.3</b> IV 型假设</a></li>
<li class="chapter" data-level="14.4" data-path="chap14.html"><a href="chap14.html#sec14-4"><i class="fa fa-check"></i><b>14.4</b> 总体边际均值和最小二乘均值</a></li>
<li class="chapter" data-level="14.5" data-path="chap14.html"><a href="chap14.html#sec14-5"><i class="fa fa-check"></i><b>14.5</b> 计算机分析</a></li>
<li class="chapter" data-level="14.6" data-path="chap14.html"><a href="chap14.html#sec14-6"><i class="fa fa-check"></i><b>14.6</b> 结束语</a></li>
<li class="chapter" data-level="14.7" data-path="chap14.html"><a href="chap14.html#sec14-7"><i class="fa fa-check"></i><b>14.7</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="chap15.html"><a href="chap15.html"><i class="fa fa-check"></i><b>15</b> 案例研究：缺失处理组合的双向处理结构</a>
<ul>
<li class="chapter" data-level="15.1" data-path="chap15.html"><a href="chap15.html#sec15-1"><i class="fa fa-check"></i><b>15.1</b> 案例研究</a></li>
<li class="chapter" data-level="15.2" data-path="chap15.html"><a href="chap15.html#sec15-2"><i class="fa fa-check"></i><b>15.2</b> 结束语</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="chap16.html"><a href="chap16.html"><i class="fa fa-check"></i><b>16</b> 分析三向和高阶处理结构</a>
<ul>
<li class="chapter" data-level="16.1" data-path="chap16.html"><a href="chap16.html#sec16-1"><i class="fa fa-check"></i><b>16.1</b> 一般策略</a></li>
<li class="chapter" data-level="16.2" data-path="chap16.html"><a href="chap16.html#sec16-2"><i class="fa fa-check"></i><b>16.2</b> 均衡和不均衡实验</a></li>
<li class="chapter" data-level="16.3" data-path="chap16.html"><a href="chap16.html#sec16-3"><i class="fa fa-check"></i><b>16.3</b> I 型和 II 型分析</a></li>
<li class="chapter" data-level="16.4" data-path="chap16.html"><a href="chap16.html#sec16-4"><i class="fa fa-check"></i><b>16.4</b> 结束语</a></li>
<li class="chapter" data-level="16.5" data-path="chap16.html"><a href="chap16.html#sec16-5"><i class="fa fa-check"></i><b>16.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="chap17.html"><a href="chap17.html"><i class="fa fa-check"></i><b>17</b> 案例研究：具有许多缺失处理组合的三向处理结构</a>
<ul>
<li class="chapter" data-level="17.1" data-path="chap17.html"><a href="chap17.html#sec17-1"><i class="fa fa-check"></i><b>17.1</b> 营养评分示例</a></li>
<li class="chapter" data-level="17.2" data-path="chap17.html"><a href="chap17.html#sec17-2"><i class="fa fa-check"></i><b>17.2</b> SAS-GLM 分析</a></li>
<li class="chapter" data-level="17.3" data-path="chap17.html"><a href="chap17.html#sec17-3"><i class="fa fa-check"></i><b>17.3</b> 一个完整的分析</a></li>
<li class="chapter" data-level="17.4" data-path="chap17.html"><a href="chap17.html#sec17-4"><i class="fa fa-check"></i><b>17.4</b> 结束语</a></li>
<li class="chapter" data-level="17.5" data-path="chap17.html"><a href="chap17.html#sec17-5"><i class="fa fa-check"></i><b>17.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="chap18.html"><a href="chap18.html"><i class="fa fa-check"></i><b>18</b> 随机效应模型和方差分量</a>
<ul>
<li class="chapter" data-level="18.1" data-path="chap18.html"><a href="chap18.html#sec18-1"><i class="fa fa-check"></i><b>18.1</b> 介绍</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="chap18.html"><a href="chap18.html#sec18-1-1"><i class="fa fa-check"></i><b>18.1.1</b> 示例 18.1：随机效应嵌套处理结构</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="chap18.html"><a href="chap18.html#sec18-2"><i class="fa fa-check"></i><b>18.2</b> 矩阵表示法中的一般随机效应模型</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="chap18.html"><a href="chap18.html#sec18-2-1"><i class="fa fa-check"></i><b>18.2.1</b> 示例 18.2：单向随机效应模型</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="chap18.html"><a href="chap18.html#sec18-3"><i class="fa fa-check"></i><b>18.3</b> 计算期望均方</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="chap18.html"><a href="chap18.html#sec18-3-1"><i class="fa fa-check"></i><b>18.3.1</b> 代数方法</a></li>
<li class="chapter" data-level="18.3.2" data-path="chap18.html"><a href="chap18.html#sec18-3-2"><i class="fa fa-check"></i><b>18.3.2</b> Hartley 综合法的计算</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="chap18.html"><a href="chap18.html#sec18-4"><i class="fa fa-check"></i><b>18.4</b> 结束语</a></li>
<li class="chapter" data-level="18.5" data-path="chap18.html"><a href="chap18.html#sec18-5"><i class="fa fa-check"></i><b>18.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="chap19.html"><a href="chap19.html"><i class="fa fa-check"></i><b>19</b> 方差分量的估计方法</a>
<ul>
<li class="chapter" data-level="19.1" data-path="chap19.html"><a href="chap19.html#sec19-1"><i class="fa fa-check"></i><b>19.1</b> 矩法</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="chap19.html"><a href="chap19.html#sec19-1-1"><i class="fa fa-check"></i><b>19.1.1</b> 应用。示例 19.1：不均衡单向模型</a></li>
<li class="chapter" data-level="19.1.2" data-path="chap19.html"><a href="chap19.html#sec19-1-2"><i class="fa fa-check"></i><b>19.1.2</b> 示例 19.2：单向随机效应模型中的小麦品种</a></li>
<li class="chapter" data-level="19.1.3" data-path="chap19.html"><a href="chap19.html#sec19-1-3"><i class="fa fa-check"></i><b>19.1.3</b> 示例 19.3：表 18.2 中的双向设计数据</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="chap19.html"><a href="chap19.html#sec19-2"><i class="fa fa-check"></i><b>19.2</b> 最大似然</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="chap19.html"><a href="chap19.html#sec19-2-1"><i class="fa fa-check"></i><b>19.2.1</b> 示例 19.4：均衡单向模型的最大似然解</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="chap19.html"><a href="chap19.html#sec19-3"><i class="fa fa-check"></i><b>19.3</b> 受限或残差最大似然估计</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="chap19.html"><a href="chap19.html#sec19-3-1"><i class="fa fa-check"></i><b>19.3.1</b> 示例 19.5：均衡单向模型的 REML 解</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="chap19.html"><a href="chap19.html#sec19-4"><i class="fa fa-check"></i><b>19.4</b> MIVQUE 法</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="chap19.html"><a href="chap19.html#sec19-4-1"><i class="fa fa-check"></i><b>19.4.1</b> 方法说明</a></li>
<li class="chapter" data-level="19.4.2" data-path="chap19.html"><a href="chap19.html#sec19-4-2"><i class="fa fa-check"></i><b>19.4.2</b> 应用。示例 19.6：MIVQUE 用于不均衡单向设计</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="chap19.html"><a href="chap19.html#sec19-5"><i class="fa fa-check"></i><b>19.5</b> 使用 JMP 估计方差分量</a></li>
<li class="chapter" data-level="19.6" data-path="chap19.html"><a href="chap19.html#sec19-6"><i class="fa fa-check"></i><b>19.6</b> 结束语</a></li>
<li class="chapter" data-level="19.7" data-path="chap19.html"><a href="chap19.html#sec19-7"><i class="fa fa-check"></i><b>19.7</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="chap20.html"><a href="chap20.html"><i class="fa fa-check"></i><b>20</b> 方差分量的推断方法</a>
<ul>
<li class="chapter" data-level="20.1" data-path="chap20.html"><a href="chap20.html#sec20-1"><i class="fa fa-check"></i><b>20.1</b> 假设检验</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="chap20.html"><a href="chap20.html#sec20-1-1"><i class="fa fa-check"></i><b>20.1.1</b> 使用方差分析表</a></li>
<li class="chapter" data-level="20.1.2" data-path="chap20.html"><a href="chap20.html#sec20-1-2"><i class="fa fa-check"></i><b>20.1.2</b> 示例 20.1：完全随机设计结构中的双向随机效应检验统计量</a></li>
<li class="chapter" data-level="20.1.3" data-path="chap20.html"><a href="chap20.html#sec20-1-3"><i class="fa fa-check"></i><b>20.1.3</b> 示例 20.2：复杂三向随机效应检验统计量</a></li>
<li class="chapter" data-level="20.1.4" data-path="chap20.html"><a href="chap20.html#sec20-1-4"><i class="fa fa-check"></i><b>20.1.4</b> 似然比检验</a></li>
<li class="chapter" data-level="20.1.5" data-path="chap20.html"><a href="chap20.html#sec20-1-5"><i class="fa fa-check"></i><b>20.1.5</b> 示例 20.3：小麦品种——单向随机效应模型</a></li>
<li class="chapter" data-level="20.1.6" data-path="chap20.html"><a href="chap20.html#sec20-1-6"><i class="fa fa-check"></i><b>20.1.6</b> 示例 20.4：不均衡双向</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="chap20.html"><a href="chap20.html#sec20-2"><i class="fa fa-check"></i><b>20.2</b> 构造置信区间</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="chap20.html"><a href="chap20.html#sec20-2-1"><i class="fa fa-check"></i><b>20.2.1</b> 残差方差 <span class="math inline">\(\sigma^2_\varepsilon\)</span></a></li>
<li class="chapter" data-level="20.2.2" data-path="chap20.html"><a href="chap20.html#sec20-2-2"><i class="fa fa-check"></i><b>20.2.2</b> 一般 Satterthwaite 近似</a></li>
<li class="chapter" data-level="20.2.3" data-path="chap20.html"><a href="chap20.html#sec20-2-3"><i class="fa fa-check"></i><b>20.2.3</b> 方差分量函数的近似置信区间</a></li>
<li class="chapter" data-level="20.2.4" data-path="chap20.html"><a href="chap20.html#sec20-2-4"><i class="fa fa-check"></i><b>20.2.4</b> 方差分量的 Wald 型置信区间</a></li>
<li class="chapter" data-level="20.2.5" data-path="chap20.html"><a href="chap20.html#sec20-2-5"><i class="fa fa-check"></i><b>20.2.5</b> 一些精确的置信区间</a></li>
<li class="chapter" data-level="20.2.6" data-path="chap20.html"><a href="chap20.html#sec20-2-6"><i class="fa fa-check"></i><b>20.2.6</b> 示例 20.5：均衡单向随机效应处理结构</a></li>
<li class="chapter" data-level="20.2.7" data-path="chap20.html"><a href="chap20.html#sec20-2-7"><i class="fa fa-check"></i><b>20.2.7</b> 示例 20.6</a></li>
<li class="chapter" data-level="20.2.8" data-path="chap20.html"><a href="chap20.html#sec20-2-8"><i class="fa fa-check"></i><b>20.2.8</b> 示例 20.6 （续）</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="chap20.html"><a href="chap20.html#sec20-3"><i class="fa fa-check"></i><b>20.3</b> 模拟研究</a></li>
<li class="chapter" data-level="20.4" data-path="chap20.html"><a href="chap20.html#sec20-4"><i class="fa fa-check"></i><b>20.4</b> 结束语</a></li>
<li class="chapter" data-level="20.5" data-path="chap20.html"><a href="chap20.html#sec20-5"><i class="fa fa-check"></i><b>20.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="chap21.html"><a href="chap21.html"><i class="fa fa-check"></i><b>21</b> 案例研究：随机效应模型分析</a>
<ul>
<li class="chapter" data-level="21.1" data-path="chap21.html"><a href="chap21.html#sec21-1"><i class="fa fa-check"></i><b>21.1</b> 数据集</a></li>
<li class="chapter" data-level="21.2" data-path="chap21.html"><a href="chap21.html#sec21-2"><i class="fa fa-check"></i><b>21.2</b> 估计</a></li>
<li class="chapter" data-level="21.3" data-path="chap21.html"><a href="chap21.html#sec21-3"><i class="fa fa-check"></i><b>21.3</b> 模型构建</a></li>
<li class="chapter" data-level="21.4" data-path="chap21.html"><a href="chap21.html#sec21-4"><i class="fa fa-check"></i><b>21.4</b> 缩减模型</a></li>
<li class="chapter" data-level="21.5" data-path="chap21.html"><a href="chap21.html#sec21-5"><i class="fa fa-check"></i><b>21.5</b> 置信区间</a></li>
<li class="chapter" data-level="21.6" data-path="chap21.html"><a href="chap21.html#sec21-6"><i class="fa fa-check"></i><b>21.6</b> 使用 JMP 进行计算</a></li>
<li class="chapter" data-level="21.7" data-path="chap21.html"><a href="chap21.html#sec21-7"><i class="fa fa-check"></i><b>21.7</b> 结束语</a></li>
<li class="chapter" data-level="21.8" data-path="chap21.html"><a href="chap21.html#sec21-8"><i class="fa fa-check"></i><b>21.8</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="chap22.html"><a href="chap22.html"><i class="fa fa-check"></i><b>22</b> 混合模型的分析</a>
<ul>
<li class="chapter" data-level="22.1" data-path="chap22.html"><a href="chap22.html#sec22-1"><i class="fa fa-check"></i><b>22.1</b> 混合模型简介</a></li>
<li class="chapter" data-level="22.2" data-path="chap22.html"><a href="chap22.html#sec22-2"><i class="fa fa-check"></i><b>22.2</b> 混合模型随机效应部分的分析</a>
<ul>
<li class="chapter" data-level="22.2.1" data-path="chap22.html"><a href="chap22.html#sec22-2-1"><i class="fa fa-check"></i><b>22.2.1</b> 矩法</a></li>
<li class="chapter" data-level="22.2.2" data-path="chap22.html"><a href="chap22.html#sec22-2-2"><i class="fa fa-check"></i><b>22.2.2</b> 最大似然方法</a></li>
<li class="chapter" data-level="22.2.3" data-path="chap22.html"><a href="chap22.html#sec22-2-3"><i class="fa fa-check"></i><b>22.2.3</b> 残差最大似然法</a></li>
<li class="chapter" data-level="22.2.4" data-path="chap22.html"><a href="chap22.html#sec22-2-4"><i class="fa fa-check"></i><b>22.2.4</b> MINQUE 法</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="chap22.html"><a href="chap22.html#sec22-3"><i class="fa fa-check"></i><b>22.3</b> 混合模型固定效应部分的分析</a>
<ul>
<li class="chapter" data-level="22.3.1" data-path="chap22.html"><a href="chap22.html#sec22-3-1"><i class="fa fa-check"></i><b>22.3.1</b> 估计</a></li>
<li class="chapter" data-level="22.3.2" data-path="chap22.html"><a href="chap22.html#sec22-3-2"><i class="fa fa-check"></i><b>22.3.2</b> 置信区间的构建</a></li>
<li class="chapter" data-level="22.3.3" data-path="chap22.html"><a href="chap22.html#sec22-3-3"><i class="fa fa-check"></i><b>22.3.3</b> 假设检验</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="chap22.html"><a href="chap22.html#sec22-4"><i class="fa fa-check"></i><b>22.4</b> 最佳线性无偏预测</a></li>
<li class="chapter" data-level="22.5" data-path="chap22.html"><a href="chap22.html#sec22-5"><i class="fa fa-check"></i><b>22.5</b> 混合模型方程组</a></li>
<li class="chapter" data-level="22.6" data-path="chap22.html"><a href="chap22.html#sec22-6"><i class="fa fa-check"></i><b>22.6</b> 结束语</a></li>
<li class="chapter" data-level="22.7" data-path="chap22.html"><a href="chap22.html#sec22-7"><i class="fa fa-check"></i><b>22.7</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="chap23.html"><a href="chap23.html"><i class="fa fa-check"></i><b>23</b> 案例研究：混合模型</a>
<ul>
<li class="chapter" data-level="23.1" data-path="chap23.html"><a href="chap23.html#sec23-1"><i class="fa fa-check"></i><b>23.1</b> 双向混合模型</a></li>
<li class="chapter" data-level="23.2" data-path="chap23.html"><a href="chap23.html#sed23-2"><i class="fa fa-check"></i><b>23.2</b> 不均衡双向混合模型</a></li>
<li class="chapter" data-level="23.3" data-path="chap23.html"><a href="chap23.html#sec23-3"><i class="fa fa-check"></i><b>23.3</b> 不均衡双向数据集的 JMP 分析</a></li>
<li class="chapter" data-level="23.4" data-path="chap23.html"><a href="chap23.html#sec23-4"><i class="fa fa-check"></i><b>23.4</b> 结束语</a></li>
<li class="chapter" data-level="23.5" data-path="chap23.html"><a href="chap23.html#sec23-5"><i class="fa fa-check"></i><b>23.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="chap24.html"><a href="chap24.html"><i class="fa fa-check"></i><b>24</b> 分析裂区型设计的方法</a>
<ul>
<li class="chapter" data-level="24.1" data-path="chap24.html"><a href="chap24.html#sec24-1"><i class="fa fa-check"></i><b>24.1</b> 介绍</a>
<ul>
<li class="chapter" data-level="24.1.1" data-path="chap24.html"><a href="chap24.html#sec24-1-1"><i class="fa fa-check"></i><b>24.1.1</b> 示例 24.1：面包配方和烘焙温度</a></li>
<li class="chapter" data-level="24.1.2" data-path="chap24.html"><a href="chap24.html#sec24-1-2"><i class="fa fa-check"></i><b>24.1.2</b> 示例 24.2：在不同肥力条件下生长的小麦品种</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="chap24.html"><a href="chap24.html#sec24-2"><i class="fa fa-check"></i><b>24.2</b> 模型定义和参数估计</a></li>
<li class="chapter" data-level="24.3" data-path="chap24.html"><a href="chap24.html#sec24-3"><i class="fa fa-check"></i><b>24.3</b> 均值间比较的标准误</a></li>
<li class="chapter" data-level="24.4" data-path="chap24.html"><a href="chap24.html#sec24-4"><i class="fa fa-check"></i><b>24.4</b> 计算均值差标准误的一般方法</a>
<ul>
<li class="chapter" data-level="24.4.1" data-path="chap24.html"><a href="chap24.html#sec24-5"><i class="fa fa-check"></i><b>24.4.1</b> 通过一般对比进行比较</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="chap24.html"><a href="chap24.html#sec24-6"><i class="fa fa-check"></i><b>24.5</b> 其他示例</a>
<ul>
<li class="chapter" data-level="24.5.1" data-path="chap24.html"><a href="chap24.html#sec24-6-1"><i class="fa fa-check"></i><b>24.5.1</b> 示例 24.3：水分和肥料</a></li>
<li class="chapter" data-level="24.5.2" data-path="chap24.html"><a href="chap24.html#sec24-6-2"><i class="fa fa-check"></i><b>24.5.2</b> 示例 24.4：具有裂区误差的回归</a></li>
<li class="chapter" data-level="24.5.3" data-path="chap24.html"><a href="chap24.html#sec24-6-3"><i class="fa fa-check"></i><b>24.5.3</b> 示例 24.5：混乱的裂区设计</a></li>
<li class="chapter" data-level="24.5.4" data-path="chap24.html"><a href="chap24.html#sec24-6-4"><i class="fa fa-check"></i><b>24.5.4</b> 示例 24.6：裂-裂区设计</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="chap24.html"><a href="chap24.html#sec24-7"><i class="fa fa-check"></i><b>24.6</b> 样本量和功效考虑</a></li>
<li class="chapter" data-level="24.7" data-path="chap24.html"><a href="chap24.html#sec24-8"><i class="fa fa-check"></i><b>24.7</b> 使用 JMP 进行计算：示例 24.7</a></li>
<li class="chapter" data-level="24.8" data-path="chap24.html"><a href="chap24.html#sec24-9"><i class="fa fa-check"></i><b>24.8</b> 结束语</a></li>
<li class="chapter" data-level="24.9" data-path="chap24.html"><a href="chap24.html#sec24-10"><i class="fa fa-check"></i><b>24.9</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="chap25.html"><a href="chap25.html"><i class="fa fa-check"></i><b>25</b> 分析条区型设计的方法</a>
<ul>
<li class="chapter" data-level="25.1" data-path="chap25.html"><a href="chap25.html#sec25-1"><i class="fa fa-check"></i><b>25.1</b> 条区设计和模型的描述</a></li>
<li class="chapter" data-level="25.2" data-path="chap25.html"><a href="chap25.html#sec25-2"><i class="fa fa-check"></i><b>25.2</b> 推断技术</a></li>
<li class="chapter" data-level="25.3" data-path="chap25.html"><a href="chap25.html#sec25-3"><i class="fa fa-check"></i><b>25.3</b> 示例：氮与灌溉</a></li>
<li class="chapter" data-level="25.4" data-path="chap25.html"><a href="chap25.html#sec25-4"><i class="fa fa-check"></i><b>25.4</b> 示例：含裂区的条区 1</a></li>
<li class="chapter" data-level="25.5" data-path="chap25.html"><a href="chap25.html#sec25-5"><i class="fa fa-check"></i><b>25.5</b> 示例：含裂区的条区 2</a></li>
<li class="chapter" data-level="25.6" data-path="chap25.html"><a href="chap25.html#sec25-6"><i class="fa fa-check"></i><b>25.6</b> 示例：含裂区的条区 3</a></li>
<li class="chapter" data-level="25.7" data-path="chap25.html"><a href="chap25.html#sec25-7"><i class="fa fa-check"></i><b>25.7</b> 示例：含裂区的条区 4</a></li>
<li class="chapter" data-level="25.8" data-path="chap25.html"><a href="chap25.html#sec25-8"><i class="fa fa-check"></i><b>25.8</b> 条-条区的设计与分析：基于 JMP7</a></li>
<li class="chapter" data-level="25.9" data-path="chap25.html"><a href="chap25.html#sec25-9"><i class="fa fa-check"></i><b>25.9</b> 结束语</a></li>
<li class="chapter" data-level="25.10" data-path="chap25.html"><a href="chap25.html#sec25-10"><i class="fa fa-check"></i><b>25.10</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="chap26.html"><a href="chap26.html"><i class="fa fa-check"></i><b>26</b> 分析重复测量实验的方法</a>
<ul>
<li class="chapter" data-level="26.1" data-path="chap26.html"><a href="chap26.html#sec26-1"><i class="fa fa-check"></i><b>26.1</b> 模型指定和理想条件</a></li>
<li class="chapter" data-level="26.2" data-path="chap26.html"><a href="chap26.html#sec26-2"><i class="fa fa-check"></i><b>26.2</b> 时间的裂区分析</a>
<ul>
<li class="chapter" data-level="26.2.1" data-path="chap26.html"><a href="chap26.html#sec26-2-1"><i class="fa fa-check"></i><b>26.2.1</b> 示例 26.1：药物对心率的影响</a></li>
<li class="chapter" data-level="26.2.2" data-path="chap26.html"><a href="chap26.html#sec26-2-2"><i class="fa fa-check"></i><b>26.2.2</b> 示例 26.2：一个复杂的舒适度实验</a></li>
<li class="chapter" data-level="26.2.3" data-path="chap26.html"><a href="chap26.html#sec26-2-3"><i class="fa fa-check"></i><b>26.2.3</b> 示例 26.3：家庭态度</a></li>
</ul></li>
<li class="chapter" data-level="26.3" data-path="chap26.html"><a href="chap26.html#sec26-3"><i class="fa fa-check"></i><b>26.3</b> 使用 SAS-Mixed 程序的数据分析</a>
<ul>
<li class="chapter" data-level="26.3.1" data-path="chap26.html"><a href="chap26.html#sec26-3-1"><i class="fa fa-check"></i><b>26.3.1</b> 示例 26.1</a></li>
<li class="chapter" data-level="26.3.2" data-path="chap26.html"><a href="chap26.html#sec26-3-2"><i class="fa fa-check"></i><b>26.3.2</b> 示例 26.2</a></li>
<li class="chapter" data-level="26.3.3" data-path="chap26.html"><a href="chap26.html#sec26-3-3"><i class="fa fa-check"></i><b>26.3.3</b> 示例 26.3</a></li>
</ul></li>
<li class="chapter" data-level="26.4" data-path="chap26.html"><a href="chap26.html#sec26-4"><i class="fa fa-check"></i><b>26.4</b> 结束语</a></li>
<li class="chapter" data-level="26.5" data-path="chap26.html"><a href="chap26.html#sec26-5"><i class="fa fa-check"></i><b>26.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="chap29.html"><a href="chap29.html"><i class="fa fa-check"></i><b>27</b> 交叉设计的分析</a>
<ul>
<li class="chapter" data-level="27.1" data-path="chap29.html"><a href="chap29.html#sec29-1"><i class="fa fa-check"></i><b>27.1</b> 定义，假设和模型</a></li>
<li class="chapter" data-level="27.2" data-path="chap29.html"><a href="chap29.html#sec29-2"><i class="fa fa-check"></i><b>27.2</b> 两时期/两处理交叉设计</a></li>
<li class="chapter" data-level="27.3" data-path="chap29.html"><a href="chap29.html#sec29-3"><i class="fa fa-check"></i><b>27.3</b> 具有两个以上时期的交叉设计</a></li>
<li class="chapter" data-level="27.4" data-path="chap29.html"><a href="chap29.html#sec29-4"><i class="fa fa-check"></i><b>27.4</b> 具有两种以上处理的交叉设计</a></li>
<li class="chapter" data-level="27.5" data-path="chap29.html"><a href="chap29.html#sec29-5"><i class="fa fa-check"></i><b>27.5</b> 小结</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">混乱数据分析：设计的实验</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap18" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">第 18 章</span> 随机效应模型和方差分量<a href="chap18.html#chap18" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<blockquote>
<p>“Maturity is the capacity to endure uncertainty.” - John Finley</p>
</blockquote>
<p>具有多个<strong>随机分量</strong> (random component) 的模型适用于多种情况，包括随机效应和混合效应模型，其中处理结构中的部分或全部因子是随机的，或者如裂区和重复测量设计那样有多种尺寸的实验单元。对于此类模型，感兴趣的参数包括与随机分量的分布相关的方差（通常称为<strong>方差分量</strong>, variance components）。重要的是能够识别模型的随机分量，并能够在模型分析中使用它们。当对给定模型进行方差分析时，需要均方的期望值（均方是方差分量的函数），以构造适当的检验统计量，并确定用于比较固定效应参数的标准误。还需要能够获得方差分量的估计，并检验假设和构造方差分的函数的置信区间。随机效应模型及其分析方法的讨论分为四章。本章定义了随机效应模型，并描述了一种计算平方和期望的一般程序。该程序可以很容易地利用计算机软件评估平方和的期望值。估计问题在第 <a href="chap19.html#chap19">19</a> 章中讨论，检验假设和构造置信区间的方法在第 <a href="chap20.html#chap20">20</a> 章中介绍，第 <a href="chap21.html#chap21">21</a> 章提供了一个详细的示例分析。</p>
<div id="sec18-1" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> 介绍<a href="chap18.html#sec18-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在抽样方案和感兴趣的参数中，使用随机效应模型背后的哲学与使用固定效应模型（在前几章中讨论的）背后的哲学截然不同。在讨论这些差异之前，先给出随机效应和固定效应的定义。</p>
<div class="definition">
<p><span id="def:18-1" class="definition"><strong>定义 18.1  </strong></span>♦</p>
<p>如果一个因子的水平由可能水平总体中的随机样本组成，则该因子是一个<strong>随机效应因子</strong> (random effect factor).</p>
</div>
<div class="definition">
<p><span id="def:18-2" class="definition"><strong>定义 18.2  </strong></span>♦</p>
<p>如果一个因子的水平是通过非随机过程选择的，或者如果它的水平由可能水平的整个总体组成，那么它就是一个<strong>固定效应因子</strong> (fixed effect factor).</p>
</div>
<p>因此，为了确定一个因子是固定效应还是随机效应，我们需要知道实验者是如何选择该因子的水平的。如果实验中包括了该因子所有可能水平或一组选定的因子水平，则该因子被视为混合效应。如果使用某种形式的随机化来选择实验中包括的水平，那么该因子就是随机效应。</p>
<div class="rmdnote">
<p><strong>规则</strong>：因子的水平在被证明为随机之前都是固定的。</p>
</div>
<p>为了确定一个因子的水平是随机的，必须描述可能水平的总体或概念总体，并且必须指定随机选择该因子水平的方法。要对水平总体进行推断，因此如果无法描述该总体，则推断可能没有意义。</p>
<p>例如，假设一个植物育种学家想要研究小麦品种的某个特性（比如说产量）。存在许多可能的小麦品种（品种的总体），但是如果他想要研究某一组特定的品种，那么他就会选择这些品种进行实验。在这种情况下，因子 “品种” 被称为固定效应，因为品种的水平是选定的 (chosen) 或固定的 (fixed). 然而，如果植物育种学家感兴趣的是特性在总体中的品种之间是如何分布的，那么他就对哪些品种包含在实验中不感兴趣。在这种情况下，植物育种学家可以从品种的总体中随机选择包含在实验中的品种。因此在第二个实验中，因子品种是一个随机效应。在构造模型来描述给定的实验情况时，必须指出一个因子是随机效应还是固定效应。前几章所考虑的模型是在假设处理结构中的所有因子都是固定效应，并且实验单元只有一个尺寸的假设下构造的。然而，在第四章引入区组时，已经暗示了随机效应的概念，其中假设因子 “区组” 是一个随机效应。此外，一个基本假设是，与模型的设计结构相关的那些因子是随机效应。一些因子既有一组固定效应水平，也有一组随机效应水平 (Njuho and Milliken, 2005)，但这里没有详细阐述这一主题。根据设计结构中实验单元的尺寸和对处理结构中因子的假设，可以构造三种基本类型的模型。这些类型的模型定义如下。</p>
<div class="definition">
<p><span id="def:18-3" class="definition"><strong>定义 18.3  </strong></span>♦</p>
<p>如果处理结构中的所有因子都是固定效应，并且研究中只有一个尺寸的实验单元，没有区组，并且方差都相等，则该模型称为固定 (fixed) 或<strong>固定效应</strong> (fixed effects) 模型。</p>
</div>
<div class="definition">
<p><span id="def:18-4" class="definition"><strong>定义 18.4  </strong></span>♦</p>
<p>如果处理结构中的所有因子都是随机效应（设计结构中的全部因子已经被假设为随机效应），则该模型称为随机 (random) 或<strong>随机效应</strong> (random effects) 模型。</p>
</div>
<div class="definition">
<p><span id="def:18-5" class="definition"><strong>定义 18.5  </strong></span>♦</p>
<p>如果处理结构中的一些因子是固定效应，一些因子是随机效应，或者处理结构中所有因子都是固定效应并且设计结构中有多种尺寸的实验单元（或者模型中至少有两个方差分量），则该模型称为混合 (mixed) 或<strong>混合效应</strong> (mixed effects) 模型。</p>
</div>
<p>本章讨论的模型都是随机效应模型。第 <a href="chap22.html#chap22">22</a> 章和第 <a href="chap23.html#chap23">23</a> 章介绍了对混合模型的讨论。下面的例子有助于激发随机效应模型的应用和分析。</p>
<div id="sec18-1-1" class="section level3 hasAnchor" number="18.1.1">
<h3><span class="header-section-number">18.1.1</span> 示例 18.1：随机效应嵌套处理结构<a href="chap18.html#sec18-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>一个消费者团体研究了美国至少拥有 20,000 人口的城市中咖啡价格的变异。该团体希望调查的三个因子是州 (state)、州内的城市 (sity) 以及州内城市内的商店 (store). 处理结构或抽样设计是一个涉及州、城市和商店的三向两水平的嵌套系统，其中城市嵌套在州内，商店嵌套在城市内。抽样程序是从所有可能的州中随机选择 <span class="math inline">\(r\)</span> 个州（<span class="math inline">\(r &lt; 50\)</span>）。接下来，从第 <span class="math inline">\(i\)</span> 个州中的 <span class="math inline">\(C_i\)</span> 个城市中随机选择 <span class="math inline">\(t_i\)</span> 个城市（<span class="math inline">\(t_i &lt; C_i\)</span>），这些城市的人口至少为 20,000. 最后，从第 <span class="math inline">\(i\)</span> 个州中的第 <span class="math inline">\(j\)</span> 个城市的 <span class="math inline">\(S_{ij}\)</span> 家商店中随机选择 <span class="math inline">\(n_{ij}\)</span> 家商店（<span class="math inline">\(n_{ij} &lt; S_{ij}\)</span>），并确定每家随机选择的商店中特定等级的咖啡价格。可以用来描述咖啡价格变异的模型是</p>
<p><span class="math display">\[y_{ijk}=\mu+s_i+c_{j(i)}+a_{k(ij)}\quad i=1,2,\ldots,r,j=1,2,\ldots,t_i,\quad k=1,2,\ldots,n_{ij}\]</span></p>
<p>其中 <span class="math inline">\(\mu\)</span> 表示美国咖啡的平均价格，<span class="math inline">\(s_i\)</span> 表示第 <span class="math inline">\(i\)</span> 个随机选择的州的效应，<span class="math inline">\(c_{j(i)}\)</span> 表示第 <span class="math inline">\(i\)</span> 个州中第 <span class="math inline">\(j\)</span> 个随机选择的城市的效应，<span class="math inline">\(a_{k(ij)}\)</span> 表示从第 <span class="math inline">\(i\)</span> 个州中的第 <span class="math inline">\(j\)</span> 个城市随机选择的第 <span class="math inline">\(k\)</span> 家商店的效应。假设</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(s_i\sim i.i.d.\,N(0,\sigma_{\mathrm{State}}^2)\)</span></li>
<li><span class="math inline">\(c_{j(i)}\sim i.i.d.\,N(0,\sigma_{\mathrm{City}}^2)\)</span></li>
<li><span class="math inline">\(a_{k(ij)}\sim i.i.d.\,N(0,\sigma_{\mathrm{Store}}^2)\)</span></li>
</ol>
<p>还假设所有随机效应都是彼此独立分布的。该随机效应模型中的参数为 <span class="math inline">\(\mu,\sigma_{\mathrm{State}}^2,\sigma_{\mathrm{City}}^2,\sigma_{\mathrm{Store}}^2\)</span>. <strong>项 <span class="math inline">\(s_i,c_{j(i)},a_{k(ij)}\)</span> 是随机变量，不是模型中的参数</strong>。大多数应用只对参数估计感兴趣，对预测随机变量的值不感兴趣。但是，当对随机变量的预测感兴趣时，可以获得随机效应的<strong>最佳线性无偏预测估计</strong> (estimated best linear unbiased predictors, <strong>EBLUP</strong>) (Littell et al., 2006; Milliken and Johnson, 2002).</p>
<p>咖啡价格的方差可以通过模型参数表示为</p>
<p><span class="math display">\[\mathrm{Var}(y_{ijk})=\sigma_{\mathrm{Price}}^2=\sigma_{\mathrm{State}}^2+\sigma_{\mathrm{City}}^2+\sigma_{\mathrm{Store}}^2\]</span></p>
<p>同一城市（和州）内商店的两种咖啡价格之间的协方差为</p>
<p><span class="math display">\[\mathrm{Cov}(y_{ij1},~y_{ij2})=\sigma_{y_{ij1}y_{ij2}}=\sigma_{\mathrm{State}}^2+\sigma_{\mathrm{City}}^2\]</span></p>
<p>这两个价格之间的相关性为</p>
<p><span class="math display">\[\rho_{y_{ij1}y_{ij2}}=\frac{\sigma_{\mathrm{State}}^2+\sigma_{\mathrm{City}}^2}{\sigma_{\mathrm{State}}^2+\sigma_{\mathrm{City}}^2+\sigma_{\mathrm{Store}}^2}\]</span></p>
<p>州内不同城市商店的两种咖啡价格之间的协方差为 <span class="math inline">\(\mathrm{Cov}(y_{i11},y_{i22})=\sigma_{y_{i11}y_{i22}}=\sigma_{\mathrm{State}}^2\)</span>. 同一州内两个不同城市的两个价格之间的相关性为</p>
<p><span class="math display">\[\rho_{y_{i11}y_{i22}}=\frac{\sigma_{\mathrm{State}}^2}{\sigma_{\mathrm{State}}^2+\sigma_{\mathrm{City}}^2+\sigma_{\mathrm{Store}}^2}\]</span></p>
<p>因此，当模型包含随机效应时，会在结果数据上施加与咖啡价格相似的<strong>相关结构</strong> (correlation structure). 能够构造模型并识别各种观测分组之间的变异来源以及相关性是有意义的。以下示例用于演示构造一个或多个随机效应的模型，并评估数据集中观测结果之间的隐含协方差或相关结构。</p>
</div>
</div>
<div id="sec18-2" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> 矩阵表示法中的一般随机效应模型<a href="chap18.html#sec18-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>为了描述用于评估平方和期望的方法，有必要使用一些通用符号来描述<strong>一般随机效应模型</strong> (general random effects model). 本节介绍一般随机效应模型的矩阵表示，后面的部分将使用该模型来演示计算期望均方的一般方法。为了帮助可视化一般随机效应模型及其在矩阵方面的表达，我们研究了完全随机设计结构中单向处理结构的随机效应模型。</p>
<div id="sec18-2-1" class="section level3 hasAnchor" number="18.2.1">
<h3><span class="header-section-number">18.2.1</span> 示例 18.2：单向随机效应模型<a href="chap18.html#sec18-2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>描述完全随机设计结构中的单向随机效应处理结构的模型是</p>
<p><span class="math display" id="eq:18-1">\[\begin{equation}
y_{ij}={\mu}+{u}_i+{\varepsilon}_{ij},\quad i=1,2,\ldots,t,j=1,2,\ldots,n_i
\tag{18.1}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(\mu\)</span> 是响应的总体平均值，<span class="math inline">\(\mu_i\)</span> 表示第 <span class="math inline">\(i\)</span> 个随机选择的处理的效应，并假设其分布为 <span class="math inline">\(i.i.d.\,N(0, \sigma^2_u)\)</span>，<span class="math inline">\(\varepsilon_{ij}\)</span> 表示第 <span class="math inline">\(i\)</span> 个处理的第 <span class="math inline">\(j\)</span> 个观测值的随机误差，并假设其分布为 <span class="math inline">\(i.i.d.\,N(0, \sigma^2_\varepsilon)\)</span>. 还假设 <span class="math inline">\(\mu_i\)</span> 和 <span class="math inline">\(\varepsilon_{ij}\)</span> 是独立的随机变量。这些假设允许评估观测值的方差和协方差。观测值的方差是</p>
<p><span class="math display">\[\begin{aligned}
\operatorname{Var}(y_{ij})&amp; ={\sigma}_y^2=\mathrm{Var}({\mu}+{\mu}_i+{\varepsilon}_{ij}){=}\mathrm{Var}({u}_i)+\mathrm{Var}({\varepsilon}_{ij})  \\
&amp;=\sigma_u^2+\sigma_\varepsilon^2
\end{aligned}\]</span></p>
<p><span class="math inline">\(y_{ij}\)</span> 的方差有两个分量，包括处理总体的方差或 <span class="math inline">\(u\)</span> 水平的方差和实验单元的方差，因此称为<strong>方差分量</strong> (variance components or components of variance). 从 <span class="math inline">\(u_i\)</span> 的相同可能性获得的两个观测值的协方差为</p>
<p><span class="math display">\[\begin{aligned}\mathrm{Cov}(y_{ij},y_{ij^{\prime}})&amp;=\mathrm{Cov}(\mu+u_i+\varepsilon_{ij},\mu+u_i+\varepsilon_{ij^{\prime}})\\&amp;=\mathrm{Cov}(u_i,u_i)=\mathrm{Var}(u_i)=\sigma_u^2\end{aligned}\]</span></p>
<p>从不同 <span class="math inline">\(i\)</span> 值获得的两个观测值之间的协方差为零。因此，从相同 <span class="math inline">\(i\)</span> 获得的观测值是相关的，这种相关性称为<strong>组内相关性</strong> (intraclass correlation)，定义为</p>
<p><span class="math display">\[\rho=\frac{\mathrm{Cov}(y_{ij},y_{ij},)}{\sqrt{\mathrm{Var}(y_{ij})\mathrm{Var}(y_{ij},)}}=\frac{\sigma_u^2}{\sigma_u^2+\sigma_\varepsilon^2}\]</span></p>
<p>不同 <span class="math inline">\(i\)</span> 值的观测结果是不相关的。方程 <a href="chap18.html#eq:18-1">(18.1)</a> 中的模型可以用矩阵表示法描述为</p>
<p><span class="math display" id="eq:18-2">\[\begin{equation}
\boldsymbol y=\boldsymbol j \mu+\boldsymbol Z_1 \boldsymbol u+\boldsymbol \varepsilon
\tag{18.2}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(\boldsymbol j\)</span> 是 N × 1 全一向量（<span class="math inline">\(N=\sum_{i=1}^tn_i\)</span>），<span class="math inline">\(\boldsymbol Z_1\)</span> 是 N × t 设计矩阵，<span class="math inline">\(\boldsymbol u\)</span> 是假定服从多元正态分布 <span class="math inline">\(N_t(\boldsymbol 0,\sigma^2_u\boldsymbol I_t)\)</span> 的 t × 1 随机向量变量，且 <span class="math inline">\(\boldsymbol \varepsilon\)</span> 是假定服从多元正态分布 <span class="math inline">\(N_N(\boldsymbol 0,\sigma^2_\varepsilon\boldsymbol I_t)\)</span> 的 N × 1 随机向量变量。观测值向量 <span class="math inline">\(\boldsymbol y\)</span> 的协方差阵为</p>
<p><span class="math display">\[\begin{aligned}
\boldsymbol\Sigma&amp; =\mathrm{Var}(\boldsymbol{y})=\mathrm{Var}(\boldsymbol{j} \mu+\boldsymbol{Z}_1\boldsymbol{u}+\boldsymbol{\varepsilon})  \\
&amp;=\boldsymbol{Z}_1\operatorname{Var}(\boldsymbol{u})\boldsymbol{Z}_1^{\prime}+\operatorname{Var}(\boldsymbol{\varepsilon}) \\
&amp;=\sigma_u^2\boldsymbol{Z}_1\boldsymbol{Z}_1^{\prime}+\boldsymbol{\sigma}_\boldsymbol{\varepsilon}^2\boldsymbol{I}_N
\end{aligned}\]</span></p>
<p><span class="math inline">\(y_{ij}\)</span> 的方差是 <span class="math inline">\(\boldsymbol\Sigma\)</span> 的对角元，<span class="math inline">\(y_{ij}\)</span> 对子之间的协方差是 <span class="math inline">\(\boldsymbol\Sigma\)</span> 的非对角元。</p>
<p>等价地，模型可以写为</p>
<p><span class="math display">\[
\begin{bmatrix}y_{11}\\y_{12}\\\vdots\\y_{1n_1}\\y_{21}\\y_{22}\\\vdots\\y_{2n_2}\\\vdots\\y_{t1}\\y_{t2}\\\vdots\\y_{tn_t}\end{bmatrix}=
\begin{bmatrix}1\\1\\\vdots\\1\\1\\1\\\vdots\\1\\\vdots\\1\\1\\\vdots\\1\end{bmatrix}\mu+
\begin{bmatrix}
1&amp;0&amp;\cdots&amp;0\\
1&amp;0&amp;\cdots&amp;0\\
\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\
1&amp;0&amp;\cdots&amp;0\\
0&amp;1&amp;\cdots&amp;0\\
0&amp;1&amp;\cdots&amp;0\\
\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\
0&amp;1&amp;\cdots&amp;0\\
\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\
0&amp;0&amp;\cdots&amp;1\\
0&amp;0&amp;\cdots&amp;1\\
\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\
0&amp;0&amp;\cdots&amp;1\\\end{bmatrix}\begin{bmatrix} \mu_1\\\mu_2\\\vdots\\\mu_t\end{bmatrix}+
\begin{bmatrix}\varepsilon_{11}\\\varepsilon_{12}\\\vdots\\\varepsilon_{1n_1}\\\varepsilon_{21}\\\varepsilon_{22}\\\vdots\\\varepsilon_{2n_2}\\\vdots\\\varepsilon_{t1}\\\varepsilon_{t2}\\\vdots\\\varepsilon_{tn_t}\end{bmatrix}
\]</span></p>
<p>一般随机效应模型将具有 <span class="math inline">\(r\)</span> 个随机分量，代表了处理结构中随机效应因子的主效应和交互作用，同时也代表了用于描述设计结构的因子以及设计与处理结构分量之间可能存在的交互作用，此交互作用用于描述必要误差项<a href="#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a>。一般随机效应模型包括由 <span class="math inline">\(\mu\)</span> 表示的总体均值参数以及由向量 <span class="math inline">\(\boldsymbol \varepsilon\)</span> 表示的残差或最小尺寸实验单元的误差。一般随机效应模型可以用矩阵表示为</p>
<p><span class="math display" id="eq:18-3">\[\begin{equation}
\boldsymbol y=\boldsymbol j \mu+\boldsymbol Z_1\boldsymbol u_1+\boldsymbol Z_2\boldsymbol u_2+\cdots+\boldsymbol Z_r\boldsymbol u_r+\boldsymbol\varepsilon
\tag{18.3}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(\boldsymbol \mu_s(s=1,2,\cdots,r)\)</span> 表示随机效应以及 <span class="math inline">\(\boldsymbol\varepsilon\)</span> 表示残差，其中假设所有这些随机变量独立分布，且假设它们的边际分布为</p>
<p><span class="math display">\[\boldsymbol u_1\thicksim N(0,\sigma_1^2\boldsymbol I_{t_1}),\quad \boldsymbol u_2\thicksim N(0,\sigma_2^2\boldsymbol I_{t_2}),\ldots,\quad \boldsymbol u_r\thicksim N(0,\sigma_r^2\boldsymbol I_{t_r}),\quad\mathrm{and}\quad\boldsymbol\varepsilon\thicksim N(0,\sigma_\varepsilon^2\boldsymbol I_N)\]</span></p>
<p><span class="math inline">\(N\)</span> 为数据向量 <span class="math inline">\(\boldsymbol y\)</span> 中的观测总数，<span class="math inline">\(\boldsymbol Z_i\)</span> 为对应于第 <span class="math inline">\(i\)</span> 个随机效应向量的 <span class="math inline">\(N × t_i\)</span> 设计矩阵。这种一般随机效应模型可以表示为</p>
<p><span class="math display">\[\begin{aligned}&amp;\boldsymbol{y}=\boldsymbol{j}_{\Tiny N} \mu+\boldsymbol{Z}\boldsymbol{u}+\boldsymbol{\varepsilon}\quad\mathrm{where~}\boldsymbol{Z}=\boldsymbol{[Z}_1,\boldsymbol{Z}_2,\ldots,\boldsymbol{Z}_r],\\\\&amp;\boldsymbol{u}=\begin{bmatrix}\boldsymbol{u}_1\\\boldsymbol{u}_2\\\vdots\\\boldsymbol{u}_r\end{bmatrix}\mathrm{~and~}\quad\mathrm{Var}(\boldsymbol{u})=\begin{bmatrix}{\sigma}_1^2\boldsymbol{I}_{t_1}&amp;0&amp;0&amp;0\\0&amp;{\sigma}_2^2\boldsymbol{I}_{t_2}&amp;0&amp;0\\0&amp;0&amp;\ddots&amp;0\\0&amp;0&amp;0&amp;{\sigma}_r^2\boldsymbol{I}_{t_r}\end{bmatrix}\end{aligned}\]</span></p>
<p>因此</p>
<p><span class="math display">\[\operatorname{Var}(\boldsymbol y)=\boldsymbol Z^{\prime}\operatorname{Var}(\boldsymbol u)\boldsymbol Z+\sigma_\varepsilon^2\boldsymbol I_N\]</span></p>
<p>数据向量 <span class="math inline">\(\boldsymbol y\)</span> 的协方差阵为</p>
<p><span class="math display">\[\begin{aligned}
\boldsymbol \Sigma&amp; =\operatorname{Var}(\boldsymbol y)=\operatorname{Var}(\boldsymbol j \mu+\boldsymbol Z_1\boldsymbol u_1+\boldsymbol Z_2\boldsymbol u_2+\cdots+\boldsymbol Z_r\boldsymbol u_r+\boldsymbol\varepsilon)  \\
&amp;=\boldsymbol{Z}_1\mathrm{Var}(\boldsymbol{u}_1)\boldsymbol{Z}_1^{\prime}+\boldsymbol{Z}_2\mathrm{Var}(\boldsymbol{u}_2)\boldsymbol{Z}_2^{\prime}+\cdots+\boldsymbol{Z}_r\mathrm{Var}(\boldsymbol{u}_r)\boldsymbol{Z}_r^{\prime}+\mathrm{Var}(\boldsymbol{\varepsilon}) \\
&amp;=\sigma_1^2\boldsymbol{Z}_1\boldsymbol{Z}_1^{\prime}+\sigma_2^2\boldsymbol{Z}_2\boldsymbol{Z}_2^{\prime}+\cdots+\sigma_r^2\boldsymbol{Z}_r\boldsymbol{Z}_r^{\prime}+\sigma_\varepsilon^2\boldsymbol{I}_N
\end{aligned}\]</span></p>
<p>这种一般形式的随机效应模型可以在许多情况下使用，以帮助识别数据收集系统中的变异源。分析这些变异来源的一种方法是计算一组与每个随机效应对应的平方和，然后确定每个平方和估计的参数函数。通过获取效应平方和的期望值，可以评估由每个效应平方和所估计的方差分量函数。接下来的章节将使用这种矩阵形式的一般随机效应模型来描述涉及观测值的平方和期望值的评估方法。</p>
</div>
</div>
<div id="sec18-3" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> 计算期望均方<a href="chap18.html#sec18-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在对随机效应模型进行方差分析时，平方和的期望值涉及到方差分量。对于给定的模型，至少有两种方法可用于评估期望均方（记住，均方是一个平方和除以其自由度）。第一种方法是利用模型假设代数地求解期望值，第二种方法是通过计算机算法来评估期望值。代数方法是通过将其应用于从具有单向随机效应处理结构的模型分析中获得的平方和来呈现的。计算机算法方法则从一般性角度进行了讨论，并通过更复杂的例子进行了演示。</p>
<div id="sec18-3-1" class="section level3 hasAnchor" number="18.3.1">
<h3><span class="header-section-number">18.3.1</span> 代数方法<a href="chap18.html#sec18-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>方程 <a href="chap18.html#eq:18-1">(18.1)</a> 中的单向随机效应模型中有两个方差分量，因此在分析中使用两个平方和来描述响应的变异性。通常计算的两个平方和是随机效应水平内的平方和，记作 <span class="math inline">\(Q_1\)</span> ，以及随机效应水平之间的平方和，记作 <span class="math inline">\(Q_2\)</span>。 对于单向随机效应模型，这些平方和由下式给出</p>
<p><span class="math display">\[\begin{aligned}Q_1&amp;=\sum_{i=1}^t\sum_{j=1}^{n_i}(y_{ij}-\bar{y}_{i\cdot})^2=\sum_{i=1}^t\sum_{j=1}^{n_i}y_{ij}^2-\sum_{i=1}^tn_i\bar{y}_{i\cdot}^2\\\\Q_2&amp;=\sum_{i=1}^tn_i(\bar{y}_{i\cdot}-\bar{y}_{\cdot\cdot})^2=\sum_{i=1}^tn_i\bar{y}_{i\cdot}^2-n_{\cdot\cdot}\bar{y}_{\cdot\cdot}^2\end{aligned}\]</span></p>
<p>根据模型 <a href="chap18.html#eq:18-1">(18.1)</a> 的随机变量，<span class="math inline">\(Q_1,Q_2\)</span> 中的量可以表示为</p>
<p><span class="math display" id="eq:18-4">\[\begin{align}
y_{ij}&amp;=\mu+\mu_i+\varepsilon_{ij}\\
\bar y_{i\cdot}&amp;=\mu+\mu_i+\bar\varepsilon_{i\cdot}\\
\bar y_{\cdot\cdot}&amp;=\mu+\tilde \mu_{\cdot}+\bar\varepsilon_{\cdot\cdot}\quad\text{where}\,\,\tilde\mu_{\cdot}=\frac1N\sum_{i=1}^tn_i\mu_i
\tag{18.4}
\end{align}\]</span></p>
<p>将方程 <a href="chap18.html#eq:18-4">(18.4)</a> 中的项代入 <span class="math inline">\(Q_1\)</span>，表达式变为</p>
<p><span class="math display">\[Q_1=\sum_{i=1}^t\sum_{j=1}^{n_i}[(\mu+u_i+\varepsilon_{ij})-(\mu+u_i+\bar{\varepsilon}_{i\cdot})]^2=\sum_{i=1}^t\sum_{j=1}^{n_i}(\varepsilon_{ij}-\bar{\varepsilon}_{i\cdot})^2\]</span></p>
<p>使用 <span class="math inline">\(\boldsymbol \varepsilon\)</span> 的分布性质可以评估 <span class="math inline">\(Q_1\)</span> 的期望值</p>
<p><span class="math display">\[\begin{aligned}
E(Q_1)&amp; =\sum_{i=1}^t\sum_{j=1}^{n_i}E({\varepsilon}_{ij}-\bar{{\varepsilon}}_i.)^2=\sum_{i=1}^t\sum_{j=1}^{n_i}[E({\varepsilon}_{ij}^2)+E(\bar{{\varepsilon}}_{i\cdot}^2)-2E({\varepsilon}_{ij}\bar{{\varepsilon}}_{i\cdot})]\quad\text{(by squaring)}  \\
&amp;=\sum_{i=1}^t\sum_{j=1}^{n_i}\left(\sigma_\varepsilon^2+\frac{\sigma_\varepsilon^2}{n_i}-2\frac{\sigma_\varepsilon^2}{n_i}\right)\quad\mathrm{using~}E(\varepsilon_{ij}^2)=\sigma_\varepsilon^2\quad\mathrm{and~}\quad E(\bar{\varepsilon}_{i\cdot}^2)=\frac{\sigma_\varepsilon^2}{N_i} \\
&amp;=\sum_{i=1}^t\sum_{j=1}^{n_i}\frac{(n_i-1)\sigma_\varepsilon^2}{n_i}=\sigma_\varepsilon^2\sum_{i=1}^t\left(n_i-1\right)=\left(N-t\right)\sigma_\varepsilon^2
\end{aligned}\]</span></p>
<p>使用此表达式作为平方和的期望值，期望均方为</p>
<p><span class="math display">\[E(\text{mean square of Q}_1)=E{\left(\frac{Q_1}{N-t}\right)}=\sigma_\varepsilon^2\]</span></p>
<p>将方程 <a href="chap18.html#eq:18-4">(18.4)</a> 中的表达式代入定义 <span class="math inline">\(Q_2\)</span> 的方程得到</p>
<p><span class="math display">\[\begin{gathered}
Q_2 \begin{aligned}=\sum_{i=1}^tn_i(\mu+\mu_i+\varepsilon_{ij}-\mu-\tilde{u}_{\cdot}+\bar{\varepsilon}_{i\cdot})^2\end{aligned} \\
=\sum_{i=1}^tn_i[(u_i-\tilde{u}_{\cdot})+(\varepsilon_{ij}-\bar{\varepsilon}_{i\cdot})]^2
\end{gathered}\]</span></p>
<p><span class="math inline">\(Q_2\)</span> 的期望为</p>
<p><span class="math display">\[\begin{aligned}
E(Q_{2})&amp; \begin{aligned}=\sum_{i=1}^tn_i[E(u_i-\tilde{u}_{\cdot})^2+E(\bar{{\varepsilon}}_{i\cdot}-\bar{{\varepsilon}}_{\cdot\cdot})^2]\end{aligned}  \\
&amp;\begin{aligned}=\sum_{i=1}^tn_i[E(u_i)^2+E(\tilde{u}_{\cdot})^2-2E(u_i\tilde{u}_{\cdot})+E(\bar{\varepsilon}_{i\cdot})^2+E(\bar{\varepsilon}_{\cdot\cdot})^2-2E(\bar{\varepsilon}_{i\cdot}\bar{\varepsilon}_{\cdot\cdot})]\end{aligned}
\end{aligned}\]</span></p>
<p>为了简化这一点，<span class="math inline">\(Q_2\)</span> 的期望分为两部分进行评估。第一部分评估了涉及 <span class="math inline">\(\boldsymbol \varepsilon\)</span> 的期望。与均值 <span class="math inline">\(\bar \varepsilon_{i\cdot}\)</span> 和 <span class="math inline">\(\bar \varepsilon_{\cdot\cdot}\)</span> 相关的分布为</p>
<p><span class="math display">\[\bar{{\varepsilon}}_{i\cdot}\sim N{\left(0,\frac{{\sigma}_\varepsilon^2}{n_i}\right)}\quad\mathrm{and}\quad\bar\varepsilon_{\cdot\cdot}\sim N{\left(0,\frac{{\sigma}_\varepsilon^2}N\right)}\]</span></p>
<p>那么 <span class="math inline">\(Q_2\)</span> 中涉及 <span class="math inline">\(\boldsymbol \varepsilon\)</span> 部分的期望是</p>
<p><span class="math display">\[\begin{aligned} &amp;\sum_{i=1}^{t}n_{i}\left[E(\bar{{\varepsilon}}_{i\cdot})^{2}+E(\bar{{\varepsilon}}_{\cdot\cdot})^{2}-2E(\bar{{\varepsilon}}_{i\cdot}\bar{{\varepsilon}}_{\cdot\cdot})\right]  \\
&amp;=\sum_{i=1}^tn_i\left\{\sigma_\varepsilon^2{\left(\frac1{n_i}\right)}+\frac{\sigma_\varepsilon^2}N-2E{\left[\bar{{\varepsilon}}_{i\cdot}\frac{\sum_{i^{\prime}=1}^tn_{i^{\prime}}\bar{{\varepsilon}}_{i^{\prime}\cdot}}N\right]}\right\} \\
&amp;=\sum_{i=1}^tn_i\left\{\sigma_\varepsilon^2{\left(\frac1{n_i}\right)}+\frac{\sigma_\varepsilon^2}N-2\frac{n_i}NE(\bar{\varepsilon}_i)^2\right\} \\
&amp;=\sum_{i=1}^tn_i\left\{\sigma_\varepsilon^2{\left(\frac1{n_i}\right)}+\frac{\sigma_\varepsilon^2}N-2\frac{n_i}N{\left(\frac{\sigma_\varepsilon^2}{n_i}\right)}\right\} \\
&amp;=\sum_{i=1}^tn_i\left(\frac1{n_i}-\frac1N\right){\sigma}_\varepsilon^2 \\
&amp;=\sum_{i=1}^t\left(1-\frac{n_i}N\right)\sigma_\varepsilon^2=\left(t-1\right)\sigma_\varepsilon^2
\end{aligned}\]</span></p>
<p>为了评估 <span class="math inline">\(Q_2\)</span> 期望中涉及 <span class="math inline">\(u_i\)</span> 的部分，设 <span class="math inline">\(\tilde{u}_{\cdot}=\sum_{i=1}^t(n_iu_i/N)\)</span>. 由于 <span class="math inline">\(u_i\)</span> 独立且均值为零</p>
<p><span class="math display">\[\mathrm{Var}(\tilde{u}_\cdot)=E(\tilde{u}_\cdot)^2=\sum_{i=1}^t\left(\frac{n_i^2}{N^2}\right){\sigma}_u^2=\left(\frac1{N^2}\right){\sum}_{i=1}^t(n_i^2){\sigma}_u^2\]</span></p>
<p>由于对于 <span class="math inline">\(i\ne i^\prime\)</span> 有 <span class="math inline">\(E(u_iu_{i^\prime})\)</span>，<span class="math inline">\(u_i\)</span> 和 <span class="math inline">\(\tilde{u}_\cdot\)</span> 之间的协方差为</p>
<p><span class="math display">\[\mathrm{Cov}(\tilde{u}_\cdot,u_i)=E(\tilde{u}_\cdot u_i)=\left(\frac{n_i}N\right)E(u_i)^2=\left(\frac{n_i}N\right)\sigma_u^2\]</span></p>
<p>把这些部分放在一起，<span class="math inline">\(Q_2\)</span> 的期望中涉及 <span class="math inline">\(u_i\)</span> 的部分是</p>
<p><span class="math display">\[\begin{aligned}
\sum_{i=1}^{t} &amp;n_{i}\left[E(u_{i})^{2}+E(\tilde{u}_{\cdot})^{2}-2E(u_{i}\tilde{u}_{\cdot})\right]  \\
&amp;=\sum_{i=1}^tn_i\sigma_u^2+\sum_{i=1}^t\frac{n_i\sigma_u^2}{N^2}\left(\sum_{i=1}^tn_i^2\right)-2\sum_{i=1}^t\left(\frac{n_i^2}N\right)\sigma_u^2 \\
&amp;\left.=\left(\sum_{i=1}^tn_i{\sigma}_u^2\right.-\frac{\sum_{i=1}^tn_i^2}N{\sigma}_u^2\right)=\left(N-\frac{\sum_{i=1}^tn_i^2}N\right){\sigma}_u^2
\end{aligned}\]</span></p>
<p>最后，将这两个部分合在一起，<span class="math inline">\(Q_2\)</span> 的期望为</p>
<p><span class="math display">\[\begin{aligned}E(Q_2)=(t-1)\sigma_\varepsilon^2+\left(N-\frac{\sum_{i=1}^tn_i^2}N\right)\sigma_u^2\end{aligned}\]</span></p>
<p><span class="math inline">\(Q_2\)</span> 的期望均方为</p>
<p><span class="math display">\[E{\left(\frac{Q_2}{t-1}\right)}=\sigma_\varepsilon^2+{\left(\frac1{t-1}\right)}{\left(N-\frac{\sum_{i=1}^tn_i^2}N\right)}\sigma_u^2\]</span></p>
<p>表 <a href="chap18.html#tab:table18-1">18.1</a> 中给出了单向随机效应模型的方差分析表，包括来源、自由度、平方和以及期望均方。</p>
<table>
<caption>
<span id="tab:table18-1">表 18.1: </span>单向随机效应模型的方差分析表
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2018.1.png">
</td>
</tr>
</tbody>
</table>
</div>
<div id="sec18-3-2" class="section level3 hasAnchor" number="18.3.2">
<h3><span class="header-section-number">18.3.2</span> Hartley 综合法的计算<a href="chap18.html#sec18-3-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hartley (1967) 提出了一种技术，用于评估特定设计和平方和的均方期望值，他称之为综合法 (Hartley’s method of synthesis). 为了描述并随后应用这一技术，我们首先用矩阵表示从一般随机效应模型 <a href="chap18.html#eq:18-3">(18.3)</a> 计算出的平方和的期望值。任何通过公式计算或通过计算机软件提取的平方和，总是可以表示为数据的<strong>二次型</strong> (quadratic form)</p>
<p><span class="math display" id="eq:18-5">\[\begin{equation}
Q=\boldsymbol{y&#39;Ay}
\tag{18.5}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(\boldsymbol y\)</span> 是观测向量，<span class="math inline">\(\boldsymbol A\)</span> 是适当选择的对称常数矩阵，称为<strong>二次型的矩阵</strong> (the matrix of the quadratic form) (Graybill, 1976). 例如，n 个观测值的向量的样本方差为</p>
<p><span class="math display">\[s^2=\sum_{i=1}^n\frac{(\boldsymbol y_i-\bar{\boldsymbol y}_{\cdot})^2}{n-1}=\boldsymbol y^{\prime}\biggl[\frac1{n-1}{\biggl(\boldsymbol I_n-\frac1n\boldsymbol J_n\biggr)}\biggr]\boldsymbol{y}\]</span>
其中 <span class="math inline">\(\boldsymbol I_n\)</span> 为 n × n 单位阵，<span class="math inline">\(\boldsymbol J_n\)</span> 为 n × n 全一阵，二次型 <span class="math inline">\(\boldsymbol{y&#39;Ay}\)</span> 的矩阵为</p>
<p><span class="math display">\[\boldsymbol A=\frac1{n-1}{\biggl(\boldsymbol I_n-\frac1n\boldsymbol J_n\biggr)}\]</span></p>
<p>针对不同的模型，总存在某些特定的选择使得矩阵 <span class="math inline">\(\boldsymbol A\)</span> 产生所需的平方和，幸运的是，正如我们很快将看到的那样，无需了解矩阵 <span class="math inline">\(\boldsymbol A\)</span> 中的元素具体是什么，甚至不必知道如何确定矩阵 <span class="math inline">\(\boldsymbol A\)</span> 的元素。<strong>只需要知道矩阵 <span class="math inline">\(\boldsymbol A\)</span> 是存在的</strong>。</p>
<p>对于一般随机效应模型 <a href="chap18.html#eq:18-3">(18.3)</a> 及其相应的协方差阵 <span class="math inline">\(\boldsymbol \Sigma\)</span>，二次型的期望 (Graybill, 1976) 为</p>
<p><span class="math display" id="eq:18-6">\[\begin{equation}
E(\boldsymbol{y^{\prime}Ay})=\mathrm{Tr}[\boldsymbol{A\Sigma}]+\frac12\mu^2\boldsymbol{j}_n^{\prime}\boldsymbol A\boldsymbol{j}_n
\tag{18.6}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(\operatorname{Tr}[\boldsymbol{B}]=\sum_{i=1}^nb_{ii}\)</span> 且 <span class="math inline">\(b_{ii},i=1,2,\cdots,n\)</span> 表示方阵 <span class="math inline">\(\boldsymbol B\)</span> 的对角元。方差分析中的平方和被构造为使得 <span class="math inline">\(\mu^2\boldsymbol{j}_n^{\prime}\boldsymbol A\boldsymbol{j}_n\)</span>. 因此，平方和的期望不取决于 <span class="math inline">\(\mu^2\boldsymbol{j}_n^{\prime}\boldsymbol A\boldsymbol{j}_n\)</span>，并且由下式给出</p>
<p><span class="math display" id="eq:18-7">\[\begin{equation}
E(\boldsymbol{y^{\prime}Ay})=\mathrm{Tr}[\boldsymbol{A\Sigma}]
\tag{18.7}
\end{equation}\]</span></p>
<p>方程 <a href="chap18.html#eq:18-3">(18.3)</a> 中的一般随机效应模型的协方差阵为</p>
<p><span class="math display">\[\boldsymbol{\Sigma}={\sigma}_1^2\boldsymbol{Z}_1\boldsymbol{Z}_1^{\prime}+{\sigma}_2^2\boldsymbol{Z}_2\boldsymbol{Z}_2^{\prime}+\cdots+{\sigma}_r^2\boldsymbol{Z}_r\boldsymbol{Z}_r^{\prime}+{\sigma}_\varepsilon^2\boldsymbol{I}_N\]</span></p>
<p>因此，二次型 <span class="math inline">\(\boldsymbol{y^{\prime}Ay}\)</span> 的期望是</p>
<p><span class="math display">\[\begin{aligned}E(\boldsymbol{y^{\prime}Ay})&amp;=\mathrm{Tr}[\boldsymbol A\boldsymbol{\Sigma}]=\mathrm{Tr}[\boldsymbol A(\sigma_1^2\boldsymbol Z_1\boldsymbol Z_1^{\prime}+\sigma_2^2\boldsymbol Z_2\boldsymbol Z_2^{\prime}+\cdots+\sigma_r^2\boldsymbol Z_r\boldsymbol Z_r^{\prime}+\sigma_\varepsilon^2\boldsymbol I_N)]\\&amp;=\sigma_1^2\mathrm{~Tr}[\boldsymbol A\boldsymbol Z_1\boldsymbol Z_1^{\prime}]+\sigma_2^2\mathrm{~Tr}[\boldsymbol A\boldsymbol Z_2\boldsymbol Z_2^{\prime}]+\cdots+\sigma_r^2\mathrm{~Tr}[\boldsymbol A\boldsymbol Z_r\boldsymbol Z_r^{\prime}]+\sigma_\varepsilon^2\mathrm{~Tr}[\boldsymbol A]\end{aligned}\]</span></p>
<p>因此，<span class="math inline">\(\sigma^2_{\varepsilon}\)</span> 的系数为 <span class="math inline">\(\mathrm{Tr}[\boldsymbol A]\)</span>，这等于与平方和 <span class="math inline">\(\boldsymbol{y^{\prime}Ay}\)</span> 相关的自由度。对于 <span class="math inline">\(s=1,2,\cdots,r\)</span>，<span class="math inline">\(\sigma^2_{\varepsilon}\)</span> 的系数为 <span class="math inline">\(\mathrm{Tr}[\boldsymbol A\boldsymbol Z_s\boldsymbol Z_s^{\prime}]\)</span>.</p>
<p>迹运算符的一个性质是，<span class="math inline">\(\mathrm{Tr}[\boldsymbol A\boldsymbol Z_s\boldsymbol Z_s^{\prime}]=\mathrm{Tr}[\boldsymbol Z_s^{\prime}\boldsymbol A \boldsymbol Z_s]\)</span> 其中 <span class="math inline">\(\mathrm{Tr}[\boldsymbol Z_s^{\prime}\boldsymbol A \boldsymbol Z_s]\)</span> 是 <span class="math inline">\(\boldsymbol Z_s^{\prime}\boldsymbol A \boldsymbol Z_s\)</span> 对角元之和，即 <span class="math inline">\(\mathrm{Tr}[\boldsymbol Z_s^{\prime}\boldsymbol A \boldsymbol Z_s]=\sum_{j=1}^{t_s}\boldsymbol z^\prime_{sj}\boldsymbol A \boldsymbol z_{sj}\)</span> 因为 <span class="math inline">\(\boldsymbol Z_s\)</span> 中有 <span class="math inline">\(t_s\)</span> 列。但是，<span class="math inline">\(\boldsymbol z^\prime_{sj}\boldsymbol A \boldsymbol z_{sj}\)</span> 与 <span class="math inline">\(\boldsymbol{y^{\prime}Ay}\)</span> 是相同的平方和，只不过这里是以列向量 <span class="math inline">\(\boldsymbol z^\prime _{sj}\)</span> 代替 <span class="math inline">\(\boldsymbol y\)</span> 作为数据使用。因此，如果你有一个计算 <span class="math inline">\(\boldsymbol{y^{\prime}Ay}\)</span> 的方程或计算机程序，它也可以用来计算 <span class="math inline">\(\boldsymbol z^\prime_{sj}\boldsymbol A \boldsymbol z_{sj}\)</span>. 因此，在 <span class="math inline">\(\boldsymbol{y^{\prime}Ay}\)</span> 的期望中，<span class="math inline">\(\sigma^2_s\)</span> 的系数是 <span class="math inline">\(\boldsymbol{z&#39;}_{s1}\boldsymbol{Az}_{s1}+\boldsymbol{z&#39;}_{s2}\boldsymbol{Az}_{s2}+\cdots+\boldsymbol{z&#39;}_{st_s}\boldsymbol{Az}_{st_s}\)</span>.</p>
<p>如果 <span class="math inline">\(\boldsymbol A\)</span> 的元素是已知的，那么可以明确地评估上述平方和。然而，由于通常会使用计算机代码来计算 <span class="math inline">\(\boldsymbol{y^{\prime}Ay}\)</span>，此时 <span class="math inline">\(\boldsymbol A\)</span> 未知，那么每个 <span class="math inline">\(\boldsymbol z^\prime_{sj}\boldsymbol A \boldsymbol z_{sj}\)</span> 可以通过让计算机计算以列向量 <span class="math inline">\(\boldsymbol z_{sj}\)</span> 作为数据向量（替代 <span class="math inline">\(\boldsymbol y\)</span>）所得的平方和来进行计算。因此，必须根据模型中的所有随机效应计算设计矩阵每列的平方和 <span class="math inline">\([\boldsymbol Z_1,\boldsymbol Z_2,\cdots,\boldsymbol Z_r]\)</span>，就好像它们是数据一样，然后平方和 <span class="math inline">\(\boldsymbol{y^{\prime}Ay}\)</span> 的期望被评估为</p>
<p><span class="math display">\[E(\boldsymbol{y^{\prime}Ay})=v\sigma_\varepsilon^2+\left(\sum_{q=1}^{t_1}\boldsymbol z_{1q}^{\prime}\boldsymbol A\boldsymbol z_{1q}\right)\sigma_1^2+\left(\sum_{q=1}^{t_2}\boldsymbol z_{2q}^{\prime}\boldsymbol A\boldsymbol z_{2q}\right)\sigma_2^2+\cdots+\left(\sum_{q=1}^{t_r}\boldsymbol z_{rq}^{\prime}\boldsymbol A\boldsymbol z_{rq}\right)\sigma_r^2\]</span></p>
<p>其中 <span class="math inline">\(v\)</span> 是与 <span class="math inline">\(\boldsymbol{y^{\prime}Ay}\)</span> 相关的自由度。</p>
<p>为了更好地说明综合法的概念，我们重新计算单向随机效应模型的平方和 <span class="math inline">\(Q_1\)</span> 和 <span class="math inline">\(Q_2\)</span> 的期望值。首先，我们会采用一个特定模型，其中 <span class="math inline">\(t=4\)</span>，并且对每个 <span class="math inline">\(i\)</span> 都有 <span class="math inline">\(n_i=4\)</span>，以此来展示如何计算期望值；接着为一般单向随机效应模型计算期望值。</p>
<p>在具有四个重复的完全随机设计结构中，用矩阵形式描述四个随机选取的小麦品种产量的模型为：</p>
<p><span class="math display">\[\begin{bmatrix}y_{11}\\y_{12}\\y_{13}\\y_{14}\\y_{21}\\y_{22}\\y_{23}\\y_{24}\\y_{31}\\y_{32}\\y_{33}\\y_{34}\\y_{41}\\y_{42}\\y_{43}\\y_{44}\end{bmatrix}=\begin{bmatrix}1\\1\\1\\1\\1\\1\\1\\1\\1\\1\\1\\1\\1\\1\\1\\1\end{bmatrix}\mu+\begin{bmatrix}1&amp;0&amp;0&amp;0\\1&amp;0&amp;0&amp;0\\1&amp;0&amp;0&amp;0\\1&amp;0&amp;0&amp;0\\0&amp;1&amp;0&amp;0\\0&amp;1&amp;0&amp;0\\0&amp;1&amp;0&amp;0\\0&amp;1&amp;0&amp;0\\0&amp;0&amp;1&amp;0\\0&amp;0&amp;1&amp;0\\0&amp;0&amp;1&amp;0\\0&amp;0&amp;1&amp;0\\0&amp;0&amp;0&amp;1\\0&amp;0&amp;0&amp;1\\0&amp;0&amp;0&amp;1\\0&amp;0&amp;0&amp;1\end{bmatrix}+\begin{bmatrix}\boldsymbol u_1\\\boldsymbol u_2\\\boldsymbol u_3\\\boldsymbol u_4\end{bmatrix}+\begin{bmatrix}
\varepsilon_{11}\\\varepsilon_{12}\\\varepsilon_{13}\\\varepsilon_{14}\\
\varepsilon_{21}\\\varepsilon_{22}\\\varepsilon_{23}\\\varepsilon_{24}\\
\varepsilon_{31}\\\varepsilon_{32}\\\varepsilon_{33}\\\varepsilon_{34}\\
\varepsilon_{41}\\\varepsilon_{42}\\\varepsilon_{43}\\\varepsilon_{44}\end{bmatrix}\]</span></p>
<p>或 <span class="math inline">\(\boldsymbol{y}=\boldsymbol{j}_{16} \mu+[\boldsymbol z_1\,\,\boldsymbol z_2\,\,\boldsymbol z_3\,\,\boldsymbol z_4]\boldsymbol{u}+\boldsymbol{\varepsilon}\)</span>.</p>
<p>组内平方和 (within sum of squares<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a>) <span class="math inline">\(Q_1\)</span> 的期望值为</p>
<p><span class="math display">\[E(Q_1)=E(\boldsymbol{y&#39;}\boldsymbol A_w\boldsymbol{y})=\boldsymbol{\sigma}_u^2\left[\boldsymbol{\sum}_{j=1}^4\boldsymbol{z}&#39;_j\boldsymbol{A}_w\boldsymbol{z}_j\right]+12{\sigma}_\varepsilon^2\]</span></p>
<p>其中 12 是与 <span class="math inline">\(Q_1\)</span> 相关的自由度，<span class="math inline">\(\boldsymbol{A}_w\)</span> 表示组内平方和 <span class="math inline">\(Q_1\)</span> 二次型的矩阵。为了获得 <span class="math inline">\(\sigma^2_u\)</span> 的系数，使用 <span class="math inline">\(\boldsymbol z_1\)</span> 作为数据计算组内平方和 <span class="math inline">\(Q_1\)</span>，使用 <span class="math inline">\(\boldsymbol z_2\)</span> 作为数据计算 <span class="math inline">\(Q_1\)</span>，使用 <span class="math inline">\(\boldsymbol z_3\)</span> 作为数据计算 <span class="math inline">\(Q_1\)</span>，使用 <span class="math inline">\(\boldsymbol z_4\)</span> 作为数据计算 <span class="math inline">\(Q_1\)</span>. 对于列 <span class="math inline">\(\boldsymbol z_1\)</span> 的组内平方和</p>
<p><span class="math display">\[\begin{aligned}Q_1(\boldsymbol z_1)=\sum_{i=1}^4\sum_{j=1}^4z_{1ij}^2-4\sum_{i=1}^4\bar{z}_{1i\cdot}^2&amp;=4-4(1)=0\end{aligned}\]</span></p>
<p>同样，<span class="math inline">\(Q_1(\boldsymbol z_2),Q_1(\boldsymbol z_3),Q_1(\boldsymbol z_4)\)</span> 也为 0. 这意味着 <span class="math inline">\(\sigma^2_u\)</span> 在 <span class="math inline">\(E(Q_1)\)</span> 中的系数为零，因此 <span class="math inline">\(E(Q_1)=12{\sigma}_\varepsilon^2\)</span>.</p>
<p>组间平方和 (between sum of squares<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a>) <span class="math inline">\(Q_2\)</span> 的期望值为</p>
<p><span class="math display">\[E(Q_2)=E(\boldsymbol{y&#39;}\boldsymbol A_B\boldsymbol{y})={\sigma}_u^2\biggl[\boldsymbol{\sum}_{j=1}^4\boldsymbol{z&#39;}_{j}\boldsymbol A_B\boldsymbol{z}_j\biggr]+3{\sigma}_\varepsilon^2\]</span></p>
<p>其中</p>
<p><span class="math display">\[Q_2=\sum_{i=1}^tn_i(\bar{y}_{i\cdot}-\bar{y}_{\cdot\cdot})^2=\sum_{i=1}^tn_i\bar{y}_{i\cdot}^2-n_{\cdot\cdot}\bar{y}_{\cdot\cdot}\]</span></p>
<p>其中 3 是与 <span class="math inline">\(Q_2\)</span> 相关的自由度，<span class="math inline">\(\boldsymbol{A}_B\)</span> 表示组间平方和 <span class="math inline">\(Q_2\)</span> 二次型的矩阵。要计算 <span class="math inline">\(\sigma^2_u\)</span> 的系数，请使用每列 <span class="math inline">\(\boldsymbol z_1,\boldsymbol z_2,\boldsymbol z_3,\boldsymbol z_4\)</span> 计算组间平方和 <span class="math inline">\(Q_2\)</span> 的值，并将这四个值相加。使用 <span class="math inline">\(\boldsymbol z_1\)</span> 作为数据计算的组间平方和的值为</p>
<p><span class="math display">\[Q_2(\boldsymbol z_1){=}4\sum_{i=1}^4\bar{z}_{1i\cdot}^2-16\bar{z}_{\cdot\cdot\cdot}^2=4(1^2+0^2+0^2+0^2){-}16(0.25)^2{=}3\]</span></p>
<p><span class="math inline">\(Q_2(\boldsymbol z_2),Q_2(\boldsymbol z_3),Q_2(\boldsymbol z_4)\)</span> 的值也等于 3；因此，<span class="math inline">\(\sigma^2_u\)</span> 的系数为 <span class="math inline">\(3+3+3+3=12\)</span>. 使用这些值，<span class="math inline">\(E(Q_2)\)</span> 的表达式为</p>
<p><span class="math display">\[E(Q_2)=12\sigma_u^2+3\sigma_\varepsilon^2\]</span></p>
<p>接下来，使用 Hartley 的综合法来计算方程 <a href="chap18.html#eq:18-1">(18.1)</a> 中的一般单向随机效应模型的组内和组间平方和的期望值。模型的矩阵形式为</p>
<p><span class="math display">\[\begin{bmatrix}y_{11}\\\vdots\\y_{1n_1}\\y_{21}\\\vdots\\y_{2n_2}\\\vdots\\y_{t1}\\\vdots\\y_{tn_l}\end{bmatrix}=\begin{bmatrix}1\\\vdots\\1\\1\\\vdots\\1\\\vdots\\1\\\vdots\\1\end{bmatrix} \mu+\begin{bmatrix}1&amp;0&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\1&amp;0&amp;\cdots&amp;0\\0&amp;1&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\0&amp;1&amp;\cdots&amp;0\\\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\0&amp;0&amp;\cdots&amp;1\\\vdots&amp;\vdots&amp;\cdots&amp;\vdots\\0&amp;0&amp;\cdots&amp;1\end{bmatrix}\begin{bmatrix}\boldsymbol{u}_1\\\boldsymbol{u}_2\\\vdots\\\boldsymbol{u}_t\end{bmatrix}+\boldsymbol{\varepsilon}\]</span></p>
<p>或</p>
<p><span class="math display">\[\boldsymbol y=\boldsymbol j_{n} \mu+[\boldsymbol z_1,\boldsymbol z_2,\ldots,\boldsymbol z_t]\boldsymbol u+\boldsymbol \varepsilon \]</span></p>
<p>组内或误差平方和为</p>
<p><span class="math display">\[Q_1=\sum_{i=1}^t\sum_{j=1}^{n_i}y_{ij}^2-\sum_{i=1}^tn_i\bar{y}_{i\cdot}^2=\boldsymbol{y&#39;A}_w\boldsymbol{y}\]</span></p>
<p>其期望为</p>
<p><span class="math display">\[\begin{aligned}E(Q_1)=\sigma_u^2\sum_{i=1}^t\boldsymbol z_i&#39;\boldsymbol A_w\boldsymbol z_i+(N-t)\sigma_\varepsilon^2\end{aligned}\]</span></p>
<p>其中 <span class="math inline">\(N=\sum_{i=1}^tn_i\)</span> 以及 <span class="math inline">\(\boldsymbol A_w\)</span> 是组内平方和二次型的矩阵。当使用第一列 <span class="math inline">\(\boldsymbol z_1\)</span> 作为数据时，<span class="math inline">\(Q_1\)</span> 的值为</p>
<p><span class="math display">\[Q_1(\boldsymbol z_1)=\sum_{i=1}^t\sum_{j=1}^{n_i} z_{1ij}^2-\sum_{i=1}^tn_i\bar{ z}_{1i\cdot}^2=n_1-\left[n_1(1)+n_2(0)+\cdots+n_t(0)\right]=0\]</span></p>
<p>同样，<span class="math inline">\(Q_1(\boldsymbol z_2),Q_1(\boldsymbol z_3),Q_1(\boldsymbol z_4)\)</span> 也为 0. 因此，<span class="math inline">\(\sigma^2_u\)</span> 在 <span class="math inline">\(E(Q_1)\)</span> 中的系数为零，这意味着 <span class="math inline">\(E(Q_1)=(N-t)\sigma^2_{\varepsilon}\)</span>，并且其中存在与 <span class="math inline">\(Q_1\)</span> 相关的 N-t 个自由度。</p>
<p>组间平方和为</p>
<p><span class="math display">\[Q_2=\sum_{i=1}^tn_i\bar{y}_{i\cdot}^2-n_{\cdot\cdot}\bar{y}_{\cdot\cdot}^2=\boldsymbol y^{\prime}\boldsymbol A_B\boldsymbol y\]</span></p>
<p>其期望为</p>
<p><span class="math display">\[E(Q_2)=\sigma_u^2\sum_{i=1}^t\boldsymbol z_i \boldsymbol A_B\boldsymbol z_i+(t-1)\sigma_\varepsilon^2\]</span></p>
<p>其中 <span class="math inline">\(\boldsymbol A_B\)</span> 是组间平方和二次型的矩阵。当使用第一列 <span class="math inline">\(\boldsymbol z_1\)</span> 作为数据时，<span class="math inline">\(Q_2\)</span> 的值为</p>
<p><span class="math display">\[Q_2(\boldsymbol z_1){=}\sum_{i=1}^tn_i\bar{z}_{1i\cdot}^2-N\bar{z}_{1\cdot\cdot}^2\]</span></p>
<p>对于列 <span class="math inline">\(\boldsymbol z_1\)</span> 有 <span class="math inline">\(\bar z_{11\cdot}=1,\bar z_{12\cdot}=\bar z_{13\cdot}=\cdots \bar z_{1t\cdot}=0\)</span> 以及 <span class="math inline">\(\bar z_{1\cdot\cdot}=n_1/N\)</span>. 因此</p>
<p><span class="math display">\[Q_2(\boldsymbol z_1)=n_1(1)^2+n_2(0)^2+\cdots+n_t(0)^2-N(n_1/N)^2=\frac{n_1-n_1^2}N\]</span></p>
<p>类似地，使用 <span class="math inline">\(\boldsymbol Z\)</span> 的其他列作为数据的 <span class="math inline">\(Q_2\)</span> 的值为</p>
<p><span class="math display">\[Q_2(\boldsymbol z_2)=\frac{n_2-n_2^2}N,\quad Q_2(\boldsymbol z_3)=\frac{n_3-n_3^2}N,\ldots,Q_2(\boldsymbol z_t)=\frac{n_t-n_t^2}N\]</span></p>
<p>合并这些结果，组间平方和的期望值为</p>
<p><span class="math display">\[E(Q_2)=(t-1)\sigma_\varepsilon^2+\left[\sum_{i=1}^tQ_2(\boldsymbol z_i)\right]\sigma_u^2=(t-1)\sigma_\varepsilon^2+\left[\sum_{i=1}^tn_i^2\right]\sigma_u^2\]</span></p>
<p>通过 Hartley 综合法获得的 <span class="math inline">\(Q_1\)</span> 和 <span class="math inline">\(Q_2\)</span> 的期望值与使用代数技术获得的期望值相等。</p>
<p>接下来，使用 Hartley 综合法来评估用于描述在完全随机设计结构中具有交互作用的双向随机效应处理结构的模型的平方和期望值。在这种情况下，行处理和列处理都是随机效应。该实验的数据可建模为</p>
<p><span class="math display">\[y_{ijk}=\mu+a_i+b_j+c_{ij}+\varepsilon_{ijk},\quad i=1,2,\ldots,s,j=1,2,\ldots,t,\quad k=1,2,\ldots,n_{ij}\]</span></p>
<p>其中 <span class="math inline">\(a_i,i=1,2,\cdots,s\)</span> 表示与行对应的随机效应，其具有 <span class="math inline">\(i.i.d.\,N(0,\sigma^2_a)\)</span> 分布；<span class="math inline">\(b_i,i=1,2,\cdots,t\)</span> 表示与列对应的随机效应，其具有 <span class="math inline">\(i.i.d.\,N(0,\sigma^2_b)\)</span> 分布；<span class="math inline">\(c_{ij}\)</span> 表示行-列组合的随机效应，其具有 <span class="math inline">\(i.i.d.\,N(0,\sigma^2_c)\)</span> 分布，<span class="math inline">\(\varepsilon_{ijk}\)</span> 实验单元误差，其具有 <span class="math inline">\(i.i.d.\,N(0,\sigma^2_\varepsilon)\)</span> 分布。图 <a href="chap18.html#fig:figure18-1">18.1</a> 中的示意图代表来自完全随机设计结构中的不均衡双向处理结构的数据，其中每个单元格有两到三个观测结果。</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figure18-1"></span>
<img src="figure/figure%2018.1.png" alt="双向随机效应处理结构示例" width="781" />
<p class="caption">
图 18.1: 双向随机效应处理结构示例
</p>
</div>
<p>在图 <a href="chap18.html#fig:figure18-1">18.1</a> 所示数据结构的完全随机设计结构中，这种双向随机效应处理结构的矩阵形式为</p>
<p><span class="math display">\[\begin{bmatrix}y_{111}\\y_{112}\\y_{113}\\y_{121}\\y_{122}\\y_{131}\\y_{132}\\y_{211}\\y_{212}\\y_{221}\\y_{222}\\y_{223}\\y_{231}\\y_{232}\end{bmatrix}=\begin{bmatrix}1\\1\\1\\1\\1\\1\\1\\1\\1\\1\\1\\1\\1\\1\end{bmatrix}\mu +\begin{bmatrix}1&amp;0\\1&amp;0\\1&amp;0\\1&amp;0\\1&amp;0\\1&amp;0\\1&amp;0\\0&amp;1\\0&amp;1\\0&amp;1\\0&amp;1\\0&amp;1\\0&amp;1\\0&amp;1\end{bmatrix}\begin{bmatrix}a_1\\a_2\end{bmatrix}+\begin{bmatrix}1&amp;0&amp;0\\1&amp;0&amp;0\\1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\\0&amp;0&amp;1\\1&amp;0&amp;0\\1&amp;0&amp;0\\0&amp;1&amp;0\\0&amp;1&amp;0\\0&amp;1&amp;0\\0&amp;0&amp;1\\0&amp;0&amp;1\end{bmatrix}\begin{bmatrix}b_1\\b_2\\b_3\end{bmatrix}+\begin{bmatrix}1&amp;0&amp;0&amp;0&amp;0&amp;0\\1&amp;0&amp;0&amp;0&amp;0&amp;0\\1&amp;0&amp;0&amp;0&amp;0&amp;0\\0&amp;1&amp;0&amp;0&amp;0&amp;0\\0&amp;1&amp;0&amp;0&amp;0&amp;0\\0&amp;0&amp;1&amp;0&amp;0&amp;0\\0&amp;0&amp;1&amp;0&amp;0&amp;0\\0&amp;0&amp;0&amp;1&amp;0&amp;0\\0&amp;0&amp;0&amp;1&amp;0&amp;0\\0&amp;0&amp;0&amp;0&amp;1&amp;0\\0&amp;0&amp;0&amp;0&amp;1&amp;0\\0&amp;0&amp;0&amp;0&amp;1&amp;0\\0&amp;0&amp;0&amp;0&amp;0&amp;1\\0&amp;0&amp;0&amp;0&amp;0&amp;1\end{bmatrix}\begin{bmatrix}c_{11}\\c_{12}\\c_{13}\\c_{21}\\c_{22}\\c_{23}\end{bmatrix}+\boldsymbol \varepsilon\]</span></p>
<p>或 <span class="math inline">\(\boldsymbol{y}=\boldsymbol{j}_{14} \mu+\boldsymbol{Z}_1\boldsymbol{a}+\boldsymbol{Z}_2\boldsymbol{b}+\boldsymbol{Z}_3\boldsymbol{c}+\boldsymbol{\varepsilon}\)</span> 其中模型参数为 <span class="math inline">\(\mu,\sigma_a^2,\sigma_b^2,\sigma_c^2\)</span> 和 <span class="math inline">\(\sigma_\varepsilon^2\)</span></p>
<p>这种不均衡双向随机效应模型的平方和可以用几种不同的方法计算（见第 <a href="chap9.html#chap9">9</a> 章和第 <a href="chap10.html#chap10">10</a> 章）。在该模型的分析中，有四个方差分量，因此需要四个不同的平方和。为了演示综合方法，选择了四个平方和，它们对应于 SSROWS, SSCOLUMNS, SSINTERACTION 和 SSERROR 的均衡情况，但针对不等的样本量进行了修改（对应于 Henderson 的 I 型平方和，在本节稍后讨论）。四个平方和是</p>
<p><span class="math display">\[\begin{aligned}
&amp;Q_1 =\sum_{i=1}^s\frac{y_{i\cdot\cdot}^2}{n_{i\cdot}}-\frac{y_{i\cdot\cdot}^2}{n_{\cdot\cdot}}\mathrm{~(SSROWS)}  \\
&amp;Q_2 =\sum_{j=1}^t\frac{y_{\cdot j\cdot}^2}{n_{\cdot j}}-\frac{y_{\cdot\cdot\cdot}^2}{n_{\cdot\cdot}}\mathrm{~(SSCOLUMNS)}  \\
&amp;Q_3 =\sum_{i=1}^\text{s}{ \sum _ { j = 1 }^{t}\frac{y_{ij\cdot}^2}{n_{ij}}-Q_1-Q_2+\frac{y^2_{\cdot\cdot\cdot}}{n_{\cdot\cdot}}\quad\text{(SSINTERACTION)}}  \\
&amp;Q_4 =\sum_{i=1}^s\sum_{j=1}^t\sum_{k=1}^{n_{ij}}{(y_{ijk}-\bar{y}_{ij\cdot})^2}\quad\text{(SSERROR)}
\end{aligned}\]</span></p>
<p>对于图 <a href="chap18.html#fig:figure18-1">18.1</a> 中的数据结构，</p>
<p><span class="math display">\[Q_2=\frac{y_{\cdot1\cdot}^2}5+\frac{y_{\cdot2\cdot}^2}5+\frac{y_{\cdot3\cdot}^2}4-\frac{y_{\cdot\cdot\cdot}^2}{14}\]</span></p>
<p>以及，对于 <span class="math inline">\(k_1,k_2,k_3\)</span> 的一些值，<span class="math inline">\(E(Q_2)\)</span> 具有形式 <span class="math inline">\(E(Q_2)＝k_1\sigma_a^2+k_2\sigma_b^2+k_3\sigma_c^2+2\sigma_\varepsilon^2\)</span>，其中 2 是与 <span class="math inline">\(Q_2\)</span> 相关的自由度。下一步是使用 Hartley 的综合法来确定 <span class="math inline">\(k_1,k_2,k_3\)</span>. 要确定 <span class="math inline">\(k_1\)</span> 的值，请为 <span class="math inline">\(\boldsymbol Z_1\)</span> 的两列中的每一列计算 <span class="math inline">\(Q_2\)</span>. 使用 <span class="math inline">\(\boldsymbol Z_1\)</span> 的第一列作为数据的 <span class="math inline">\(Q_2\)</span> 的值为</p>
<p><span class="math display">\[\begin{aligned}Q_2( \boldsymbol z_{11})=\frac{3^2}5+\frac{2^2}5+\frac{2^2}4-\frac{7^2}{14}=0.1\end{aligned}\]</span></p>
<p>并且使用 <span class="math inline">\(\boldsymbol Z_1\)</span> 的第二列作为数据的 <span class="math inline">\(Q_2\)</span> 的值为</p>
<p><span class="math display">\[Q_2(\boldsymbol z_{12})=\frac{2^2}5+\frac{3^2}5+\frac{2^2}4-\frac{5^2}{14}=0.1\]</span></p>
<p>因此，<span class="math inline">\(k_1＝Q_2( z_{11})+Q_2( z_{11})=0.1+0.1=0.2\)</span>. 为确定 <span class="math inline">\(k_2\)</span> 的值，计算 <span class="math inline">\(\boldsymbol Z_2\)</span> 每列的 <span class="math inline">\(Q_2\)</span> 为</p>
<p><span class="math display">\[
\begin{aligned}
Q_2(z_{21})=\frac{5^2}5+\frac{0^2}5+\frac{0^2}4-\frac{5^2}{14}=3.214 \\
Q_2(z_{22})=\frac{0^2}5+\frac{5^2}5+\frac{0^2}4-\frac{5^2}{14}=3.214 \\
Q_{2}(z_{23})=\frac{0^{2}}{5}+\frac{0^{2}}{5}+\frac{4^{2}}{4}-\frac{4^{2}}{14}=2.857
\end{aligned}
\]</span></p>
<p><span class="math inline">\(k_2\)</span> 的值为 <span class="math inline">\(k_2=Q_2( z_{21})+Q_2( z_{22})+Q_2( z_{23})=3.214+3.214+2.857=9.285\)</span>.</p>
<p><span class="math inline">\(k_3\)</span> 的值是通过计算 <span class="math inline">\(\boldsymbol Z_3\)</span> 的每列的 <span class="math inline">\(Q_2\)</span> 来获得的。<span class="math inline">\(Q_2\)</span> 的值为</p>
<p><span class="math display">\[\begin{aligned}
Q_2({z}_{311}) =\frac{3^2}5+\frac{0^2}5+\frac{0^2}4-\frac{3^2}{14}=1.157 \\
Q_2(z_{312}) =\frac{0^2}5+\frac{2^2}5+\frac{0^2}4-\frac{2^2}{14}=0.514 \\
Q_2(z_{313}) =\frac{0^2}5+\frac{0^2}5+\frac{2^2}4-\frac{2^2}{14}=0.714 \\
Q_{2}({z}_{321}) =\frac{2^2}5+\frac{0^2}5+\frac{0^2}4-\frac{2^2}{14}=0.514 \\
Q_2(z_{322}) =\frac{0^2}5+\frac{3^2}5+\frac{0^2}4-\frac{3^2}{14}=1.157 \\
Q_2({z}_{323})=\frac{0^2}5+\frac{0^2}5+\frac{2^2}4-\frac{2^2}{14}=0.714
\end{aligned}\]</span></p>
<p>因此，<span class="math inline">\(k_3=1.157+0.514+0.714+0.514+1.157+0.714=4.770\)</span>. 使用上述 <span class="math inline">\(k_1,k_2,k_3\)</span> 的值，SSROWS 的期望值为</p>
<p><span class="math display">\[E(Q_2)=0.200\sigma_a^2+9.285\sigma_b^2+4.770\sigma_c^2+2\sigma_\varepsilon^2\]</span></p>
<p>类似地，应用 Hartley 的综合法，<span class="math inline">\(Q_1\)</span> 和 <span class="math inline">\(Q_3\)</span> 的期望值被确定为</p>
<p><span class="math display">\[E(Q_1)=7.000{\sigma}_a^2+0.143{\sigma}_b^2+2.429{\sigma}_c^2+(1){\sigma}_\varepsilon^2\]</span></p>
<p>以及</p>
<p><span class="math display">\[E(Q_3)=4.371{\sigma}_c^2+2{\sigma}_\varepsilon^2\]</span></p>
<p>一般来说，SSERROR 的期望值等于与 SSERROR 相关的自由度乘以 <span class="math inline">\({\sigma}_\varepsilon^2\)</span>，在这种情况下，它提供</p>
<p><span class="math display">\[E(Q_4)=E(\text{SSERROR})=8\sigma_\varepsilon^2\]</span></p>
<p>对于不均衡处理结构，计算平方和的方法有很多种，包括 SAS<sup>®</sup>-GLM 的 I-IV 型平方和，SAS-MIXED 的 I-III 型平方和，以及 Henderson 提出的四种方法。下面展示了如何使用 SAS 计算 SAS-GLM 的 I-III 型期望值，并演示了如何使用 SAS 来提供平方和期望的计算。表 <a href="chap18.html#tab:table18-2">18.2</a> 包含 SAS 代码，用于生成列 <span class="math inline">\(\boldsymbol Z_1\)</span>（由 <span class="math inline">\(\boldsymbol a_1\)</span> 和 <span class="math inline">\(\boldsymbol a_2\)</span> 表示）、<span class="math inline">\(\boldsymbol Z_1\)</span>（由 <span class="math inline">\(\boldsymbol b_1,\boldsymbol b_2\)</span> 和 <span class="math inline">\(\boldsymbol b_3\)</span> 表示）和 <span class="math inline">\(\boldsymbol Z_3\)</span>（由 <span class="math inline">\(\boldsymbol c_{11},\boldsymbol c_{12},\boldsymbol c_{13},\boldsymbol c_{21},\boldsymbol c_{22}\)</span> 和 <span class="math inline">\(\boldsymbol c_{23}\)</span> 表示），并使用 SAS-GLM 计算每列的三种类型的平方和。每列的平方和如表 <a href="chap18.html#tab:table18-3">18.3</a> 所示。由行导致的 I 型平方和期望值的计算为</p>
<p><span class="math display">\[\begin{aligned}
E[\mathrm{SSROW(I)}]=&amp;(1)\sigma_\varepsilon^2+(0.6429+0.2857+0.2857+0.2857+0.6429+0.2857)\sigma_c^2\\
&amp;+(0.0714+0.0714+0.000)\sigma_b^2+(3.500+3.500)\sigma_a^2 \\
=&amp;\sigma_\varepsilon^2+2.4284\sigma_c^2+0.1428\sigma_b^2+7\sigma_a^2
\end{aligned}\]</span></p>
<table>
<caption>
<span id="tab:table18-2">表 18.2: </span>图 <a href="chap18.html#fig:figure18-1">18.1</a> 中数据结构和表 <a href="chap19.html#tab:table19-2">19.2</a> 中的数据的 <span class="math inline">\([\boldsymbol Z_1,\boldsymbol Z_2,\boldsymbol Z_3]\)</span> 和 <span class="math inline">\(\boldsymbol y\)</span> 的每列的 I-III 型平方和的 SAS 代码
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2018.2.png">
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:table18-3">表 18.3: </span>图 <a href="chap18.html#fig:figure18-1">18.1</a> 中数据结构和表 <a href="chap19.html#tab:table19-2">19.2</a> 中的数据的 <span class="math inline">\([\boldsymbol Z_1,\boldsymbol Z_2,\boldsymbol Z_3]\)</span> 和 <span class="math inline">\(\boldsymbol y\)</span> 的每列的 I-III 型平方和
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2018.3.png">
</td>
</tr>
</tbody>
</table>
<p>各效应的平方和总和显示在表 <a href="chap18.html#tab:table18-4">18.4</a> 中。因此，表 <a href="chap18.html#tab:table18-5">18.5</a> 包含使用表 <a href="chap18.html#tab:table18-4">18.4</a> 中显示的摘要计算的剩余平方和的期望。可以计算每个预期平方和的系数，其中 <span class="math inline">\(\sigma^2_\varepsilon\)</span> 的系数是与相应平方和相关的自由度。</p>
<table>
<caption>
<span id="tab:table18-4">表 18.4: </span>使用表 <a href="chap18.html#tab:table18-3">18.3</a> 中的数据，针对每个效应，<span class="math inline">\([\boldsymbol Z_1,\boldsymbol Z_2,\boldsymbol Z_3]\)</span> 的每列的 I-III 型平方和之和
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2018.4.png">
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:table18-5">表 18.5: </span>使用 Hartley 综合法计算的 SAS I-III 型平方和的期望值
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2018.5.png">
</td>
</tr>
</tbody>
</table>
<p>在接下来讨论的统计文献中，有几种计算平方和的替代方法（附有名称）。讨论包含关于何时可以将这些技术应用于混合效应模型以及随机效应模型的指示。Henderson (1953) 介绍了四种计算平方和的方法，称为 Henderson’s methods I, II, III 和 IV （另见 Searle, 1987; Henderson, 1984). 以下讨论考虑了 Henderson’s methods I 和 II. 方差分析法或 Henderson’s methods I 仅适用于随机效应模型，是一种由计算平方和组成的技术，类似于为均衡数据集计算的平方和，不同之处在于它们被更改以考虑每个处理组合或不均衡数据集的不等数量的观测值。上面使用 Henderson’s methods I 平方和时未给出理由，下面给出理由。使用双向分类随机效应模型来演示该方法。</p>
<p>可用于描述均衡双向数据集的模型是</p>
<p><span class="math display">\[\begin{aligned}y_{ijk}&amp;=\mu+a_i+b_j+c_{ij}+\varepsilon_{ijk}&amp;&amp;i=1,2,\ldots,s,&amp;j=1,2,\ldots,t,&amp;k=1,2,\ldots,n\end{aligned}\]</span></p>
<p>其中</p>
<p><span class="math display">\[a_i\thicksim i.i.d.\mathrm{~N}(0,\sigma_a^2),\quad b_j\thicksim i.i.d.\mathrm{~N}(0,\sigma_b^2),\quad c_{ij}\thicksim i.i.d.\mathrm{~N}(0,\sigma_c^2),\quad\mathrm{and~}\quad\varepsilon_{ijk}\thicksim i.i.d.\mathrm{~N}(0,\sigma_\varepsilon^2)\]</span></p>
<p>方差分析中使用的平方和为</p>
<p><span class="math display">\[\begin{aligned}
\text{SSA}&amp; =nt\sum_{i=1}^{s}(\bar{y}_{i\cdot\cdot}-\bar{y}_{\cdot\cdot\cdot})^2=\sum_{i=1}^{s}\frac{y_{i\cdot\cdot}^2}{nt}-\frac{y_{\cdot\cdot\cdot}^2}{nst}  \\
\text{SSB}&amp; =ns\sum_{j=1}^t(\bar{y}_{\cdot j\cdot}-\bar{y}_{\cdot\cdot\cdot})^2=\sum_{j=1}^t\frac{y_{\cdot j\cdot}^2}{ns}-\frac{y_{\cdot\cdot\cdot}^2}{nst},  \\
\text{SSAB}&amp; =n\sum_{i=1}^s\sum_{j=1}^t(\bar{y}_{ij\cdot}-\bar{y}_{i\cdot\cdot}-\bar{y}_{\cdot j\cdot}+\bar{y}_{\cdot\cdot\cdot})^2  \\
&amp;=\sum_{i=1}^s\sum_{j=1}^t\frac{y_{ij\cdot}^2}n-\sum_{i=1}^s\frac{y_{i\cdot\cdot}^2}{nt}-\sum_{j=1}^t\frac{y_{\cdot j\cdot}^2}{ns}+\frac{y_{\cdot\cdot\cdot}^2}{nst}
\end{aligned}\]</span></p>
<p>要将这些平方和从等样本量转换为不等样本量，请将乘积 <span class="math inline">\(nst\)</span> 替换为 <span class="math inline">\(n_{\cdot\cdot}\)</span>，将 <span class="math inline">\(ns\)</span> 替换为 <span class="math inline">\(n_{\cdot j}\)</span>，将 <span class="math inline">\(nt\)</span> 替换为 <span class="math inline">\(n_{i\cdot }\)</span>. 因此，不等样本量的平方和变为</p>
<p><span class="math display">\[
\begin{aligned}
\text{SSA} &amp;=\sum_{i=1}^s\frac{y_{i\cdot\cdot}^2}{n_{i\cdot}}-\frac{y^2_{\cdot\cdot\cdot}}{n_{\cdot\cdot\cdot}}, \\
\text{SSB} &amp;=\sum_{j=1}^t\frac{y_{\cdot j\cdot}^2}{n_{\cdot j}}-\frac{y_{\cdot\cdot\cdot}^2}{n_{\cdot\cdot\cdot}}, \\
\text{S} SAB&amp;=\sum_{i=1}^s\sum_{j=1}^t\frac{y_{ij\cdot}^2}{n_{ij}}-\sum_{i=1}^s\frac{y_{i\cdot\cdot}^2}{n_{i\cdot}}-\sum_{j=1}^t\frac{y_{\cdot j \cdot}^2}{n_{\cdot j}}+\frac{y_{\cdot\cdot\cdot}^2}{n_{\cdot\cdot}}
\end{aligned}
\]</span></p>
<p>这些平方和是在讨论图 <a href="chap18.html#fig:figure18-1">18.1</a> 中数据结构之初所使用的。</p>
<p><strong>拟合常数法</strong> (fitting-constants method)，或 Henderson’s methods III，涉及将数据拟合到各种线性模型中，然后计算相应的平方和。该方法使用所谓的因拟合完全模型而导致的平方和减少以及因拟合各种子模型而导致的平方和减少（参见第 <a href="chap10.html#chap10">10</a> 章）。为了设定符号，考虑模型<a href="#fn25" class="footnote-ref" id="fnref25"><sup>25</sup></a></p>
<p><span class="math display">\[\boldsymbol y=\boldsymbol X_1\boldsymbol b_1+\boldsymbol X_2\boldsymbol b_2+\boldsymbol X_3\boldsymbol b_3+\boldsymbol\varepsilon \]</span></p>
<p>由于拟合完全模型而导致的总平方和的减少为</p>
<p><span class="math display">\[R(\boldsymbol b_1,\boldsymbol b_2,\boldsymbol b_3)=\boldsymbol y^{\prime}\boldsymbol y-\mathrm{SSERROR}(\boldsymbol b_1,\boldsymbol b_2,\boldsymbol b_3)\]</span></p>
<p>其中 <span class="math inline">\(\mathrm{SSERROR}(\boldsymbol b_1,\boldsymbol b_2,\boldsymbol b_3)\)</span> 是拟合完全模型后的残差平方和。由于拟合 <span class="math inline">\(\boldsymbol b_1\)</span> 和 <span class="math inline">\(\boldsymbol b_2\)</span> 导致的减少为 <span class="math inline">\(R(\boldsymbol b_1,\boldsymbol b_2)=\boldsymbol y^{\prime}\boldsymbol y-{\text{SSERROR}(\boldsymbol b_1,\boldsymbol b_2)}\)</span> 其中 <span class="math inline">\({\text{SSERROR}(\boldsymbol b_1,\boldsymbol b_2)}\)</span> 是模型 <span class="math inline">\(\boldsymbol y=\boldsymbol X_1 \boldsymbol b_1+\boldsymbol X_2 \boldsymbol b_2 + \boldsymbol \varepsilon\)</span> 的残差平方和。</p>
<p>拟合 <span class="math inline">\(\boldsymbol b_1\)</span> 和 <span class="math inline">\(\boldsymbol b_2\)</span> 后由于 <span class="math inline">\(\boldsymbol b_3\)</span> 造成的减少由 <span class="math inline">\(R(\boldsymbol b_3 |\boldsymbol b_1 , \boldsymbol b_2)\)</span> 表示，并由下式给出： <span class="math inline">\(R(\boldsymbol b_3 |\boldsymbol b_l , \boldsymbol b_2) = R(\boldsymbol b_1 , \boldsymbol b_2, \boldsymbol b_3) - R(\boldsymbol b_1 , \boldsymbol b_2) = \text{SSERROR}(\boldsymbol b_1, \boldsymbol b_2) - \text{SSERROR}(\boldsymbol b_1, \boldsymbol b_2, \boldsymbol b_3)\)</span>。同样，拟合 <span class="math inline">\(\boldsymbol b_2\)</span> 后由于 <span class="math inline">\(\boldsymbol b_1\)</span> 导致的减少为 <span class="math inline">\(R(\boldsymbol b_1 |\boldsymbol b_2) = R(\boldsymbol b_1, \boldsymbol b_2) - R(\boldsymbol b_2) = \text{SSERROR}(\boldsymbol b_2)-\text{SSERROR}(\boldsymbol b_1, \boldsymbol b_2)\)</span>。最后，拟合 <span class="math inline">\(\boldsymbol b_3\)</span> 后由于 <span class="math inline">\(\boldsymbol b_1\)</span> 和 <span class="math inline">\(\boldsymbol b_2\)</span> 导致的减少为 <span class="math inline">\(R(\boldsymbol b_1 , \boldsymbol b_2 |\boldsymbol b_3) = R(\boldsymbol b_1 , \boldsymbol b_2, \boldsymbol b_3) - R(\boldsymbol b_3) = \text{SSERROR}(\boldsymbol b_3) - \text{SSERROR}(\boldsymbol b_1, \boldsymbol b_2, \boldsymbol b_3)\)</span>.</p>
<p>使用此技术的优点之一是，<span class="math inline">\(E[R(\boldsymbol b_1 , \boldsymbol b_2 |\boldsymbol b_3)]\)</span> 不依赖于 <span class="math inline">\(\boldsymbol b_3\)</span>（如果它是固定效应）或 <span class="math inline">\(\sigma^2_\varepsilon\)</span>（如果它是随机效应），除非 <span class="math inline">\(\boldsymbol b_3\)</span> 表示 <span class="math inline">\(\boldsymbol b_1\)</span> 和 <span class="math inline">\(\boldsymbol b_2\)</span> 之间的交互作用或者与 <span class="math inline">\(\boldsymbol b_1\)</span> 或 <span class="math inline">\(\boldsymbol b_2\)</span> 的交互作用<a href="#fn26" class="footnote-ref" id="fnref26"><sup>26</sup></a>。</p>
<p>对于模型</p>
<p><span class="math display">\[\boldsymbol y=\boldsymbol j  \mu+\boldsymbol X_1\boldsymbol b+\boldsymbol X_2\boldsymbol t+\boldsymbol X_3\boldsymbol g+\boldsymbol \varepsilon \]</span></p>
<p>其中 <span class="math inline">\(\boldsymbol{b}\sim N(0,\sigma_b^2),\boldsymbol{t}\sim N(0,\sigma_t^2),\boldsymbol{g}\sim N(0,\sigma_g^2)\)</span> 以及 <span class="math inline">\(\boldsymbol{\varepsilon}\sim N(0,\sigma_\varepsilon^2)\)</span>，一组可能的平方和（来自 SAS-GLM 和 SAS-MIXED 的 I 型平方和）为</p>
<p><span class="math display">\[\begin{aligned}
&amp;R(\boldsymbol b| \mu)=R( \mu,\boldsymbol b)-R( \mu) \\
&amp;R(\boldsymbol t| \mu,\boldsymbol b)=R( \mu,\boldsymbol b,\boldsymbol t)-R( \mu,\boldsymbol b) \\
&amp;R(\boldsymbol g| \mu,\boldsymbol b,\boldsymbol t)=R( \mu,\boldsymbol b,\boldsymbol t,\boldsymbol g)-R( \mu,\boldsymbol b,\boldsymbol t) \\
&amp;\mathrm{SSERROR}( \mu,\boldsymbol b,\boldsymbol t,\boldsymbol g)]=\boldsymbol y^{\prime}\boldsymbol y-R( \mu,\boldsymbol b,\boldsymbol t,\boldsymbol g)
\end{aligned}\]</span></p>
<p>这些平方和的期望具有以下形式</p>
<p><span class="math display">\[\begin{aligned}
&amp;E[\text{SSERROR}( \mu,\boldsymbol b,\boldsymbol t,\boldsymbol g)]=(n-p)\sigma_\varepsilon^2 \\
&amp;E[R(\boldsymbol g| \mu,\boldsymbol b,\boldsymbol t)]=k_1\sigma_\varepsilon^2+k_2\sigma_g^2 \\
&amp;E[R(\boldsymbol t| \mu,\boldsymbol b)]=k_3\sigma_\varepsilon^2+k_4\sigma_g^2+k_5\sigma_t^2, \\
&amp;E[R(\boldsymbol b| \mu)]=k_6\sigma_\varepsilon^2+k_7\sigma_g^2+k_8\sigma_t^2+k_9\sigma_b^2
\end{aligned}\]</span></p>
<p>也可以使用由 <span class="math inline">\(R(\boldsymbol t| \mu),R(\boldsymbol b| \mu, \boldsymbol t),R(\boldsymbol g| \mu, \boldsymbol b, \boldsymbol t)\)</span> 和 <span class="math inline">\(\text{SSERROR}( \mu,\boldsymbol b,\boldsymbol t, \boldsymbol g)\)</span> 给出的 I 型平方和，拟合常数法可以用于随机效应和混合效应模型，只要固定效应先于随机效应拟合即可。</p>
<p>综合法可用于评估涉及随机效应和/或多个误差项的任何模型的平方和的期望。一组平方和及其期望（或均方）可用于估计方差分量，以开发假设检验，并构造关于各个方差分量和/或方差分量函数的置信区间。第 <a href="chap19.html#chap19">19</a> 章讨论了估计方法，第 <a href="chap20.html#chap20">20</a> 章介绍了推断技术。许多统计软件程序自动使用 Hartley 综合法来计算期望均方 (expected mean squares).</p>
</div>
</div>
<div id="sec18-4" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> 结束语<a href="chap18.html#sec18-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>本章定义了随机效应和固定效应的概念以及随机效应模型的概念。随机效应模型以矩阵形式表示，以描述计算期望均方的方法。采用完全随机设计结构中不均衡单向处理结构来演示计算期望均方的代数方法和 Hartley’s 综合法。描述了计算平方和的不同方法，并使用完全随机设计结构中不均衡双向处理结构来演示各自期望均方的计算。提供 SAS 代码来演示 Hartley’s 综合法。</p>
</div>
<div id="sec18-5" class="section level2 hasAnchor" number="18.5">
<h2><span class="header-section-number">18.5</span> 练习<a href="chap18.html#sec18-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="22">
<li id="fn22"><p>原文：The general random effects model will have r random components representing the main effects and interactions for the random effect factors of the treatment structure and for those factors used to describe the design structure as well as possible interactions between components of the design and treatment structures used to describe the necessary error terms.<a href="chap18.html#fnref22" class="footnote-back">↩︎</a></p></li>
<li id="fn23"><p>是前文 “the sum of squares within levels of the random effect” 的简写。<a href="chap18.html#fnref23" class="footnote-back">↩︎</a></p></li>
<li id="fn24"><p>是前文 “the sum of squares between the levels of the random effect” 的简写。<a href="chap18.html#fnref24" class="footnote-back">↩︎</a></p></li>
<li id="fn25"><p>原书上下文并没有给出这些符号的意义，也令译者一头雾水。尤其下方的 “<span class="math inline">\(\boldsymbol{b}\sim N(0,\sigma_b^2),\boldsymbol{t}\sim N(0,\sigma_t^2),\boldsymbol{g}\sim N(0,\sigma_g^2)\)</span>”，原书中这些变量确实是加粗字体，但其分布并没有表示为多元正态分布的形式。<a href="chap18.html#fnref25" class="footnote-back">↩︎</a></p></li>
<li id="fn26"><p>原文：unless <span class="math inline">\(\boldsymbol b_3\)</span> denotes an interaction between <span class="math inline">\(\boldsymbol b_1\)</span> and <span class="math inline">\(\boldsymbol b_2\)</span> or an interaction with <span class="math inline">\(\boldsymbol b_1\)</span> or <span class="math inline">\(\boldsymbol b_2\)</span>.<a href="chap18.html#fnref26" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap17.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap19.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": false,
"smooth_scroll": false,
"search": {
"engine": "lunr"
}
},
"toc_float": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
