<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 6 章 交叉设计分析 | 混乱数据分析：设计的实验</title>
  <meta name="description" content="Analysis of Messy Data Volume 1: Designed Experiments的翻译" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="第 6 章 交叉设计分析 | 混乱数据分析：设计的实验" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Analysis of Messy Data Volume 1: Designed Experiments的翻译" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 6 章 交叉设计分析 | 混乱数据分析：设计的实验" />
  
  <meta name="twitter:description" content="Analysis of Messy Data Volume 1: Designed Experiments的翻译" />
  

<meta name="author" content="Wang Zhen" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap5.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      TeX: {
        Macros: {
          bm: ["{\\boldsymbol #1}",1],
        },
        extensions: ["cancel.js"]
      }
    });
</script>

<!-- add line break after theorem title -->
<script>
  document.addEventListener("DOMContentLoaded", (event) => {
    for (let s of document.querySelectorAll("span.theorem, span.lemma, span.proposition, span.corollary")) {
      s.insertAdjacentHTML('afterend', '<br style="line-height:2px;"/>');
    }
  });
</script>

<!-- check if --themcolor in style.css matches one of elegantbook theme colors. If so, generates the color palette  -->
<script>
  document.addEventListener("DOMContentLoaded", (event) => {
    const cssroot = document.querySelector(':root');
    let theme_color = getComputedStyle(document.documentElement).getPropertyValue('--themecolor').trim();
  
    // blue is the default option

    switch (theme_color) {
      case 'green': 
        cssroot.style.setProperty('--structurecolor', 'rgb(0,120,2)');
        cssroot.style.setProperty('--main', 'rgb(70,70,70)');
        cssroot.style.setProperty('--mainbg', 'rgba(0,166,82,0.05)');
        cssroot.style.setProperty('--second', 'rgb(115,45,2)');
        cssroot.style.setProperty('--secondbg', 'rgba(115,45,2,0.05)');
        cssroot.style.setProperty('--third', 'rgb(0,80,80)');
        cssroot.style.setProperty('--thirdbg', 'rgba(0,80,80,0.05)');
      break;
      case 'cyan':
        cssroot.style.setProperty('--structurecolor', 'rgb(31,186,190)');
        cssroot.style.setProperty('--main', 'rgb(59,180,5)');
        cssroot.style.setProperty('--mainbg', 'rgba(59,180,5,0.05)');
        cssroot.style.setProperty('--second', 'rgb(175,153,8)');
        cssroot.style.setProperty('--secondbg', 'rgba(175,153,8,0.05)');
        cssroot.style.setProperty('--third', 'rgb(244,105,102)');
        cssroot.style.setProperty('--thirdbg', 'rgba(244,105,102,0.05)');
      break;
      case 'gray':
        cssroot.style.setProperty('--structurecolor', 'rgb(150,150,150)');
        cssroot.style.setProperty('--main', 'rgb(150,150,150)');
        cssroot.style.setProperty('--mainbg', 'rgba(150,150,150,0.05)');
        cssroot.style.setProperty('--second', 'rgb(150,150,150)');
        cssroot.style.setProperty('--secondbg', 'rgba(150,150,150,0.05)');
        cssroot.style.setProperty('--third', 'rgb(150,150,150)');
        cssroot.style.setProperty('--thirdbg', 'rgba(150,150,150,0.05)');
      break;
      case 'black':
        cssroot.style.setProperty('--structurecolor', 'rgb(0,0,0)');
        cssroot.style.setProperty('--main', 'rgb(0,0,0)');
        cssroot.style.setProperty('--mainbg', 'rgba(0,0,0,0.05)');
        cssroot.style.setProperty('--second', 'rgb(0,0,0)');
        cssroot.style.setProperty('--secondbg', 'rgba(0,0,0,0.05)');
        cssroot.style.setProperty('--third', 'rgb(0,0,0)');
        cssroot.style.setProperty('--thirdbg', 'rgba(0,0,0,0.05)');
      break;
    default:
        cssroot.style.setProperty('--structurecolor', 'rgb(60,113,183)');
        cssroot.style.setProperty('--main', 'rgb(0,166,82)');
        cssroot.style.setProperty('--mainbg', 'rgba(0,166,82,0.05)');
        cssroot.style.setProperty('--second', 'rgb(255,134,24)');
        cssroot.style.setProperty('--secondbg', 'rgba(255,134,24,0.05)');
        cssroot.style.setProperty('--third', 'rgb(0,174,247)');
        cssroot.style.setProperty('--thirdbg', 'rgba(0,174,247,0.05)');
    }
  });
  </script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">混乱数据分析：设计的实验</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="chap1.html"><a href="chap1.html"><i class="fa fa-check"></i><b>1</b> 最简单的情况：具有同质误差的完全随机设计结构中的单向处理结构</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chap1.html"><a href="chap1.html#sec1-1"><i class="fa fa-check"></i><b>1.1</b> 模型定义和假设</a></li>
<li class="chapter" data-level="1.2" data-path="chap1.html"><a href="chap1.html#sec1-2"><i class="fa fa-check"></i><b>1.2</b> 参数估计</a></li>
<li class="chapter" data-level="1.3" data-path="chap1.html"><a href="chap1.html#sec1-3"><i class="fa fa-check"></i><b>1.3</b> 线性组合的推断：检验与置信区间</a></li>
<li class="chapter" data-level="1.4" data-path="chap1.html"><a href="chap1.html#sec1-4"><i class="fa fa-check"></i><b>1.4</b> 示例：任务和脉搏率</a></li>
<li class="chapter" data-level="1.5" data-path="chap1.html"><a href="chap1.html#sec1-5"><i class="fa fa-check"></i><b>1.5</b> 几种线性组合的联合检验</a></li>
<li class="chapter" data-level="1.6" data-path="chap1.html"><a href="chap1.html#sec1-6"><i class="fa fa-check"></i><b>1.6</b> 示例：任务和脉搏率（续）</a></li>
<li class="chapter" data-level="1.7" data-path="chap1.html"><a href="chap1.html#sec1-7"><i class="fa fa-check"></i><b>1.7</b> 检验所有均值相等</a></li>
<li class="chapter" data-level="1.8" data-path="chap1.html"><a href="chap1.html#sec1-8"><i class="fa fa-check"></i><b>1.8</b> 示例：任务和脉搏率（续）</a></li>
<li class="chapter" data-level="1.9" data-path="chap1.html"><a href="chap1.html#sec1-9"><i class="fa fa-check"></i><b>1.9</b> 比较两种模型的一般方法：条件误差原理</a></li>
<li class="chapter" data-level="1.10" data-path="chap1.html"><a href="chap1.html#sec1-10"><i class="fa fa-check"></i><b>1.10</b> 示例：任务和脉搏率（续）</a></li>
<li class="chapter" data-level="1.11" data-path="chap1.html"><a href="chap1.html#sec1-11"><i class="fa fa-check"></i><b>1.11</b> 计算机分析</a></li>
<li class="chapter" data-level="1.12" data-path="chap1.html"><a href="chap1.html#sec1-12"><i class="fa fa-check"></i><b>1.12</b> 结束语</a></li>
<li class="chapter" data-level="1.13" data-path="chap1.html"><a href="chap1.html#sec1-13"><i class="fa fa-check"></i><b>1.13</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap2.html"><a href="chap2.html"><i class="fa fa-check"></i><b>2</b> 具有异质误差的完全随机设计结构中的单向处理结构</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chap2.html"><a href="chap2.html#sec2-1"><i class="fa fa-check"></i><b>2.1</b> 模型定义和假设</a></li>
<li class="chapter" data-level="2.2" data-path="chap2.html"><a href="chap2.html#sec2-2"><i class="fa fa-check"></i><b>2.2</b> 参数估计</a></li>
<li class="chapter" data-level="2.3" data-path="chap2.html"><a href="chap2.html#sec2-3"><i class="fa fa-check"></i><b>2.3</b> 方差齐性检验</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chap2.html"><a href="chap2.html#sec2-3-1"><i class="fa fa-check"></i><b>2.3.1</b> Hartley’s <em>F</em>-Max Test</a></li>
<li class="chapter" data-level="2.3.2" data-path="chap2.html"><a href="chap2.html#sec2-3-2"><i class="fa fa-check"></i><b>2.3.2</b> Bartlett’s Test</a></li>
<li class="chapter" data-level="2.3.3" data-path="chap2.html"><a href="chap2.html#sec2-3-3"><i class="fa fa-check"></i><b>2.3.3</b> Levene’s Test</a></li>
<li class="chapter" data-level="2.3.4" data-path="chap2.html"><a href="chap2.html#sec2-4-4"><i class="fa fa-check"></i><b>2.3.4</b> Brown and Forsythe’s Test</a></li>
<li class="chapter" data-level="2.3.5" data-path="chap2.html"><a href="chap2.html#sec2-3-5"><i class="fa fa-check"></i><b>2.3.5</b> O’Brien’s Test</a></li>
<li class="chapter" data-level="2.3.6" data-path="chap2.html"><a href="chap2.html#sec2-3-6"><i class="fa fa-check"></i><b>2.3.6</b> 一些建议</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chap2.html"><a href="chap2.html#sec2-4"><i class="fa fa-check"></i><b>2.4</b> 示例：药物和错误</a></li>
<li class="chapter" data-level="2.5" data-path="chap2.html"><a href="chap2.html#sec2-5"><i class="fa fa-check"></i><b>2.5</b> 关于线性组合的推断</a></li>
<li class="chapter" data-level="2.6" data-path="chap2.html"><a href="chap2.html#sec2-6"><i class="fa fa-check"></i><b>2.6</b> 示例：药物和错误（续）</a></li>
<li class="chapter" data-level="2.7" data-path="chap2.html"><a href="chap2.html#sec2-7"><i class="fa fa-check"></i><b>2.7</b> 自由度的一般 Satterthwaite 近似</a></li>
<li class="chapter" data-level="2.8" data-path="chap2.html"><a href="chap2.html#sec2-8"><i class="fa fa-check"></i><b>2.8</b> 比较所有均值</a></li>
<li class="chapter" data-level="2.9" data-path="chap2.html"><a href="chap2.html#sec2-9"><i class="fa fa-check"></i><b>2.9</b> 结束语</a></li>
<li class="chapter" data-level="2.10" data-path="chap2.html"><a href="chap2.html#sec2-10"><i class="fa fa-check"></i><b>2.10</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap3.html"><a href="chap3.html"><i class="fa fa-check"></i><b>3</b> 联合推断程序和多重比较</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chap3.html"><a href="chap3.html#sec3-1"><i class="fa fa-check"></i><b>3.1</b> 错误率</a></li>
<li class="chapter" data-level="3.2" data-path="chap3.html"><a href="chap3.html#sec3-2"><i class="fa fa-check"></i><b>3.2</b> 建议</a></li>
<li class="chapter" data-level="3.3" data-path="chap3.html"><a href="chap3.html#sec3-3"><i class="fa fa-check"></i><b>3.3</b> 最小显著差异</a></li>
<li class="chapter" data-level="3.4" data-path="chap3.html"><a href="chap3.html#sec3-4"><i class="fa fa-check"></i><b>3.4</b> Fisher’s LSD Procedure</a></li>
<li class="chapter" data-level="3.5" data-path="chap3.html"><a href="chap3.html#sec3-5"><i class="fa fa-check"></i><b>3.5</b> Bonferroni’s Method</a></li>
<li class="chapter" data-level="3.6" data-path="chap3.html"><a href="chap3.html#sec3-6"><i class="fa fa-check"></i><b>3.6</b> Scheffé’s Procedure</a></li>
<li class="chapter" data-level="3.7" data-path="chap3.html"><a href="chap3.html#sec3-7"><i class="fa fa-check"></i><b>3.7</b> Tukey–Kramer Method</a></li>
<li class="chapter" data-level="3.8" data-path="chap3.html"><a href="chap3.html#sec3-8"><i class="fa fa-check"></i><b>3.8</b> 模拟方法</a></li>
<li class="chapter" data-level="3.9" data-path="chap3.html"><a href="chap3.html#sec3-9"><i class="fa fa-check"></i><b>3.9</b> Šidák Procedure</a></li>
<li class="chapter" data-level="3.10" data-path="chap3.html"><a href="chap3.html#sec3-10"><i class="fa fa-check"></i><b>3.10</b> 示例：成对比较</a></li>
<li class="chapter" data-level="3.11" data-path="chap3.html"><a href="chap3.html#sec3-11"><i class="fa fa-check"></i><b>3.11</b> Dunnett’s Procedure</a></li>
<li class="chapter" data-level="3.12" data-path="chap3.html"><a href="chap3.html#sec3-12"><i class="fa fa-check"></i><b>3.12</b> 示例：与对照比较</a></li>
<li class="chapter" data-level="3.13" data-path="chap3.html"><a href="chap3.html#sec3-13"><i class="fa fa-check"></i><b>3.13</b> 多元 <span class="math inline">\(t\)</span></a></li>
<li class="chapter" data-level="3.14" data-path="chap3.html"><a href="chap3.html#sec3-14"><i class="fa fa-check"></i><b>3.14</b> 示例：线性独立比较</a></li>
<li class="chapter" data-level="3.15" data-path="chap3.html"><a href="chap3.html#sec3-15"><i class="fa fa-check"></i><b>3.15</b> 序贯拒绝方法</a>
<ul>
<li class="chapter" data-level="3.15.1" data-path="chap3.html"><a href="chap3.html#sec3-15-1"><i class="fa fa-check"></i><b>3.15.1</b> Bonferroni–Holm Method</a></li>
<li class="chapter" data-level="3.15.2" data-path="chap3.html"><a href="chap3.html#sec3-15-2"><i class="fa fa-check"></i><b>3.15.2</b> Šidák–Holm Method</a></li>
<li class="chapter" data-level="3.15.3" data-path="chap3.html"><a href="chap3.html#sec3-15-3"><i class="fa fa-check"></i><b>3.15.3</b> 控制 FDR 的 Benjamini 和 Hochberg Method</a></li>
</ul></li>
<li class="chapter" data-level="3.16" data-path="chap3.html"><a href="chap3.html#sec3-16"><i class="fa fa-check"></i><b>3.16</b> 示例：线性相关比较</a></li>
<li class="chapter" data-level="3.17" data-path="chap3.html"><a href="chap3.html#sec3-17"><i class="fa fa-check"></i><b>3.17</b> 多重极差检验</a>
<ul>
<li class="chapter" data-level="3.17.1" data-path="chap3.html"><a href="chap3.html#sec3-17-1"><i class="fa fa-check"></i><b>3.17.1</b> Student–Newman–Keul’s Method</a></li>
<li class="chapter" data-level="3.17.2" data-path="chap3.html"><a href="chap3.html#sec3-17-2"><i class="fa fa-check"></i><b>3.17.2</b> Duncan’s New Multiple Range Method</a></li>
</ul></li>
<li class="chapter" data-level="3.18" data-path="chap3.html"><a href="chap3.html#sec3-18"><i class="fa fa-check"></i><b>3.18</b> Waller–Duncan Procedure</a></li>
<li class="chapter" data-level="3.19" data-path="chap3.html"><a href="chap3.html#sec3-19"><i class="fa fa-check"></i><b>3.19</b> 示例：成对比较的多重极差</a></li>
<li class="chapter" data-level="3.20" data-path="chap3.html"><a href="chap3.html#sec3-20"><i class="fa fa-check"></i><b>3.20</b> 警示</a></li>
<li class="chapter" data-level="3.21" data-path="chap3.html"><a href="chap3.html#sec3-21"><i class="fa fa-check"></i><b>3.21</b> 结束语</a></li>
<li class="chapter" data-level="3.22" data-path="chap3.html"><a href="chap3.html#sec3-22"><i class="fa fa-check"></i><b>3.22</b> 练习</a></li>
<li class="chapter" data-level="" data-path="chap3.html"><a href="chap3.html#参考文献"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap4.html"><a href="chap4.html"><i class="fa fa-check"></i><b>4</b> 实验设计基础</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chap4.html"><a href="chap4.html#sec4-1"><i class="fa fa-check"></i><b>4.1</b> 介绍基本概念</a></li>
<li class="chapter" data-level="4.2" data-path="chap4.html"><a href="chap4.html#sec4-2"><i class="fa fa-check"></i><b>4.2</b> 设计实验的结构</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="chap4.html"><a href="chap4.html#sec4-2-1"><i class="fa fa-check"></i><b>4.2.1</b> 设计结构类型</a></li>
<li class="chapter" data-level="4.2.2" data-path="chap4.html"><a href="chap4.html#sec4-2-2"><i class="fa fa-check"></i><b>4.2.2</b> 处理结构类型</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chap4.html"><a href="chap4.html#sec4-3"><i class="fa fa-check"></i><b>4.3</b> 不同设计实验的示例</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chap4.html"><a href="chap4.html#sec4-3-1"><i class="fa fa-check"></i><b>4.3.1</b> 示例 4.1: 饮食</a></li>
<li class="chapter" data-level="4.3.2" data-path="chap4.html"><a href="chap4.html#sec4-3-2"><i class="fa fa-check"></i><b>4.3.2</b> 示例 4.2: 房屋油漆</a></li>
<li class="chapter" data-level="4.3.3" data-path="chap4.html"><a href="chap4.html#sec4-3-3"><i class="fa fa-check"></i><b>4.3.3</b> 示例 4.3: 钢板</a></li>
<li class="chapter" data-level="4.3.4" data-path="chap4.html"><a href="chap4.html#sec4-3-4"><i class="fa fa-check"></i><b>4.3.4</b> 示例 4.4: 氮和钾的水平</a></li>
<li class="chapter" data-level="4.3.5" data-path="chap4.html"><a href="chap4.html#sec4-3-5"><i class="fa fa-check"></i><b>4.3.5</b> 示例 4.5: 区组和重复</a></li>
<li class="chapter" data-level="4.3.6" data-path="chap4.html"><a href="chap4.html#sec4-3-6"><i class="fa fa-check"></i><b>4.3.6</b> 示例 4.6：行区组和列区组</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chap4.html"><a href="chap4.html#sec4-4"><i class="fa fa-check"></i><b>4.4</b> 结束语</a></li>
<li class="chapter" data-level="4.5" data-path="chap4.html"><a href="chap4.html#sec4-5"><i class="fa fa-check"></i><b>4.5</b> 练习</a></li>
<li class="chapter" data-level="" data-path="chap4.html"><a href="chap4.html#参考文献-1"><i class="fa fa-check"></i>参考文献</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap5.html"><a href="chap5.html"><i class="fa fa-check"></i><b>5</b> 多水平设计：裂区、裂条、重复测量及组合</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chap5.html"><a href="chap5.html#sec5-1"><i class="fa fa-check"></i><b>5.1</b> 实验单元的尺寸识别——四种基本设计结构</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap29.html"><a href="chap29.html"><i class="fa fa-check"></i><b>6</b> 交叉设计分析</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chap29.html"><a href="chap29.html#sec29-1"><i class="fa fa-check"></i><b>6.1</b> 定义，假设和模型</a></li>
<li class="chapter" data-level="6.2" data-path="chap29.html"><a href="chap29.html#sec29-2"><i class="fa fa-check"></i><b>6.2</b> 两时期/两处理交叉设计</a></li>
<li class="chapter" data-level="6.3" data-path="chap29.html"><a href="chap29.html#sec29-3"><i class="fa fa-check"></i><b>6.3</b> 具有两个以上时期的交叉设计</a></li>
<li class="chapter" data-level="6.4" data-path="chap29.html"><a href="chap29.html#sec29-4"><i class="fa fa-check"></i><b>6.4</b> 具有两种以上处理的交叉设计</a></li>
<li class="chapter" data-level="6.5" data-path="chap29.html"><a href="chap29.html#sec29-5"><i class="fa fa-check"></i><b>6.5</b> 小结</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">混乱数据分析：设计的实验</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap29" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">第 6 章</span> 交叉设计分析<a href="chap29.html#chap29" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>交叉设计 (crossover design) 用于比较按序列给予实验单元（如动物或人）的处理。也就是说，每个实验单元按照预定的序列进行每种处理。交叉设计的目的是通过观察应用于同一实验单元的处理，消除比较处理时实验单元之间的差异。</p>
<p>尽管交叉设计消除了处理比较中实验单元之间的差异，但其他问题可能会以<strong>延滞</strong> (carryover) 或<strong>残余</strong> (residual) 效应的形式出现。例如，当首先给予处理 <span class="math inline">\(A\)</span> 并且在应用处理 <span class="math inline">\(B\)</span> 时其效应尚未消失，就会出现延滞效应。如果 <span class="math inline">\(A\)</span> 的延滞效应干扰了个体对处理 <span class="math inline">\(B\)</span> 的响应（或正向或负向），那么处理 <span class="math inline">\(A\)</span> 对处理 <span class="math inline">\(B\)</span> 有延滞效应。</p>
<p>交叉设计模型必须包含序列效应、时期效应、处理效应、延滞效应、实验单元误差项和时间间隔误差项。第一节讨论了一般模型及其假设，最后两节分别讨论了两个时期和两个以上时期两个处理的交叉设计。</p>
<p>在一般的交叉设计中，比较 <span class="math inline">\(t\)</span> 个处理，其中在每个实验单元上观察每个处理；也就是说，这些处理以特定的序列应用于实验单元。实验者构建 <span class="math inline">\(t\)</span> 个处理的 <span class="math inline">\(s\)</span> 个序列，并将实验单元随机分配给第 <span class="math inline">\(i\)</span> 个序列。表 <a href="chap29.html#tab:table29-1">6.1</a> 包含一组可应用于实验单元的三种处理的序列。将序列分配给个体（可能的实验单元）意味着个体是序列的实验单元；将处理分配给时间间隔意味着该时间间隔是处理的实验单元。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-1">表 6.1: </span>对实验单元应用三种处理（A、B 和 C）的可能序列集
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.1.png">
</td>
</tr>
</tbody>
</table>
<div id="sec29-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> 定义，假设和模型<a href="chap29.html#sec29-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>描述在第 <span class="math inline">\(i\)</span> 个时期内分配给第 <span class="math inline">\(j\)</span> 个序列的第 <span class="math inline">\(\ell\)</span> 只动物的观测结果的响应的模型为</p>
<p><span class="math display" id="eq:29-1">\[\begin{align}
y_{ijk\ell}&amp;=\mu+S_i+\delta_{i\ell}+P_j+T_k+\varepsilon_{ijk\ell}\\i&amp;=1,2,\ldots,s,j=1,2,\ldots,p,k=1,2,\ldots,t,\mathrm{~and~}\ell=1,2,\ldots,n_j
\tag{6.1}
\end{align}\]</span></p>
<p>在上述模型中，<span class="math inline">\(S_i\)</span> 是第 <span class="math inline">\(i\)</span> 个序列的效应，<span class="math inline">\(P_j\)</span> 是第 <span class="math inline">\(j\)</span> 个时期的效应，<span class="math inline">\(T_k\)</span> 是第 <span class="math inline">\(k\)</span> 个处理的效应，其中 <span class="math inline">\(k\)</span> 的值由第 <span class="math inline">\(i\)</span> 个序列和第 <span class="math inline">\(j\)</span> 个时期的 <span class="math inline">\(i,j\)</span> 组合确定。在理想条件下，将有 <span class="math inline">\(\delta_{i\ell}\sim i.i.d.N(0,\sigma_{\delta}^{2}),\varepsilon_{ijk\ell}\sim i.i.d.N(0,\sigma_{\varepsilon}^{2})\)</span>，并且所有 <span class="math inline">\(\delta_{i\ell}\)</span> 和 <span class="math inline">\(\varepsilon_{ijk\ell}\)</span> 彼此独立。</p>
<p>误差项 <span class="math inline">\(\delta_{i\ell}\)</span> 和 <span class="math inline">\(\varepsilon_{ijk\ell}\)</span> 的理想条件对于进行适当的分析非常重要。由于实验单元是随机分配给序列的，因此适当的假设是 <span class="math inline">\(\delta_{i\ell}\sim i.i.d.N(0,\sigma_{\delta}^{2})\)</span>. 由于 <span class="math inline">\(\varepsilon_{ijk\ell}\)</span> 是时间间隔的误差，并且在某种意义上是重复测量误差，因此这些误差可能不是独立分布的。上面给出的理想条件相当于假设时间时期误差的协方差阵满足复合对称条件（参见 <a href="#sec27-1"><strong>??</strong></a> 节）。在这种情况下，可以使用通常的独立的 <span class="math inline">\(\delta_{i\ell}\)</span> 和 <span class="math inline">\(\varepsilon_{ijk\ell}\)</span> 方差分析方法来分析观测数据。复合对称性假设对于两时期设计是必须满足的，对于许多三时期设计也可能是满足的。时间序列误差结构可能更适合具有三个或更多时期的交叉设计，并且应该使用第 <a href="#chap27"><strong>??</strong></a> 章中讨论的方法。</p>
<p>两时期/两处理交叉设计 (two-period/two-treatment crossover design) 在 <a href="chap29.html#sec29-2">6.2</a> 节中描述，具有两个以上处理或两个以上时期的设计在 <a href="chap29.html#sec29-3">6.3</a> 和 <a href="chap29.html#sec29-4">6.4</a> 节中描述。</p>
</div>
<div id="sec29-2" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> 两时期/两处理交叉设计<a href="chap29.html#sec29-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>考虑具有两个处理序列（<span class="math inline">\(AB\)</span> 和 <span class="math inline">\(BA\)</span>）的两时期/两处理交叉设计，其中 <span class="math inline">\(AB\)</span> 意味着处理 <span class="math inline">\(A\)</span> 在第 <span class="math inline">\(1\)</span> 时期分配到一个实验单元，处理 <span class="math inline">\(B\)</span> 在第 <span class="math inline">\(2\)</span> 时期分配到同一实验单元。同样，<span class="math inline">\(BA\)</span> 序列意味着处理 <span class="math inline">\(B\)</span> 在时期 <span class="math inline">\(1\)</span> 被分配到实验单元，处理 <span class="math inline">\(A\)</span> 在时期 <span class="math inline">\(2\)</span> 被分配给相同的实验单元。还假设有 <span class="math inline">\(n_1\)</span> 个实验单元分配给 <span class="math inline">\(AB\)</span> 序列，且有 <span class="math inline">\(n_2\)</span> 个实验单元分配给 <span class="math inline">\(BA\)</span> 序列。令观测到的响应的模型为</p>
<p><span class="math display" id="eq:29-2">\[\begin{align}
y_{ijk\ell}&amp;=\mu+S_i+\delta_{i\ell}+P_j+T_k+\varepsilon_{ijk\ell}\\i&amp;=AB,BA,~j=1,2,~k=A,B,~\mathrm{and}~\ell=1,2,\ldots,n_i
\tag{6.2}
\end{align}\]</span></p>
<p>其中下标 <span class="math inline">\(k\)</span> 的值由序列 <span class="math inline">\(i\)</span> 和时期 <span class="math inline">\(j\)</span> 的组合确定。令</p>
<p><span class="math display">\[\mu_{ij}=\mu+S_i+P_j+T_k\]</span></p>
<p>是对应于第 <span class="math inline">\(i\)</span> 个序列和第 <span class="math inline">\(j\)</span> 个时期的单元均值的模型。令 <span class="math inline">\(\hat \mu_{ij}\)</span> 为第 <span class="math inline">\((i,j)\)</span> 单元格中所有观测值的观测均值。注意到</p>
<p><span class="math display" id="eq:29-3">\[\begin{align}
\hat \mu_{11}=\bar y_{11\cdot\cdot}\,\mathrm{estimates}\,\mu+S_{AB}+P_1+T_A\\
\hat \mu_{12}=\bar y_{12\cdot\cdot}\,\mathrm{estimates}\,\mu+S_{AB}+P_2+T_B\\
\hat \mu_{21}=\bar y_{21\cdot\cdot}\,\mathrm{estimates}\,\mu+S_{BA}+P_1+T_B\\
\hat \mu_{22}=\bar y_{22\cdot\cdot}\,\mathrm{estimates}\,\mu+S_{BA}+P_2+T_A
\tag{6.3}
\end{align}\]</span></p>
<p>从式 <a href="chap29.html#eq:29-3">(6.3)</a> 可看出</p>
<p><span class="math display" id="eq:29-4">\[\begin{align}
\hat {\bar\mu}_{1\cdot}&amp;=\frac{\bar y_{11\cdot\cdot}+\bar y_{12\cdot\cdot}}{2}\,\mathrm{estimates}\,\mu+S_{AB}+\bar P_\cdot+\frac{T_A+T_B}{2}\\
\hat {\bar\mu}_{2\cdot}&amp;=\frac{\bar y_{21\cdot\cdot}+\bar y_{22\cdot\cdot}}{2}\,\mathrm{estimates}\,\mu+S_{BA}+\bar P_\cdot+\frac{T_A+T_B}{2}\\
\hat {\bar\mu}_{\cdot 1}&amp;=\frac{\bar y_{11\cdot\cdot}+\bar y_{21\cdot\cdot}}{2}\,\mathrm{estimates}\,\mu+\bar S_{\cdot}+\bar P_1+\frac{T_A+T_B}{2}\\
\hat {\bar\mu}_{\cdot 2}&amp;=\frac{\bar y_{12\cdot\cdot}+\bar y_{22\cdot\cdot}}{2}\,\mathrm{estimates}\,\mu+\bar S_{\cdot}+\bar P_2+\frac{T_A+T_B}{2}
\tag{6.4}
\end{align}\]</span></p>
<p>另请注意，两个序列的均值差 <span class="math inline">\(\hat {\bar\mu}_{1\cdot}-\hat {\bar\mu}_{2\cdot}\)</span> 估计 <span class="math inline">\(S_{AB} - S_{BA}\)</span>，即两个序列参数之差。时期 <span class="math inline">\(1\)</span> 和时期 <span class="math inline">\(2\)</span> 的均值差 <span class="math inline">\(\hat {\bar\mu}_{\cdot1}-\hat {\bar\mu}_{\cdot2}\)</span> 估计 <span class="math inline">\(P_1 - P_2\)</span>. 最后，为了估计两种处理之差 <span class="math inline">\(T_A - T_B\)</span>，可以使用 <span class="math inline">\((\hat {\bar\mu}_{11}-\hat {\bar\mu}_{12}-\hat {\bar\mu}_{21}+\hat {\bar\mu}_{22})/2\)</span> 。在理想条件下，可以证明</p>
<p><span class="math display" id="eq:29-5">\[\begin{equation}
\begin{bmatrix}\hat{\mu}_{11}\\\hat{\mu}_{12}\\\hat{\mu}_{21}\\\hat{\mu}_{22}\end{bmatrix}\thicksim N\left(\begin{bmatrix}\mu_{11}\\\mu_{12}\\\mu_{21}\\\mu_{22}\end{bmatrix},\,\begin{bmatrix}\frac{\sigma_\varepsilon^2+\sigma_\delta^2}{n_1}&amp;\frac{\sigma_\delta^2}{n_1}&amp;0&amp;0\\\\\frac{\sigma_\delta^2}{n_1}&amp;\frac{\sigma_\epsilon^2+\sigma_\delta^2}{n_1}&amp;0&amp;0\\\\0&amp;0&amp;\frac{\sigma_\epsilon^2+\sigma_\delta^2}{n_2}&amp;\frac{\sigma_\delta^2}{n_2}\\\\0&amp;0&amp;\frac{\sigma_\delta^2}{n_2}&amp;\frac{\sigma_\epsilon^2+\sigma_\delta^2}{n_2}\end{bmatrix}\right)
\tag{6.5}
\end{equation}\]</span></p>
<p>从式 <a href="chap29.html#eq:29-5">(6.5)</a> 可证明</p>
<p><span class="math display">\[\begin{aligned}&amp;\hat{\bar{\mu}}_{1\cdot}-\hat{\bar{\mu}}_{2\cdot}\thicksim N\bigg[S_{AB}-S_{BA},\bigg(\frac{{\sigma}_{\varepsilon}^{2}+2{\sigma}_{\delta}^{2}}{2}\bigg)\bigg(\frac{1}{n_{1}}+\frac{1}{n_{2}}\bigg)\bigg]\\&amp;\hat{\bar{\mu}}_{\cdot1}-\hat{\bar{\mu}}_{\cdot2}\thicksim N\bigg[P_1-P_2,\frac{{\sigma}_{\varepsilon}^{2}}{2}\bigg(\frac{1}{n_1}+\frac{1}{n_2}\bigg)\bigg]\\&amp;\frac{\hat\mu_{11}-\hat\mu_{12}-\hat\mu_{21}+\hat\mu_{22}}{2}\thicksim N\bigg[T_A-T_B,\frac{{\sigma}_{\varepsilon}^{2}}{2}\bigg(\frac{1}{n_1}+\frac{1}{n_2}\bigg)\bigg]\end{aligned}\]</span></p>
<p>与本节讨论的两期/两处理交叉设计相对应的方差分析表的形式如表 <a href="chap29.html#tab:table29-2">6.2</a> 所示。用于检验 <span class="math inline">\(H_0: T_A = T_B\)</span> 的 <span class="math inline">\(F\)</span> 统计量由 <span class="math inline">\(F = TMS/WSEMS\)</span> 给出，其中 <span class="math inline">\(TMS\)</span> 是表 <a href="chap29.html#tab:table29-2">6.2</a> 中的处理均方 (treatment mean square)，<span class="math inline">\(WSEMS\)</span> 是个体内误差均方 (within subject error mea square). 若 <span class="math inline">\(F&gt;F_{\alpha,1,n_1+n_2-2}\)</span> 则拒绝 <span class="math inline">\(H_0\)</span>. <span class="math inline">\(T_A-T_B\)</span> 的 <span class="math inline">\((1-\alpha)100\%\)</span> 置信区间由</p>
<p><span class="math display">\[\frac{\hat{\mu}_{11}-\hat{\mu}_{12}-\hat{\mu}_{21}+\hat{\mu}_{22}}2\pm t_{\alpha,v}\sqrt{\frac{\hat{\sigma}_{\varepsilon}^2}2{\left(\frac1{n_1}+\frac1{n_2}\right)}}\]</span></p>
<p>给出。其中 <span class="math inline">\(v=n_1+n_2-n\)</span> 且 <span class="math inline">\(\hat\sigma_\varepsilon^2=WSEMS\)</span>. 作为一个例子，考虑 Grizzle (1965) 使用的数据。数据如表 <a href="chap29.html#tab:table29-3">6.3</a> 所示。使用表 <a href="chap29.html#tab:table29-4">6.4</a> 中所示的命令通过 SAS<sup>®</sup>-GLM 程序分析数据。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-2">表 6.2: </span>两期/两处理交叉实验的方差分析表
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.2.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-3">表 6.3: </span>Grizzle (1965) 数据
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
Seq
</th>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
Period
</th>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
Trt
</th>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
Person
</th>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
Y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
0.2
</td>
</tr>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
-0.7
</td>
</tr>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
-0.8
</td>
</tr>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
0.2
</td>
</tr>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
0.6
</td>
</tr>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
1.1
</td>
</tr>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
0.3
</td>
</tr>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
0.4
</td>
</tr>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
1.5
</td>
</tr>
<tr>
<td style="text-align:center;">
AB
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
1.2
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
21
</td>
<td style="text-align:center;">
1.3
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
21
</td>
<td style="text-align:center;">
0.9
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
22
</td>
<td style="text-align:center;">
-2.3
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
22
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
0.6
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
24
</td>
<td style="text-align:center;">
-0.8
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
24
</td>
<td style="text-align:center;">
-0.3
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
25
</td>
<td style="text-align:center;">
-0.4
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
25
</td>
<td style="text-align:center;">
-1
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
26
</td>
<td style="text-align:center;">
-2.9
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
26
</td>
<td style="text-align:center;">
1.7
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
27
</td>
<td style="text-align:center;">
-1.9
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
27
</td>
<td style="text-align:center;">
-0.3
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
28
</td>
<td style="text-align:center;">
-2.9
</td>
</tr>
<tr>
<td style="text-align:center;">
BA
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
28
</td>
<td style="text-align:center;">
0.9
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-4">表 6.4: </span>用于分析表 <a href="chap29.html#tab:table29-3">6.3</a> 中数据的 SAS-GLM 代码
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
TITLE ‘CRSOVER EXAMPLE 29.1 – A TWO PERIOD/TWO TREATMENT DESIGN’;<br />
DATA GRIZ;<br />
INPUT SEQ $ PERIOD TRT $ PERSON Y;<br />
LINES;<br />
AB 1 A 11 0.2<br />
AB 2 B 11 1.0<br />
AB 1 A 12 0.0<br />
AB 2 B 12 -0.7<br />
AB 1 A 13 -0.8<br />
AB 2 B 13 0.2<br />
AB 1 A 14 0.6<br />
AB 2 B 14 1.1<br />
AB 1 A 15 0.3<br />
AB 2 B 15 0.4<br />
AB 1 A 16 1.5<br />
AB 2 B 16 1.2<br />
BA 1 B 21 1.3<br />
BA 2 A 21 0.9<br />
BA 1 B 22 -2.3<br />
BA 2 A 22 1.0<br />
BA 1 B 23 0.0<br />
BA 2 A 23 0.6<br />
BA 1 B 24 -0.8<br />
BA 2 A 24 -0.3<br />
BA 1 B 25 -0.4<br />
BA 2 A 25 -1.0<br />
BA 1 B 26 -2.9<br />
BA 2 A 26 1.7<br />
BA 1 B 27 -1.9<br />
BA 2 A 27 -0.3<br />
BA 1 B 28 -2.9<br />
BA 2 A 28 0.9<br />
;<br />
PROC GLM;<br />
TITLE2 ‘STATISTICAL ANALYSIS USING SAS-GLM’;<br />
CLASSES SEQ TRT PERIOD PERSON;<br />
MODEL Y=SEQ PERSON(SEQ) TRT PERIOD;<br />
LSMEANS TRT/PDIFF;<br />
RANDOM PERSON(SEQ);<br />
RUN;
</td>
</tr>
</tbody>
</table>
<p>表 <a href="chap29.html#tab:table29-5">6.5</a> 显示了模型的方差分析，并给出了 <span class="math inline">\(WSEMS\)</span> 的值 <span class="math inline">\(\hat \sigma_\varepsilon^2 = 1.245\)</span>. 表 <a href="chap29.html#tab:table29-6">6.6</a> 给出了 <span class="math inline">\(H_0:T_A = T_B\)</span> 的检验： 以及个体间误差均方 <span class="math inline">\(BSEMS = \hat \sigma_{\varepsilon} ^2 + 2\hat \sigma_{\delta}^2 = 1.001\)</span>. <span class="math inline">\(H_0\)</span> 观察到的显著性水平为 <span class="math inline">\(\hat \alpha = 0.1165\)</span>. 表 <a href="chap29.html#tab:table29-7">6.7</a> 中显示了处理 <span class="math inline">\(A\)</span> 和 <span class="math inline">\(B\)</span> 的最小二乘均值，以及比较处理 <span class="math inline">\(A\)</span> 和处理 <span class="math inline">\(B\)</span> 时观察到的显著性水平 <span class="math inline">\(\hat \alpha = 0.1165\)</span>。方差分析表中各行的预期均方如表 <a href="chap29.html#tab:table29-8">6.8</a> 所示。如果想求出双向序列×时期的估计值，可以使用表 <a href="chap29.html#tab:table29-9">6.9</a> 中的命令。双向均值如表 <a href="chap29.html#tab:table29-10">6.10</a> 所示。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-5">表 6.5: </span>具有个体内误差均方的模型方差分析
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.5.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-6">表 6.6: </span>表 <a href="chap29.html#tab:table29-3">6.3</a> 中数据的 III 型方差分析表
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.6.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-7">表 6.7: </span>处理主效应均值
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.7.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-8">表 6.8: </span>表 <a href="chap29.html#tab:table29-3">6.3</a> 中数据的预期均方表
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.8.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-9">表 6.9: </span>用于分析表 <a href="chap29.html#tab:table29-3">6.3</a> 中数据的 SAS-GLM 代码
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
PROC GLM;<br />
TITLE2 ‘STATISTICAL ANALYSIS USING SAS-GLM’;<br />
CLASSES SEQ TRT PERIOD PERSON;<br />
MODEL Y=SEQ PERSON(SEQ) PERIOD SEQ<em>PERIOD;<br />
LSMEANS SEQ</em>PERIOD;<br />
RANDOM PERSON(SEQ);<br />
RUN;
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-10">表 6.10: </span>序列×时期均值
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.8.png">
</td>
</tr>
</tbody>
</table>
<p>表 <a href="chap29.html#tab:table29-3">6.3</a> 中的数据也可以使用表 <a href="chap29.html#tab:table29-11">6.11</a> 中所示的命令通过 SAS Mixed 程序进行分析。由于 GLM 分析中受试者间误差均方小于受试者内误差均方，因此结果与 GLM 分析获得的结果略有不同。因此，Mixed 程序将与个体相对应的方差分量估计为 <span class="math inline">\(\hat \sigma _\delta ^2 = 0\)</span>，而 GLM 将使用矩准则方法估计相同的方差分量：</p>
<p><span class="math display">\[\hat{\sigma}_\delta^2=\frac{BSEMS-WSEMS}2=\frac{1.005-1.245}2=\frac{-0.240}2=-0.120\]</span></p>
<p>目前未给出使用表 <a href="chap29.html#tab:table29-11">6.11</a> 中的代码的结果，感兴趣的读者需要运行表 <a href="chap29.html#tab:table29-11">6.11</a> 中的代码。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-11">表 6.11: </span>用于分析表 <a href="chap29.html#tab:table29-3">6.3</a> 中数据的 SAS-Mixed 代码
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
PROC MIXED;<br />
TITLE2 ‘STATISTICAL ANALYSIS USING SAS-MIXED’;<br />
CLASSES SEQ TRT PERIOD PERSON;<br />
MODEL Y=SEQ PERIOD TRT;<br />
LSMEANS TRT/PDIFF;<br />
RANDOM PERSON(SEQ);<br />
RUN;<br />
PROC MIXED;<br />
TITLE2 ‘STATISTICAL ANALYSIS USING SAS-MIXED’;<br />
CLASSES SEQ TRT PERIOD PERSON;<br />
MODEL Y=SEQ PERIOD SEQ<em>PERIOD;<br />
LSMEANS SEQ</em>PERIOD;<br />
RANDOM PERSON(SEQ);<br />
RUN;
</td>
</tr>
</tbody>
</table>
<p>上述分析假设第一时期的处理不会影响第二时期的观测结果。接下来考虑存在延滞的情况。当存在延滞时，可以假设</p>
<p><span class="math display" id="eq:29-6">\[\begin{align}
\hat \mu_{11}=\bar y_{11\cdot\cdot}\,\mathrm{estimates}\,\mu+S_{AB}+P_1+T_A\\
\hat \mu_{12}=\bar y_{12\cdot\cdot}\,\mathrm{estimates}\,\mu+S_{AB}+P_2+T_B+\lambda_A\\
\hat \mu_{21}=\bar y_{21\cdot\cdot}\,\mathrm{estimates}\,\mu+S_{BA}+P_1+T_B\\
\hat \mu_{22}=\bar y_{22\cdot\cdot}\,\mathrm{estimates}\,\mu+S_{BA}+P_2+T_A+\lambda_B
\tag{6.6}
\end{align}\]</span></p>
<p>其中 <span class="math inline">\(\lambda_A\)</span> 是序列 <span class="math inline">\(AB\)</span> 的参数，对应于从时期 <span class="math inline">\(1\)</span> 施加的处理 <span class="math inline">\(A\)</span> 到时期 <span class="math inline">\(2\)</span> 的延滞，而 <span class="math inline">\(\lambda_B\)</span> 是序列 <span class="math inline">\(BA\)</span> 的参数，对应于从时期 <span class="math inline">\(1\)</span> 施加的处理 <span class="math inline">\(B\)</span> 到时期 <span class="math inline">\(2\)</span> 的延滞。</p>
<p>从式 <a href="chap29.html#eq:29-6">(6.6)</a> 可看出</p>
<p><span class="math display" id="eq:29-7">\[\begin{align}
\hat {\bar\mu}_{1\cdot}&amp;=\frac{\bar y_{11\cdot\cdot}+\bar y_{12\cdot\cdot}}{2}\,\mathrm{estimates}\,\mu+S_{AB}+\bar P_\cdot+\frac{T_A+T_B}{2}+\frac{\lambda_A}{2}\\
\hat {\bar\mu}_{2\cdot}&amp;=\frac{\bar y_{21\cdot\cdot}+\bar y_{22\cdot\cdot}}{2}\,\mathrm{estimates}\,\mu+S_{BA}+\bar P_\cdot+\frac{T_A+T_B}{2}+\frac{\lambda_B}{2}\\
\hat {\bar\mu}_{\cdot 1}&amp;=\frac{\bar y_{11\cdot\cdot}+\bar y_{21\cdot\cdot}}{2}\,\mathrm{estimates}\,\mu+\bar S_{\cdot}+\bar P_1+\frac{T_A+T_B}{2}\\
\hat {\bar\mu}_{\cdot 2}&amp;=\frac{\bar y_{12\cdot\cdot}+\bar y_{22\cdot\cdot}}{2}\,\mathrm{estimates}\,\mu+\bar S_{\cdot}+\bar P_2+\frac{T_A+T_B}{2}+\frac{\lambda_A+\lambda_B}{2}
\tag{6.7}
\end{align}\]</span></p>
<p>当 <span class="math inline">\(\lambda_A\ne \lambda_B\)</span> 时，延滞就存在。也就是说，在无延滞的情况下，<span class="math inline">\(\lambda_A\)</span> 和 <span class="math inline">\(\lambda_B\)</span> 实际上不必等于零，它们只需要彼此相等。在 <span class="math inline">\(\lambda_A= \lambda_B\)</span> 的情况下，<span class="math inline">\(\lambda_A\)</span> 和 <span class="math inline">\(\lambda_B\)</span> 与时期效应混淆 (confounded)，不需要将参数包括在模型中 <a href="chap29.html#eq:29-2">(6.2)</a> 中。在存在延滞的情况下，两个序列差的均值 <span class="math inline">\(\hat {\bar\mu}_{1\cdot}-\hat {\bar\mu}_{2\cdot}\)</span> 估计 <span class="math inline">\(S_{AB}-S_{BA}+[(\lambda_A-\lambda_B)/2]\)</span>。时期 <span class="math inline">\(1\)</span> 和时期 <span class="math inline">\(2\)</span> 差的均值 <span class="math inline">\(\hat {\bar\mu}_{\cdot1}-\hat {\bar\mu}_{\cdot2}\)</span> 估计 <span class="math inline">\(P_1-P_2+[(\lambda_A+\lambda_B)/2]\)</span> 。最后，<span class="math inline">\((\hat{\mu}_{11}-\hat{\mu}_{12}-\hat{\mu}_{21}+\hat{\mu}_{22})/2\)</span> 估计 <span class="math inline">\(T_A-T_B+[(\lambda_A-\lambda_B)/2]\)</span> 。在存在延滞的情况下，时期 <span class="math inline">\(2\)</span> 的数据无助于估计两种处理的差异。当存在延滞时，必须通过 <span class="math inline">\(\hat \mu_{11}-\hat \mu_{21}\)</span> 来估计 <span class="math inline">\(T_A-T_B\)</span>，并且该估计仅取决于时期 <span class="math inline">\(1\)</span> 的数据。还可以注意到，如果仅使用时期 <span class="math inline">\(1\)</span> 的数据来估计处理效应，则时期 <span class="math inline">\(1\)</span> 的模型可以简化为</p>
<p><span class="math display" id="eq:29-8">\[\begin{equation}
y_{k\ell}=\mu+T_k+\varepsilon_{k\ell}^*,~k=A,B,~\mathrm{and~}~\ell=1,2,\ldots,n_i
\tag{6.8}
\end{equation}\]</span></p>
<p>其中 <span class="math inline">\(\varepsilon_{k\ell}^{*}=\delta_{k\ell}+\varepsilon_{k\ell}\)</span>. 而且，</p>
<p><span class="math display">\[\mathrm{Var}(\hat{\mu}_{11}-\hat{\mu}_{21})=(\sigma_\varepsilon^2+\sigma_\delta^2){\left(\frac1{n_1}+\frac1{n_2}\right)}\]</span></p>
<p>表 <a href="chap29.html#tab:table29-12">6.12</a> 显示了当存在延滞时，与两时期/两处理交叉设计相对应的方差分析表的形式。该表与表 <a href="chap29.html#tab:table29-2">6.2</a> 具有相同的形式，除了预期均方列。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-12">表 6.12: </span>两时期/两处理交叉实验的方差分析表
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.12.png">
</td>
</tr>
</tbody>
</table>
<p>如果不存在延滞，那么个体被分配到哪个序列应该无关紧要。也就是说，从哲学上讲，<span class="math inline">\(S_{AB}-S_{BA}\)</span> 应该等于零。因此，<span class="math inline">\(F=SeqMS/BSEM\)</span> 给出的 <span class="math inline">\(F\)</span> 统计量提供了是否存在延滞的测试。如果 <span class="math inline">\(F&gt;F_{\alpha,1,n1+n2-2}\)</span>，则可以得出结论，存在显著的延滞效应。需要注意的是，延滞检验是个体间的比较，因此该检验的功效不如基于个体内的比较。如果认为可能存在延滞效应，建议不要使用两时期/两处理的交叉设计。在某些情况下，实验者可能能够在交叉设计的两个阶段之间包括所谓的“洗脱” (wash-out) 阶段。洗脱期是指一段足够长的时间，以便在对实验单元进行第二种处理之前，第一时期中给予的处理的任何延滞效应将被消除或清除。同样极其重要的是，要注意在两时期/两处理交叉设计中的延滞问题在一些具有两个以上处理和/或两个以上时期的交叉设计中减少和/或消除。此类设计将在下一节中进行考虑。</p>
<p>作为可能存在延滞的两时期/两处理交叉实验的示例，再次考虑表 <a href="chap29.html#tab:table29-3">6.3</a> 中显示的 Grizzle (1965) 数据。将使用 SAS-Mixed 程序（使用表 <a href="chap29.html#tab:table29-13">6.13</a> 中显示的命令）分析数据。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-13">表 6.13: </span>用于分析表 <a href="chap29.html#tab:table29-3">6.3</a> 中数据的 SAS-Mixed 代码，当存在延滞时
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
PROC MIXED;<br />
TITLE2 ‘STATISTICAL ANALYSIS USING SAS-MIXED’;<br />
CLASSES SEQ TRT PERIOD PERSON;<br />
MODEL Y=SEQ PERIOD TRT;<br />
LSMEANS TRT/PDIFF;<br />
RANDOM PERSON(SEQ);<br />
RUN;<br />
PROC MIXED;<br />
TITLE2 ‘STATISTICAL ANALYSIS USING SAS-MIXED’;<br />
CLASSES SEQ TRT PERIOD PERSON;<br />
MODEL Y=SEQ PERIOD SEQ*PERIOD;<br />
LSMEANS SEQ*PERIOD;<br />
ESTIMATE ‘A-B FROM PERIOD 1’ SEQ 1 -1 SEQ*PERIOD 1 0 -1 0;<br />
RANDOM PERSON(SEQ);<br />
RUN;
</td>
</tr>
</tbody>
</table>
<p>第一组 Mixed 命令用于获得延滞检验和处理效应检验（如果没有任何显著的延滞）。这些命令还给出了处理主效应均值，如果没有延滞，则可以使用该均值。第二组命令使用不同的 random 语句，以获得序列×时期双向均值，包括 <code>ESTIMATE</code> 选项，以便从时期 <span class="math inline">\(1\)</span> 数据中获得处理效应估计值。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-14">表 6.14: </span>固定效应检验
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.14.png">
</td>
</tr>
</tbody>
</table>
<p>表 <a href="chap29.html#tab:table29-14">6.14</a> 给出了对表 <a href="chap29.html#tab:table29-13">6.13</a> 中第一组 Mixed 命令的固定效应的检验。请注意，序列效应在 <span class="math inline">\(0.0665\)</span> 水平下显著，表明存在一些延滞的证据。还请注意，处理效应仅在 <span class="math inline">\(0.1002\)</span> 水平下显著。
处理主效应平均值见表 <a href="chap29.html#tab:table29-15">6.15</a>，该表还比较了两种处理平均值。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-15">表 6.15: </span>处理均值及两种处理均值差的检验
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.15-1.png">
</td>
</tr>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.15-2.png">
</td>
</tr>
</tbody>
</table>
<p>表 <a href="chap29.html#tab:table29-16">6.16</a> 给出了表 <a href="chap29.html#tab:table29-13">6.13</a> 中第二组 Mixed 命令的固定效应检验。请注意，序列的检验与表 <a href="chap29.html#tab:table29-14">6.14</a> 中给出的检验相同。还请注意，序列×时期的检验与表 <a href="chap29.html#tab:table29-14">6.14</a> 中处理的检验相同。表 <a href="chap29.html#tab:table29-17">6.17</a> 给出了序列×时期均值，表 <a href="chap29.html#tab:table29-18">6.18</a> 给出了仅来自时期 <span class="math inline">\(1\)</span> 数据比较两种处理的检验。表 <a href="chap29.html#tab:table29-18">6.18</a> 的检查显示，在表 <a href="chap29.html#tab:table29-7">6.7</a> 中给出的分析中，延滞效应明显掩盖了部分处理效应，其中假设无延滞，因为处理效应不显著，而仅使用时期 <span class="math inline">\(1\)</span> 数据的比较发现处理存在显著差异。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-16">表 6.16: </span>固定效应的额外检验
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.16.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-17">表 6.17: </span>序列×时期双向均值
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.17.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-18">表 6.18: </span>处理 <span class="math inline">\(A\)</span> 和处理 <span class="math inline">\(B\)</span>，来自时期 <span class="math inline">\(1\)</span> 的估计
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.18.png">
</td>
</tr>
</tbody>
</table>
</div>
<div id="sec29-3" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> 具有两个以上时期的交叉设计<a href="chap29.html#sec29-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>当没有延滞时，具有两个以上时期和/或两个以上处理的交叉设计的统计分析是简单的。当满足个体间误差和个体内误差的理想条件时，式 <a href="chap29.html#eq:29-1">(6.1)</a> 中的模型是合适的。表 <a href="chap29.html#tab:table29-4">6.4</a>，<a href="chap29.html#tab:table29-9">6.9</a>，和 <a href="chap29.html#tab:table29-11">6.11</a> 仍然可以用来获得有用和有趣的统计量。由于没有延滞时的分析是直接的，本节集中讨论存在延滞的情况。</p>
<p>考虑的第一种情况是仍然有两种处理的情况，但涉及具有三个时期的序列。一种可能性是使用两个序列 <span class="math inline">\(ABA\)</span> 和 <span class="math inline">\(BAB\)</span>. 对于 <span class="math inline">\(ABA\)</span> 序列，实验单元将在时期 <span class="math inline">\(1\)</span> 接受处理 <span class="math inline">\(A\)</span>，在时期 <span class="math inline">\(2\)</span> 接受处理 <span class="math inline">\(B\)</span>，并在时期 <span class="math inline">\(3\)</span>再次接受处理 <span class="math inline">\(A\)</span>. <span class="math inline">\(BAB\)</span> 序列将进行类似处理。另一种可能性是使用两个序列 <span class="math inline">\(ABB\)</span> 和 <span class="math inline">\(BAA\)</span>. 第三种可能性是使用所有这四个序列。也就是说，<span class="math inline">\(ABA\)</span>、<span class="math inline">\(BAB\)</span>、<span class="math inline">\(ABB\)</span> 和 <span class="math inline">\(BAA\)</span> 都将被使用。本节重点介绍使用两个序列 <span class="math inline">\(ABA\)</span> 和 <span class="math inline">\(BAB\)</span> 的交叉设计。其他的可能性也可以类似地分析。</p>
<p>表 <a href="chap29.html#tab:table29-19">6.19</a> 确定了与 <span class="math inline">\(ABA\)</span> 和 <span class="math inline">\(BAB\)</span> 交叉设计的序列与时期组合相关的模型参数。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-19">表 6.19: </span>三时期/两处理交叉设计的单元个均值参数
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.19.png">
</td>
</tr>
</tbody>
</table>
<p>假设 <span class="math inline">\(n_1\)</span> 个个体已被分配到 <span class="math inline">\(ABA\)</span> 序列，<span class="math inline">\(n2\)</span> 个个体已被分配到 <span class="math inline">\(BAB\)</span> 序列。令 <span class="math inline">\(y_{ij\ell}\)</span> 为在从序列 <span class="math inline">\(i\)</span> 时期 <span class="math inline">\(j\)</span> 的个体 <span class="math inline">\(\ell\)</span> 中观察到的响应。令 <span class="math inline">\(\hat\mu _{ij} = \bar y_{ij\cdot} , i = 1, 2; j = 1, 2, 3\)</span>. 在式 <a href="chap29.html#eq:29-1">(6.1)</a> 中给出的模型误差项的理想条件下，可以证明：</p>
<p><span class="math display" id="eq:29-9">\[\begin{equation}
\begin{bmatrix}\hat{\mu}_{11}\\\hat{\mu}_{12}\\\hat{\mu}_{13}\\\hat{\mu}_{21}\\\hat{\mu}_{22}\\\hat{\mu}_{23}\end{bmatrix}\sim N\left(\begin{bmatrix}\mu_{11}\\\mu_{12}\\\mu_{13}\\\mu_{21}\\\mu_{21}\\\mu_{23}\end{bmatrix},\begin{bmatrix}\frac{\sigma_\varepsilon^2+\sigma_\delta^2}{n_1}&amp;\frac{\sigma_\delta^2}{n_1}&amp;\frac{\sigma_\delta^2}{n_1}&amp;0&amp;0&amp;0\\\frac{\sigma_\delta^2}{n_1}&amp;\frac{\sigma_\varepsilon^2+\sigma_\delta^2}{n_1}&amp;\frac{\sigma_\delta^2}{n_1}&amp;0&amp;0&amp;0\\\frac{\sigma_\delta^2}{n_1}&amp;\frac{\sigma_\delta^2}{n_1}&amp;\frac{\sigma_\epsilon^2+\sigma_\delta^2}{n_1}&amp;0&amp;0&amp;0\\0&amp;0&amp;0&amp;\frac{\sigma_\varepsilon^2+\sigma_\delta^2}{n_2}&amp;\frac{\sigma_\delta^2}{n_2}&amp;\frac{\sigma_\delta^2}{n_2}\\0&amp;0&amp;0&amp;\frac{\sigma_\delta^2}{n_2}&amp;\frac{\sigma_\varepsilon^2+\sigma_\delta^2}{n_2}&amp;\frac{\sigma_\delta^2}{n_2}\\0&amp;0&amp;0&amp;\frac{\sigma_\delta^2}{n_2}&amp;\frac{\sigma_\delta^2}{n_2}&amp;\frac{\sigma_\varepsilon^2+\sigma_\delta^2}{n_2}\end{bmatrix}\right)
\tag{6.9}
\end{equation}\]</span></p>
<p>注意到对比</p>
$$
<span class="math display">\[\begin{aligned}

\begin{aligned}\mu_{11}-\frac12\mu_{12}-\frac12\mu_{13}-\mu_{21}+\frac12\mu_{22}+\frac12\mu_{23}\end{aligned}&amp; =(\mu+S_{ABA}+P_1-T_A)-\frac12(\mu+S_{ABA}+P_2+T_B+\lambda_A)  \\
&amp;-\frac12(\mu+S_{ABA}+P_3+T_A+\lambda_B)-(\mu+S_{BAB}+P_1+T_B) \\
&amp;+\frac12(\mu+S_{BAB}+P_2+T_A+\lambda_B)+\frac12(\mu+S_{BAB}+P_3+T_B+\lambda_A) \\
&amp;=T_{A}-T_{B}
\end{aligned}\]</span>
<p>$$</p>
<p>因此，即使 <span class="math inline">\(ABA\)</span>、<span class="math inline">\(BAB\)</span> 交叉设计中存在延滞，两种处理的直接差异也可以通过下式来估计</p>
<p><span class="math display" id="eq:29-10">\[\begin{equation}
\hat{\mu}_{11}-\frac12\hat{\mu}_{12}-\frac12\hat{\mu}_{13}-\hat{\mu}_{21}+\frac12\hat{\mu}_{22}+\frac12\hat{\mu}_{23}
\tag{6.10}
\end{equation}\]</span></p>
<p>还注意到</p>
<p><span class="math display" id="eq:29-11">\[\begin{equation}
\mathrm{Var}\left(\hat{\mu}_{11}-\frac12\hat{\mu}_{12}-\frac12\hat{\mu}_{13}-\hat{\mu}_{21}+\frac12\hat{\mu}_{22}+\frac12\hat{\mu}_{23}\right)=\frac32\sigma_{\varepsilon}^2\left(\frac1{n_1}+\frac1{n_2}\right)
\tag{6.11}
\end{equation}\]</span></p>
<p>因此，式 <a href="chap29.html#eq:29-11">(6.11)</a> 中的对比是个体内对比，其方差仅取决于 <span class="math inline">\(\sigma^2_\varepsilon\)</span>.</p>
<p>一个可能感兴趣的问题是如何定义处理主效应均值？一种可能性是通过对表 <a href="chap29.html#tab:table29-19">6.19</a> 中接受处理 <span class="math inline">\(A\)</span> 的所有单元进行平均来估计 <span class="math inline">\(A\)</span> 的主效应均值。也就是说，<span class="math inline">\(A\)</span> 平均值为 <span class="math inline">\((\mu_{11} + \mu_{22} + \mu_{13})/3\)</span>，<span class="math inline">\(B\)</span> 平均值为 <span class="math inline">\((\mu_{21} + \mu_{12} + \mu_{23})/3\)</span>。根据表 <a href="chap29.html#tab:table29-19">6.19</a> 中定义的效应模型参数，这两个函数分别等于</p>
<p><span class="math display">\[\begin{aligned}\mu+\frac23S_{ABA}+\frac13S_{BAB}+\bar{P}_\cdot+T_A+\frac13(\lambda_B+\lambda_A)\\\mu+\frac13S_{ABA}+\frac23S_{BAB}+\bar{P}_\cdot+T_B+\frac13(\lambda_A+\lambda_B)\end{aligned}\]</span></p>
<p>这样的定义没有意义，因为这样的 <span class="math inline">\(A\)</span> 均值和 <span class="math inline">\(B\)</span> 均值的差等于 <span class="math inline">\(\frac{1}{3}S_{ABA}-\frac{1}{3}S_{BAB}+T_A-T_B\)</span>，而不等于 <span class="math inline">\(T_A-T_B\)</span>. 也就是说，这样定义的 <span class="math inline">\(A\)</span> 均值和 <span class="math inline">\(B\)</span> 均值与序列效应混叠 (aliased). <span class="math inline">\(A\)</span> 主效应均值的第二个定义是</p>
<p><span class="math display">\[\mu+\bar{S}_\cdot+\bar{P}_\cdot+T_A+\frac13(\lambda_B+\lambda_A)\]</span></p>
<p><span class="math inline">\(B\)</span> 主效应均值类似地定义为</p>
<p><span class="math display">\[\mu+\bar{S}_\cdot+\bar{P}_\cdot+T_B+\frac13(\lambda_B+\lambda_A)\]</span></p>
<p>这样的定义是合理的，因为第一个等于表 <a href="chap29.html#tab:table29-19">6.19</a> 中单元格均值的下列线性函数</p>
<p><span class="math display">\[\frac23\mu_{11}-\frac1{12}\mu_{12}-\frac1{12}\mu_{13}-\frac13\mu_{21}+\frac5{12}\mu_{22}+\frac5{12}\mu_{23}\]</span></p>
<p>第二个等于</p>
<p><span class="math display">\[-\frac13\mu_{11}+\frac5{12}\mu_{12}+\frac5{12}\mu_{13}+\frac23\mu_{21}-\frac1{12}\mu_{22}-\frac1{12}\mu_{23}\]</span></p>
<p>此外，这两个均值之差为</p>
<p><span class="math display">\[\mu_{11}-\frac12\mu_{12}-\frac12\mu_{13}-\mu_{21}+\frac12\mu_{22}+\frac12\mu_{23}=T_A-T_B\]</span></p>
<p>请注意，这与公式 <a href="chap29.html#eq:29-10">(6.10)</a> 中给出的单元格均值对比相同。单元格均值内的对比意味着延滞效应是</p>
<p><span class="math display" id="eq:29-12">\[\begin{equation}
\mu_{11}-\mu_{13}-\mu_{21}+\mu_{23}=\lambda_A-\lambda_B
\tag{6.12}
\end{equation}\]</span></p>
<p>该对比估计的方差是</p>
<p><span class="math display" id="eq:29-13">\[\begin{equation}
\mathrm{Var}(\hat{\mu}_{11}-\hat{\mu}_{13}-\hat{\mu}_{21}+\hat{\mu}_{23})=2\sigma_{\varepsilon}^2\left(\frac1{n_1}+\frac1{n_2}\right)
\tag{6.13}
\end{equation}\]</span></p>
<p>且此对比也是个体内对比。</p>
<p>为了举例说明，请考虑表 <a href="chap29.html#tab:table29-20">6.20</a> 中的数据，其中三名个体分配给 <span class="math inline">\(ABA\)</span> 序列，另外三名个体分配给 <span class="math inline">\(BAB\)</span> 序列。因此 <span class="math inline">\(n_1 = n_2 = 3\)</span>. 读取数据并计算序列×时期单元格均值的 SAS 代码如表 <a href="chap29.html#tab:table29-21">6.21</a> 所示。单元平均值如表 <a href="chap29.html#tab:table29-22">6.22</a> 所示。</p>
<p>因此，<span class="math inline">\(A\)</span> 主效应平均值的估计由下式给出</p>
<p><span class="math display">\[\begin{aligned}
\frac23\hat{\mu}_{11}&amp; -\frac1{12}\hat{\mu}_{12}-\frac1{12}\hat{\mu}_{13}-\frac13\hat{\mu}_{21}+\frac5{12}\hat{\mu}_{22}+\frac5{12}\hat{\mu}_{23}  \\
&amp;=\frac23(24.133)-\frac1{12}(26.533)-\frac1{12}(23.933)-\frac13(26.367)+\frac5{12}(26.233)+\frac5{12}(24.833)=24.372
\end{aligned}\]</span></p>
<p><span class="math inline">\(B\)</span> 主效应平均值的估计由下式给出</p>
<p><span class="math display">\[\begin{aligned}-\frac13\hat{\mu}_{11}&amp;+\frac5{12}\hat{\mu}_{12}+\frac5{12}\hat{\mu}_{15}+\frac23\hat{\mu}_{21}-\frac1{12}\hat{\mu}_{22}-\frac1{12}\hat{\mu}_{23}\\&amp;=-\frac13(24.133)+\frac5{12}(26.533)+\frac5{12}(23.933)+\frac23(26.367)-\frac1{12}(26.233)-\frac1{12}(24.833)=26.306\end{aligned}\]</span></p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-20">表 6.20: </span> <span class="math inline">\(ABA/BAB\)</span> 交叉实验的数据
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
Seq
</th>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
Per
</th>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
Trt
</th>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
Person
</th>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
Y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
ABA
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
25.1
</td>
</tr>
<tr>
<td style="text-align:center;">
ABA
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
27.6
</td>
</tr>
<tr>
<td style="text-align:center;">
ABA
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
24.5
</td>
</tr>
<tr>
<td style="text-align:center;">
ABA
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
22
</td>
</tr>
<tr>
<td style="text-align:center;">
ABA
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
24.3
</td>
</tr>
<tr>
<td style="text-align:center;">
ABA
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
21.6
</td>
</tr>
<tr>
<td style="text-align:center;">
ABA
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
25.3
</td>
</tr>
<tr>
<td style="text-align:center;">
ABA
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
27.7
</td>
</tr>
<tr>
<td style="text-align:center;">
ABA
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
25.7
</td>
</tr>
<tr>
<td style="text-align:center;">
BAB
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
25.5
</td>
</tr>
<tr>
<td style="text-align:center;">
BAB
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
23.7
</td>
</tr>
<tr>
<td style="text-align:center;">
BAB
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
24.9
</td>
</tr>
<tr>
<td style="text-align:center;">
BAB
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
27.4
</td>
</tr>
<tr>
<td style="text-align:center;">
BAB
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
27.9
</td>
</tr>
<tr>
<td style="text-align:center;">
BAB
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
24.6
</td>
</tr>
<tr>
<td style="text-align:center;">
BAB
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
26.2
</td>
</tr>
<tr>
<td style="text-align:center;">
BAB
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
A
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
27.1
</td>
</tr>
<tr>
<td style="text-align:center;">
BAB
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
B
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
25
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-21">表 6.21: </span>用于获取表 <a href="chap29.html#tab:table29-20">6.20</a> 中数据的序列×时期单元格均值的 SAS 代码
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
TITLE ‘CRSOVR EXAMPLE #29.2 AN ABA/BAB DESIGN’;<br />
DATA CRS;<br />
INPUT SEQ $ PER TRT $ PERSON Y;<br />
LINES;<br />
ABA 1 A 1 25.1<br />
ABA 2 B 1 27.6<br />
ABA 3 A 1 24.5<br />
ABA 1 A 2 22.0<br />
ABA 2 B 2 24.3<br />
ABA 3 A 2 21.6<br />
ABA 1 A 3 25.3<br />
ABA 2 B 3 27.7<br />
ABA 3 A 3 25.7<br />
BAB 1 B 4 25.5<br />
BAB 2 A 4 23.7<br />
BAB 3 B 4 24.9<br />
BAB 1 B 5 27.4<br />
BAB 2 A 5 27.9<br />
BAB 3 B 5 24.6<br />
BAB 1 B 6 26.2<br />
BAB 2 A 6 27.1<br />
BAB 3 B 6 25.0<br />
;<br />
PROC MEANS;<br />
CLASS SEQ PER;<br />
VAR Y;<br />
RUN;
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-22">表 6.22: </span>序列×时期单元格均值
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.22.png">
</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(A\)</span> 均值与 <span class="math inline">\(B\)</span> 均值之差为</p>
<p><span class="math display">\[\hat{\tau}_A-\hat{\tau}_B=24.372-26.306=-1.934\]</span></p>
<p>人们可以使用 SAS-Mixed 程序来估计处理均值、检验处理差异、检验延滞以及估计两处理/三时期交叉设计的方差分量。例如，为了分析表 <a href="chap29.html#tab:table29-20">6.20</a> 中的数据，必须定义一个新变量来标识前一时期给予的处理。为了不消除第一时期数据，还必须为第一时期数据定义这个新变量。对于 <span class="math inline">\(ABA\)</span> 序列，可以将这个新变量定义为在时期 <span class="math inline">\(1\)</span>、<span class="math inline">\(2\)</span> 和 <span class="math inline">\(3\)</span> 中分别取值为 <span class="math inline">\(O\)</span>、<span class="math inline">\(A\)</span> 和 <span class="math inline">\(B\)</span>. 对于 <span class="math inline">\(BAB\)</span> 序列，新变量将分别取值 <span class="math inline">\(O\)</span>、<span class="math inline">\(B\)</span> 和 <span class="math inline">\(A\)</span>. 表 <a href="chap29.html#tab:table29-23">6.23</a> 中的 SAS 代码使用了一个名为 <code>PRIORTRT</code> 的新变量，该变量具有前几句中给出的属性。定义了这个新变量的数据如表 <a href="chap29.html#tab:table29-24">6.24</a> 所示。可用于分析表 <a href="chap29.html#tab:table29-20">6.20</a> 中数据的 SAS-Mixed 命令如表 <a href="chap29.html#tab:table29-25">6.25</a> 所示。结果输出如表 <a href="chap29.html#tab:table29-20">6.20</a> 至 <a href="chap29.html#tab:table29-29">6.29</a> 所示。表 <a href="chap29.html#tab:table29-26">6.26</a> 给出了方差分量的估计。从该表中可以看出，<span class="math inline">\(\sigma^2_\delta=2.1378\)</span> 和 <span class="math inline">\(\sigma^2_\varepsilon=0.7872\)</span>. 表 <a href="chap29.html#tab:table29-27">6.27</a> 给出了处理 <span class="math inline">\(A\)</span> 和处理 <span class="math inline">\(B\)</span> 之差的检验。表 <a href="chap29.html#tab:table29-27">6.27</a> 中标记为 Trt 的行是检验 <span class="math inline">\(H_{01}:\tau_A=\tau_B\)</span>，标记为 PRIORTRT 的行是检验 <span class="math inline">\(H_{02}:\lambda_A=\lambda_B\)</span>. 请注意，表 <a href="chap29.html#tab:table29-27">6.27</a> 中标记为 PER 的行只有一个自由度。这可能看起来很奇怪，因为有三个时期。然而，在时期 <span class="math inline">\(1\)</span> 和 <span class="math inline">\(\lambda_0\)</span> 之间存在完全混淆 (completely confounding)，因此标记为 PER 的行仅比较时期 <span class="math inline">\(2\)</span> 和时期 <span class="math inline">\(3\)</span>. 也就是说，标记为 PER 的行检验 <span class="math inline">\(H_{03}:P_2=P_3\)</span>. 表 <a href="chap29.html#tab:table29-25">6.25</a> 中的 <code>CONTRAST</code> 选项给出了一个检验统计量，将所有三个时期相互比较；即该 <code>CONTRAST</code> 选项检验 <span class="math inline">\(H_{03}:P_1+\lambda_0=P_2=P_3\)</span> 的结果。该选项的结果附在表 <a href="chap29.html#tab:table29-27">6.27</a> 的底部。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-23">表 6.23: </span>为表 <a href="chap29.html#tab:table29-20">6.20</a> 中的数据创建 <code>PRIORTRT</code> 变量的 SAS 代码
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
DATA CRS2; SET CRS;<br />
IF SEQ=‘ABA’ AND PER=2 THEN PRIORTRT=‘A’;<br />
ELSE IF SEQ=‘ABA’ AND PER=3 THEN PRIORTRT=‘B’;<br />
ELSE IF SEQ=‘BAB’ AND PER=2 THEN PRIORTRT=‘B’;<br />
ELSE IF SEQ=‘BAB’ AND PER=3 THEN PRIORTRT=‘A’;<br />
ELSE PRIORTRT=‘O’;<br />
RUN;<br />
PROC PRINT;<br />
TITLE2 ‘A PRINT OF THE DATA WITH PRIORTRT VARIABLE INCLUDED’;<br />
RUN;
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-24">表 6.24: </span>打印定义了 <code>PRIORTRT</code> 变量的新数据
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.24.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-25">表 6.25: </span>分析表 <a href="chap29.html#tab:table29-24">6.24</a> 中数据的 SAS 代码
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
PROC MIXED;<br />
TITLE3 ‘AN ANALYSIS USING MIXED’;<br />
CLASSES SEQ PERSON TRT PER PRIORTRT;<br />
MODEL Y=SEQ TRT PER PRIORTRT/DDFM=KR;<br />
LSMEANS TRT/PDIFF;<br />
ESTIMATE ‘TRT DIFF’ TRT 1 -1;<br />
ESTIMATE ‘CARRYOVER’ PRIORTRT 1 -1;<br />
CONTRAST ‘PERIOD DIFF’ PER 0 1 -1, PER 1 -.5 -.5 PRIORTRT -.5 -.5 1;<br />
RANDOM PERSON(SEQ);<br />
RUN;
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-26">表 6.26: </span>方差分量估计
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.26.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-27">表 6.27: </span>固定效应检验
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.27-1.png">
</td>
</tr>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.27-2.png">
</td>
</tr>
</tbody>
</table>
<p>处理主效应均值的估计值如表 <a href="chap29.html#tab:table29-28">6.28</a> 所示。请注意，SAS-Mixed 程序给出的值与表 <a href="chap29.html#tab:table29-22">6.22</a> 中使用主效应平均值的第二定义计算的估计值相同。表 <a href="chap29.html#tab:table29-25">6.25</a> 中两个 ESTIMATE 语句的结果如表 <a href="chap29.html#tab:table29-29">6.29</a> 所示。这些估计的第一个 <span class="math inline">\(\tau_A-\tau_B\)</span> 给出了估计值的标准误估计，并给出了用于检验 <span class="math inline">\(H_{01}:\tau_A=\tau_B\)</span> 的 <span class="math inline">\(t\)</span> 统计量以及检验观察到的显著性水平。第二个 ESTIMATE 语句估计 <span class="math inline">\(\lambda_A-\lambda_B\)</span> 给出了估计值的标准误估计，并给出了用于检验 <span class="math inline">\(H_{02}:\lambda_A=\lambda_B\)</span> 的 <span class="math inline">\(t\)</span> 统计量以及检验观察到的显著性水平。读者应注意，表 <a href="chap29.html#tab:table29-29">6.29</a> 中观察到的处理差异和延滞差异的显著性水平与表 <a href="chap29.html#tab:table29-27">6.27</a> 中相应的观察到的显著性水平相同。处理差异估计的标准误估计可以通过将 <a href="chap29.html#eq:29-11">(6.11)</a> 中的 <span class="math inline">\(\sigma_\varepsilon^2\)</span> 替换为 <span class="math inline">\(\hat\sigma_\varepsilon^2\)</span> 来计算，即</p>
<p><span class="math display">\[\begin{aligned}
\widehat{\mathrm{Var}}\left(\hat{\mu}_{11}-\frac12\hat{\mu}_{12}-\frac12\hat{\mu}_{13}-\hat{\mu}_{21}+\frac12\hat{\mu}_{22}+\frac12\hat{\mu}_{23}\right)&amp; =\frac32\hat{\sigma}_\varepsilon^2\left(\frac1{n_1}+\frac1{n_2}\right)  \\
&amp;=\left(\frac32\right)(0.7872)\left(\frac13+\frac13\right)=0.7872
\end{aligned}\]</span></p>
<p>因此 <span class="math inline">\(\hat \tau_A-\hat \tau_B\)</span> 标准误估计为 <span class="math inline">\(√0.7872=0.8872\)</span>.</p>
<p>类似地，可以通过将方程 <a href="chap29.html#eq:29-13">(6.13)</a> 中的 <span class="math inline">\(\sigma_\varepsilon^2\)</span> 替换为 <span class="math inline">\(\hat\sigma_\varepsilon^2\)</span> 并取结果的平方根，来获得 <span class="math inline">\(\hat \lambda_A-\hat \lambda_B\)</span> 的标准误估计。与这些的标准误估计中的每一个相关的自由度为 <span class="math inline">\(2(n_1+n_2-2)=8\)</span>.</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-28">表 6.28: </span>处理主效应均值
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.28.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-29">表 6.29: </span>从 Estimate 选项中检验处理和延滞效应
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.29.png">
</td>
</tr>
</tbody>
</table>
</div>
<div id="sec29-4" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> 具有两种以上处理的交叉设计<a href="chap29.html#sec29-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>接下来，考虑六个序列中的三处理/三时期交叉设计。设计序列为 <span class="math inline">\(ABC,ACB,BAC,BCA,CAB,CBA\)</span>. 所有这六个序列都是必需的，为了获得不会与延滞混叠的处理均值的直接比较。Williams (1949) 开发的设计在延滞效应方面是均衡的。Williams 交叉设计在延滞效应方面是均衡的，其特点是每次处理后都会进行完全相同次数的其他处理。</p>
<p>上面给出的六序列设计是 Williams 设计。在这六个序列的设计中，每个处理（字母）跟随另一个处理两次。还要注意，虽然具有序列 <span class="math inline">\(ABC,BCA,CAB\)</span> 的三序列设计是拉丁方设计，但它不是 Williams 设计。在这种设计中，<span class="math inline">\(A\)</span> 后面跟着 <span class="math inline">\(B\)</span> 两次，但 <span class="math inline">\(A\)</span> 后面永远不会跟着 <span class="math inline">\(C\)</span>. 同样，<span class="math inline">\(B\)</span> 后面跟着 <span class="math inline">\(C\)</span> 两次，但 <span class="math inline">\(B\)</span> 后面从来没有跟着 <span class="math inline">\(A\)</span>；<span class="math inline">\(C\)</span> 后面跟着 <span class="math inline">\(A\)</span> 两次，但 <span class="math inline">\(C\)</span> 后面从来没有跟着 <span class="math inline">\(B\)</span>。三个时期内三种处理的 Williams 设计必须使用 <span class="math inline">\(ABC,ACB,BAC,BCA,CAB,CBA\)</span> 的所有六个序列。</p>
<p>假设有四处理和四时期，显然，24 序列设计具有处理 <span class="math inline">\(A,B,C,D\)</span> 的所有 <span class="math inline">\(24\)</span> 种可能的排序，这将是一个 Williams 设计。另一种四处理四时期的 Williams 设计的序列为 <span class="math inline">\(ABCD,BDAC,CADB,DCBA\)</span>. 设 <span class="math inline">\(t\)</span> 为交叉设计中要使用的处理数和时期数。如果 <span class="math inline">\(t\)</span> 是偶数，则 Williams 设计可以用一个特殊的 <span class="math inline">\(t×t\)</span> 拉丁方设计来构建，如果 <span class="math inline">\(t\)</span> 是奇数，Williams 设计可以通过使用两个特殊的拉丁方设计来构建。</p>
<p>表 <a href="chap29.html#tab:table29-30">6.30</a> 给出了三时期/三处理 Williams 设计的单元格均值参数。为了表明当存在延滞时可以估计处理差异，可以证明对于表 <a href="chap29.html#tab:table29-30">6.30</a> 中的单元格均值</p>
<p><span class="math display" id="eq:29-14">\[\begin{align}
&amp;(5\mu_{11}-2\mu_{12}-3\mu_{13}+4\mu_{21}+2\mu_{22}-6\mu_{23}-5\mu_{31}+2\mu_{32}+3\mu_{33}-4\mu_{41}-2\mu_{41}\\&amp;+6\mu_{43}-\mu_{51}+4\mu_{52}-3\mu_{53}+\mu_{61}-4\mu_{62}+3\mu_{63})/24=\tau_A-\tau_B
\tag{6.14}
\end{align}\]</span></p>
<p>还注意到，也可以比较延滞效应，</p>
<p><span class="math display" id="eq:29-15">\[\begin{align}
&amp;(\mu_{11}+2\mu_{12}-3\mu_{13}+0\mu_{21}+2\mu_{22}-2\mu_{23}-\mu_{31}-2\mu_{32}+3\mu_{33}+0\mu_{41}-2\mu_{41}\\&amp;+2\mu_{43}-\mu_{51}+0\mu_{52}+\mu_{53}+\mu_{61}+0\mu_{62}-\mu_{63})/8=\lambda_A-\lambda_B
\tag{6.15}
\end{align}\]</span></p>
<p>还可以获得简化为 <span class="math inline">\(\tau_A-\tau_C\)</span> 和 <span class="math inline">\(\tau_B-\tau_C\)</span> 以及 <span class="math inline">\(\lambda_A-\lambda_C\)</span> 和 <span class="math inline">\(\lambda_B-\lambda_C\)</span> 的单元格均值参数的类似函数。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-30">表 6.30: </span>六个序列的三时期/三处理交叉设计单元格均值参数
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.30.png">
</td>
</tr>
</tbody>
</table>
<p>例如，考虑表 <a href="chap29.html#tab:table29-31">6.31</a> 中的数据。这些数据来自六个序列的三时期/三处理交叉设计。有少数个体缺失数据。使用表 <a href="chap29.html#tab:table29-31">6.31</a> 中的命令创建 SAS 数据集。这些命令还创建了一个延滞参数，该参数给出了上一时期的处理值。对于第一时期，该参数的值为“O”。数据最初使用 SAS-Mixed 软件进行分析，使用表 <a href="chap29.html#tab:table29-33">6.33</a> 中的命令。表 <a href="chap29.html#tab:table29-34">6.34</a> 给出了个体间和个体内方差分量的估计，即，<span class="math inline">\(\hat\sigma^2_\delta = 3.2278\)</span> 和 <span class="math inline">\(\hat\sigma^2_\varepsilon = 0.8934\)</span>.</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-31">表 6.31: </span>三时期/三处理交叉设计的数据
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.31.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-32">表 6.32: </span>分析表 <a href="chap29.html#tab:table29-31">6.31</a> 中数据的 SAS 代码
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.32.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-33">表 6.33: </span>分析表 <a href="chap29.html#tab:table29-31">6.31</a> 中数据的 SAS 代码
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.33.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-34">表 6.34: </span>方差分量的估计
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.34.png">
</td>
</tr>
</tbody>
</table>
<p>表 <a href="chap29.html#tab:table29-35">6.35</a> 给出了固定效应的检验。对表 <a href="chap29.html#tab:table29-35">6.35</a> 的检验表明，有一个很显著处理效应（<span class="math inline">\(p &lt; 0.0001\)</span>）和显著的延滞效应（<span class="math inline">\(p = 0.0306\)</span>）。表 <a href="chap29.html#tab:table29-36">6.36</a> 和 <a href="chap29.html#tab:table29-37">6.37</a> 给予 <code>LSMEANS</code> 选项的结果。值得注意的是，无论是处理还是先前处理的最小二乘均值都不可估 (not estimable)。原因是 SAS-Mixed 程序生成的模型参数函数是不可估的。</p>
<p>例如，SAS-Mixed 程序将处理 <span class="math inline">\(A\)</span> 最小二乘均值定义为</p>
<p><span class="math display">\[\mu+\frac{S_{ABC}+S_{ACB}+S_{BAC}+S_{BCA}+S_{CAB}+S_{CBA}}6+\frac{P_1+P_2+P_3}3+\tau_A+\frac{\lambda_A+\lambda_B+\lambda_C+\lambda_O}4\]</span></p>
<p>该函数不可估，因为 <span class="math inline">\(P_1\)</span> 和 <span class="math inline">\(\lambda_O\)</span> 在模型中彼此完全混叠，因此，它们必须具有相同的乘数。在上式中，它们不具有相同的乘数，因为 <span class="math inline">\(P_1\)</span> 的乘数等于 <span class="math inline">\(1/3\)</span>，而 <span class="math inline">\(\lambda_O\)</span> 的乘数等于 <span class="math inline">\(1/4\)</span>. 处理 <span class="math inline">\(A\)</span> 最小二乘均值的更好定义为</p>
<p><span class="math display" id="eq:29-16">\[\begin{align}
\mu&amp;+\frac{S_{ABC}+S_{ACB}+S_{BAC}+S_{BCA}+S_{CAB}+S_{CBA}}6+\frac{P_1+P_2+P_3}3\\&amp;+\tau_A+\frac{2\lambda_A+2\lambda_B+2\lambda_C+3\lambda_O}9
\tag{6.16}
\end{align}\]</span></p>
<p>在该定义中，<span class="math inline">\(P_1\)</span> 和 <span class="math inline">\(\lambda_O\)</span> 的乘数均等于 <span class="math inline">\(1/3\)</span>. 此外，由于四个延滞参数的乘数之和必须为 <span class="math inline">\(1\)</span>，因此 <span class="math inline">\(\lambda_A,\lambda_B,\lambda_C\)</span> 的乘数必须等于 <span class="math inline">\(2/9\)</span>. 式 <a href="chap29.html#eq:29-16">(6.16)</a> 中的函数是可估计。以类似的方式，可以定义处理 <span class="math inline">\(B\)</span> 和处理 <span class="math inline">\(C\)</span> 的最小二乘均值，并且这些平均值之间的成对差异将不包括延滞参数。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-35">表 6.35: </span>固定效应的检验
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.35.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-36">表 6.36: </span>处理最小二乘均值
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.36.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-37">表 6.37: </span>处理和延滞参数之间的成对比较
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.37.png">
</td>
</tr>
</tbody>
</table>
<p>尽管在表 <a href="chap29.html#tab:table29-36">6.36</a> 中处理最小二乘均值不可估，但成对差异是可估计的，处理和延滞参数之间的成对比较见表 <a href="chap29.html#tab:table29-37">6.37</a> 。从表 <a href="chap29.html#tab:table29-37">6.37</a> 可以看出，</p>
<p><span class="math display">\[\hat{\tau}_{A}-\hat{\tau}_{B}=0.8195,\hat{\tau}_{A}-\hat{\tau}_{C}=-3.0861,\mathrm{and}\,\hat{\tau}_{B}-\hat{\tau}_{C}=-3.9056\]</span></p>
<p>相应的观察到的显著性水平为 <span class="math inline">\(p = 0.0041\)</span>、<span class="math inline">\(p &lt; 0.0001\)</span> 和 <span class="math inline">\(p &lt; 0.0001\)</span>.
因此，所有处理均值彼此之间存在显著差异。</p>
<p>从表 <a href="chap29.html#tab:table29-37">6.37</a> 中还可以看出，</p>
<p><span class="math display">\[\hat{\lambda}_A-\hat{\lambda}_B=-0.7706,\hat{\lambda}_A-\hat{\lambda}_C=0.1842,\mathrm{~and~}\hat{\lambda}_B-\hat{\lambda}_C=0.9548\]</span></p>
<p>相应的观察到的显著性水平为 <span class="math inline">\(p = 0.0557\)</span>、<span class="math inline">\(p = 0.6380\)</span> 和 <span class="math inline">\(p = 0.0118\)</span>.
因此，处理 <span class="math inline">\(A\)</span> 和 <span class="math inline">\(C\)</span> 的延滞效应彼此相似，且均与处理 <span class="math inline">\(B\)</span> 的延滞显著不同。</p>
<p>表 <a href="chap29.html#tab:table29-38">6.38</a> 给出了额外的 SAS 代码，该代码使用与 <a href="chap29.html#eq:29-16">(6.16)</a> 中给出的处理 <span class="math inline">\(A\)</span> 相似的定义计算处理最小二乘均值。表 <a href="chap29.html#tab:table29-38">6.38</a> 中 SAS 命令的结果见表 <a href="chap29.html#tab:table29-39">6.39</a>. 对表 <a href="chap29.html#tab:table29-39">6.39</a> 的检查表明，处理 <span class="math inline">\(C\)</span> 的平均值最大，其次是处理 <span class="math inline">\(A\)</span> 和 <span class="math inline">\(B\)</span>. 还注意到，表 <a href="chap29.html#tab:table29-39">6.39</a> 中给出的处理平均值和延滞效应之间的成对比较与表 <a href="chap29.html#tab:table29-37">6.37</a> 中的相应比较完全相同。</p>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-38">表 6.38: </span>计算处理可估最小二乘均值的额外 SAS 代码
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.38.png">
</td>
</tr>
</tbody>
</table>
<table class="table table-condensed" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table29-39">表 6.39: </span>表 <a href="chap29.html#tab:table29-38">6.38</a> 中给出的命令的结果
</caption>
<thead>
<tr>
<th style="text-align:center;color: white !important;background-color: white !important;font-size: 0px;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
<img src="table/table%2029.39.png">
</td>
</tr>
</tbody>
</table>
</div>
<div id="sec29-5" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> 小结<a href="chap29.html#sec29-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>本章考虑了交叉设计，即每个个体随着时间的推移接受一系列处理。特定个体接受的一系列特殊处理被称为序列。当使用交叉设计时，需要考虑延滞问题。如果怀疑可能存在延滞，可以在进行下一次处理之前纳入洗脱期，以尽可能减少延滞的影响。当两时期/两处理交叉设计中存在延滞时，不能使用第二个时期的数据来估计处理差异。然而，当能够使用两个以上时期和/或两种以上处理时，无论是否存在延滞，都可以获得处理差异的估计。</p>

</div>
</div>


























            </section>

          </div>
        </div>
      </div>
<a href="chap5.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
